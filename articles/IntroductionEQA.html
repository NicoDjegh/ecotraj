<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Ecological Quality Assessment (EQA) • ecotraj</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Ecological Quality Assessment (EQA)">
<meta property="og:description" content="ecotraj">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecotraj</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to Ecological Quality Assessment
(EQA)</h1>
                        <h4 data-toc-skip class="author">Anthony
Sturbois/Miquel De Cáceres</h4>
            
            <h4 data-toc-skip class="date">2023-03-23</h4>
      
      
      <div class="hidden name"><code>IntroductionEQA.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about-this-vignette">1. About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h2>
<p>This vignette present the ecological applications used by Sturbois et
al. (under review) for the presentation of the Ecological Quality
Assessment (EQA) framework. The vignette illustrates how to conduct an
Ecological Quality Assessement through state-based and trajectory-based
variants, and how to presentation the results graphically. The two data
sets used in this vignette have been included in the
<strong>ecotraj</strong> package for reproducibility.</p>
</div>
<div class="section level2">
<h2 id="loading-libraries">2. Loading libraries<a class="anchor" aria-label="anchor" href="#loading-libraries"></a>
</h2>
<p>First of all, we load the libraries required for the examples,
including <strong>ecotraj</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#loading libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/ecotraj/">ecotraj</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Rcpp</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: permute</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: lattice</span></span></code></pre>
<pre><code><span><span class="co">## This is vegan 2.6-4</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/vegclust/" class="external-link">vegclust</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="heathland-conservation-status-in-landes-et-marais-de-glomel">3. Heathland conservation status in <em>Landes et Marais de
Glomel</em><a class="anchor" aria-label="anchor" href="#heathland-conservation-status-in-landes-et-marais-de-glomel"></a>
</h2>
<div class="section level3">
<h3 id="context">3.1 Context<a class="anchor" aria-label="anchor" href="#context"></a>
</h3>
<p>The nature reserve of <em>Landes et Marais de Glomel</em> (Brittany,
France) is composed of temperate Atlantic wet heaths whose reference
state is commonly considered dominated by plant communities associated
to acid, nutrient poor soils that are at least seasonally water logged
and dominated by <em>Erica tetralix</em> and <em>E. ciliaris</em>. This
habitat is considered of community interest as part of the European
directive on the conservation of natural habitats and of wild fauna and
flora (97/62/CEE). For the definition of the reference envelope, surveys
integrated the variability of reference states from youngest to early
senescent stages, based on expert assessment with respect to the
European Directive (97/62/CEE) requirements.</p>
</div>
<div class="section level3">
<h3 id="loading-data">3.2 Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h3>
<p>The data set consists of 23 rows (stations) and 46 columns (species).
The percent cover values derived from Braun-Blanquet ordinal scale were
estimated for 43 species of vascular plants. The first five stations
(rows) were used to define the reference envelope, and the next 18
stations (rows) where those for which the conservation status was to be
assessed.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glomel</span><span class="op">)</span></span>
<span><span class="co">#Showing a first lines /columns subset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">glomel</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    ID   Ref Calluna vulgaris Erica ciliaris Erica tetralix Ulex gallii</span></span>
<span><span class="co">## 2  1A  TRUE             17.5              1           37.5        17.5</span></span>
<span><span class="co">## 4  1B  TRUE              5.0              0           37.5         5.0</span></span>
<span><span class="co">## 6  1C  TRUE              0.0              0           17.5        37.5</span></span>
<span><span class="co">## 8  5A  TRUE             37.5              0           17.5         5.0</span></span>
<span><span class="co">## 10 13  TRUE             37.5              0           17.5         1.0</span></span>
<span><span class="co">## 12  2 FALSE              5.0              0           37.5         5.0</span></span>
<span><span class="co">##    Molinia caerulea Betula pubescens</span></span>
<span><span class="co">## 2              37.5              1.0</span></span>
<span><span class="co">## 4              37.5              0.0</span></span>
<span><span class="co">## 6              37.5              0.0</span></span>
<span><span class="co">## 8              37.5              0.5</span></span>
<span><span class="co">## 10             37.5              5.0</span></span>
<span><span class="co">## 12             37.5              1.0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="ecological-quality-assessment">3.3 Ecological Quality Assessment<a class="anchor" aria-label="anchor" href="#ecological-quality-assessment"></a>
</h3>
<p>We first create a compositional data matrix, by extracting species
data from the initial data table:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glomel_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">glomel</span><span class="op">[</span>,<span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">glomel</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Ref"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">glomel_comp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">glomel</span><span class="op">$</span><span class="va">ID</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">glomel_comp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 23 43</span></span></code></pre>
<p>Using the compositional data, we can use function
<code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist()</a></code> from package <strong>vegan</strong> to calculate
of Bray Curtis distances between ecosystem states:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glomel_bc</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">glomel_comp</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span></code></pre></div>
<p>The distance matrix <code>glomel_bc</code> defines the multivariate
space that represents the ressemblance between ecological states.</p>
<p>To conduct EQA, we also need to define the conservation targets.
Column <code>Ref</code> in <code>glomel</code> identifies the stations
considered as reference. We define the <strong>state reference
envelope</strong> using reference station IDs as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glomel_env</span> <span class="op">&lt;-</span> <span class="va">glomel</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">glomel</span><span class="op">$</span><span class="va">Ref</span><span class="op">]</span></span></code></pre></div>
<p>We are now ready to compare the assessed stations with respect to the
state reference envelope using function
<code><a href="../reference/envelope.html">compareToStateEnvelope()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glomel_assess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envelope.html">compareToStateEnvelope</a></span><span class="op">(</span><span class="va">glomel_bc</span>, <span class="va">glomel_env</span>, m<span class="op">=</span><span class="fl">1.7</span>, distances_to_envelope <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">glomel_assess</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Observation Envelope SquaredDist         Q</span></span>
<span><span class="co">## 1          1A     TRUE  0.03790333 1.0000000</span></span>
<span><span class="co">## 2          1B     TRUE  0.07132734 0.8314306</span></span>
<span><span class="co">## 3          1C     TRUE  0.08877350 0.6846406</span></span>
<span><span class="co">## 4          5A     TRUE  0.04364347 1.0000000</span></span>
<span><span class="co">## 5          13     TRUE  0.06748066 0.8701426</span></span>
<span><span class="co">## 6           2    FALSE  0.08788512 0.6911247</span></span></code></pre>
<p>Function <code>compareToStateEnvelope</code> returns
<code>SquaredDist</code>, the squared distance to the envelope centroid,
and the <code>Q</code> statistic, which defines the quality of the
tested stations and is comprised between 0 and 1. We can transform those
values into a <em>qualitative</em> assessment using:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glomel_assess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">glomel_assess</span><span class="op">$</span><span class="va">Q</span><span class="op">&gt;=</span><span class="fl">0.5</span>,<span class="st">"Inside"</span>, <span class="st">"Oustside"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And the assessment for the 18 tested stations is:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glomel_assess</span><span class="op">[</span><span class="op">!</span><span class="va">glomel_assess</span><span class="op">$</span><span class="va">Envelope</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Observation Envelope SquaredDist          Q   Status</span></span>
<span><span class="co">## 6            2    FALSE  0.08788512 0.69112475   Inside</span></span>
<span><span class="co">## 7           3A    FALSE  0.10690364 0.57054500   Inside</span></span>
<span><span class="co">## 8           3B    FALSE  0.03193706 1.00000000   Inside</span></span>
<span><span class="co">## 9           3C    FALSE  0.10365540 0.58868886   Inside</span></span>
<span><span class="co">## 10          5B    FALSE  0.12638739 0.47819512 Oustside</span></span>
<span><span class="co">## 11          6A    FALSE  0.32161421 0.15285304 Oustside</span></span>
<span><span class="co">## 12          6C    FALSE  0.11525495 0.52775487   Inside</span></span>
<span><span class="co">## 13          6D    FALSE  0.39062446 0.11797552 Oustside</span></span>
<span><span class="co">## 14          7A    FALSE  0.30326686 0.16512832 Oustside</span></span>
<span><span class="co">## 15          8A    FALSE  0.17386576 0.33227568 Oustside</span></span>
<span><span class="co">## 16          8B    FALSE  0.20163739 0.27768273 Oustside</span></span>
<span><span class="co">## 17          8C    FALSE  0.45790315 0.09515562 Oustside</span></span>
<span><span class="co">## 18           9    FALSE  0.21340883 0.25886134 Oustside</span></span>
<span><span class="co">## 19          10    FALSE  0.07104764 0.83415862   Inside</span></span>
<span><span class="co">## 20          11    FALSE  0.08829721 0.68810525   Inside</span></span>
<span><span class="co">## 21          12    FALSE  0.03390049 1.00000000   Inside</span></span>
<span><span class="co">## 22         14A    FALSE  0.08051443 0.74876145   Inside</span></span>
<span><span class="co">## 23         14B    FALSE  0.21297195 0.25952180 Oustside</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="representing-eqa-results-graphically">3.4 Representing EQA results graphically<a class="anchor" aria-label="anchor" href="#representing-eqa-results-graphically"></a>
</h3>
<p>To represent the results in a graphical way, we start by conducting a
Principal Coordinates Analysis (PCoA) using package
<strong>ape</strong>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcoa_glom</span><span class="op">&lt;-</span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html" class="external-link">pcoa</a></span><span class="op">(</span><span class="va">glomel_bc</span><span class="op">)</span></span></code></pre></div>
<p>We can use function <code><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot()</a></code> from package
<strong>ape</strong> to show the ordination of stations with the species
projected as arrows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pcoa_glom</span>, <span class="va">glomel_comp</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionEQA_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>To generate a different representation, we first get coordinates of
stations in the two first dimensions of the PCoA and copy them into the
assessment data frame:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCOA_DIM1_2</span> <span class="op">&lt;-</span> <span class="va">pcoa_glom</span><span class="op">[[</span><span class="st">"vectors"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">glomel_assess</span><span class="op">$</span><span class="va">Dim1</span><span class="op">&lt;-</span><span class="va">PCOA_DIM1_2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">glomel_assess</span><span class="op">$</span><span class="va">Dim2</span><span class="op">&lt;-</span><span class="va">PCOA_DIM1_2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">glomel_assess</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Observation Envelope SquaredDist         Q Status       Dim1        Dim2</span></span>
<span><span class="co">## 1          1A     TRUE  0.03790333 1.0000000 Inside -0.2185262  0.05500827</span></span>
<span><span class="co">## 2          1B     TRUE  0.07132734 0.8314306 Inside -0.1897143  0.19276850</span></span>
<span><span class="co">## 3          1C     TRUE  0.08877350 0.6846406 Inside -0.1123913  0.02290741</span></span>
<span><span class="co">## 4          5A     TRUE  0.04364347 1.0000000 Inside -0.1842064 -0.14315651</span></span>
<span><span class="co">## 5          13     TRUE  0.06748066 0.8701426 Inside -0.1594965 -0.17397305</span></span>
<span><span class="co">## 6           2    FALSE  0.08788512 0.6911247 Inside -0.1840068  0.20520893</span></span></code></pre>
<p>We then use package <strong>ggplot</strong> to achieve a nicer
representation of the assessment. Symbol <strong>colors</strong> are
used to illustrate stations that do achieve conservation objectives (in
green) from those that do not achieve them (in red). The
<strong>size</strong> of dots represents the squared distance to the
centroid of the state reference envelope:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">glomel_assess</span>,</span>
<span>          mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dim1</span>,y<span class="op">=</span><span class="va">Dim2</span>,size<span class="op">=</span><span class="va">SquaredDist</span>, color<span class="op">=</span><span class="va">Status</span>, shape<span class="op">=</span><span class="va">Status</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="va">glomel_assess</span>, </span>
<span>            mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dim1</span>,y<span class="op">=</span><span class="va">Dim2</span>,label<span class="op">=</span><span class="va">Observation</span><span class="op">)</span>,</span>
<span>            hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.3</span>, vjust<span class="op">=</span><span class="op">-</span><span class="fl">0.3</span>,size<span class="op">=</span><span class="fl">2.5</span>, color<span class="op">=</span><span class="st">"Black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"PCoA1 (27.7%)"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"PCoA2 (13.7%)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span><span class="op">&lt;-</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># Hide some graphical elements</span></span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="IntroductionEQA_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="impact-of-fishing-activities-on-marine-habitats">4. Impact of fishing activities on marine habitats<a class="anchor" aria-label="anchor" href="#impact-of-fishing-activities-on-marine-habitats"></a>
</h2>
<div class="section level3">
<h3 id="context-1">4.1 Context<a class="anchor" aria-label="anchor" href="#context-1"></a>
</h3>
<p>We used an experimental data set built by Tauran et al. (2020) to
study the impact of fishing dredges and varying fishing pressures on
maerl beds, in the bay of Brest (Brittany, France). The study follows a
Before-After-Control-Impact design (Stewart-Oaten et al., 1986).
Briefly, three control stations were surveyed and compared to five
treatment stations characterized by different fishing dredges and
pressure levels (Tauran et al., 2020). Three <strong>fishing
dredges</strong> are compared: (1) a clam dredge (CD), 70 to 90 kg, 1.5
m wide, 40 teeth of 11 cm each; (2) a queen scallop dredge (QSD), 120
kg,1.8 m wide, with a blade; and (3) a king scallop dredge
(<strong>KSD</strong>), 190 kg, 1.8 m wide, 18 teeth of 10 cm each every
9 cm. Pressure levels were measured as the <strong>number of dredge
tows</strong> performed on the zone during the experimental dredging
session: 0 (i.e. control), 10, or 30 dredge tows. Samples were collected
from April 2016 to April2017. Session 1 was sampled just before the
experimental dredging (t0); session 2 at t0 + 1 week; session 3 at t0 +
1 month and session 4 at t0 + 12 months. Nine replicates were sampled
for all treatments and sessions with a Smith-McIntyre grab (0.1m2).
Abundance data were pooled at the treatment levels (i.e. CTRL1, CTRL2,
CTRL3, KSD_10, CD_10, CD_30, QSD_10 and QSD_30; Appendix_D).</p>
</div>
<div class="section level3">
<h3 id="loading-data-1">4.2 Loading data<a class="anchor" aria-label="anchor" href="#loading-data-1"></a>
</h3>
<p>The data set has 32 observations (i.e. treatments*surveys) and 250
species. We begin by loading the data:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glenan</span><span class="op">)</span></span>
<span><span class="co">#Showing a first lines /columns subset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">glenan</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          Abundance.Abludomelita gladiosa Abundance.Abra alba</span></span>
<span><span class="co">## CD_10-S1                              60                  15</span></span>
<span><span class="co">## CD_10-S2                              54                  14</span></span>
<span><span class="co">## CD_10-S3                              42                  15</span></span>
<span><span class="co">## CD_10-S4                              45                   8</span></span>
<span><span class="co">## CD_30-S1                              58                  18</span></span>
<span><span class="co">## CD_30-S2                              39                  19</span></span>
<span><span class="co">##          Abundance.Acanthochitona fascicularis Abundance.Achelia hispida</span></span>
<span><span class="co">## CD_10-S1                                     2                         0</span></span>
<span><span class="co">## CD_10-S2                                     1                         0</span></span>
<span><span class="co">## CD_10-S3                                     0                         0</span></span>
<span><span class="co">## CD_10-S4                                     0                         0</span></span>
<span><span class="co">## CD_30-S1                                     4                         0</span></span>
<span><span class="co">## CD_30-S2                                     3                         0</span></span>
<span><span class="co">##          Abundance.Alcyonidium diaphanum Abundance.Alentia gelatinosa</span></span>
<span><span class="co">## CD_10-S1                               0                            1</span></span>
<span><span class="co">## CD_10-S2                               0                            0</span></span>
<span><span class="co">## CD_10-S3                               0                            0</span></span>
<span><span class="co">## CD_10-S4                               0                            0</span></span>
<span><span class="co">## CD_30-S1                               0                            0</span></span>
<span><span class="co">## CD_30-S2                               0                            0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="definition-of-the-ressemblance-space">4.3 Definition of the ressemblance space<a class="anchor" aria-label="anchor" href="#definition-of-the-ressemblance-space"></a>
</h3>
<p>We separate the columns that identify the treatment and surveys.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#vector Treatment</span></span>
<span><span class="va">Treatment</span><span class="op">&lt;-</span><span class="va">glenan</span><span class="op">$</span><span class="va">Treatment</span></span>
<span></span>
<span><span class="co">#vector Surveys</span></span>
<span><span class="va">Surveys</span><span class="op">&lt;-</span><span class="va">glenan</span><span class="op">$</span><span class="va">Surveys</span></span></code></pre></div>
<p>We also extract the compositional data and log-transform it as
initially performed in Tauran et al. (2020).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#log transformation</span></span>
<span><span class="va">grab_comp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log1p</a></span><span class="op">(</span><span class="va">glenan</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">251</span><span class="op">:</span><span class="fl">252</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Using the compositional data, we can use function
<code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist()</a></code> from package <strong>vegan</strong> to calculate
of Bray Curtis distances between ecosystem states:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grab_bc</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">grab_comp</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span></code></pre></div>
<p>Like in the first example, the distance matrix <code>grab_bc</code>
defines the multivariate space that represents the ressemblance between
ecological states of maerl beds.</p>
</div>
<div class="section level3">
<h3 id="state-based-eqa">4.4 State-based EQA<a class="anchor" aria-label="anchor" href="#state-based-eqa"></a>
</h3>
<p>In addition to the resemblance space, to conduct the EQA we need to
define the conservation targets. In this case, we define the states
conforming our <strong>state reference envelope</strong> manually among
the observation IDs:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Definition of the state reference envelope</span></span>
<span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">grab_comp</span><span class="op">)</span></span>
<span><span class="va">grab_env</span> <span class="op">&lt;-</span> <span class="va">ID</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">21</span>,<span class="fl">25</span>,<span class="fl">29</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We are now ready to compare the assessed stations with respect to the
state reference envelope using function
<code><a href="../reference/envelope.html">compareToStateEnvelope()</a></code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Comparing assessed stations with respect to the state reference envelope</span></span>
<span><span class="va">grab_assess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envelope.html">compareToStateEnvelope</a></span><span class="op">(</span><span class="va">grab_bc</span>, <span class="va">grab_env</span>, m<span class="op">=</span><span class="fl">1.5</span>, </span>
<span>                                      distances_to_envelope <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As before we derive a qualitative assessment:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Q</span><span class="op">&gt;=</span><span class="fl">0.5</span>,<span class="st">"Inside"</span>, <span class="st">"Outside"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">21</span>,<span class="fl">25</span>,<span class="fl">29</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"Reference"</span></span>
<span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Reference"</span>,<span class="st">"Inside"</span>,<span class="st">"Outside"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grab_assess</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Observation Envelope SquaredDist         Q    Status</span></span>
<span><span class="co">## 1    CD_10-S1     TRUE  0.03374086 0.5587631 Reference</span></span>
<span><span class="co">## 2    CD_10-S2    FALSE  0.02316547 0.9025909    Inside</span></span>
<span><span class="co">## 3    CD_10-S3    FALSE  0.04174879 0.4041249   Outside</span></span>
<span><span class="co">## 4    CD_10-S4    FALSE  0.03802341 0.4677650   Outside</span></span>
<span><span class="co">## 5    CD_30-S1    FALSE  0.02940983 0.6757536    Inside</span></span>
<span><span class="co">## 6    CD_30-S2    FALSE  0.04151217 0.4078031   Outside</span></span></code></pre>
<p>As before, we can represent the results of the state-based EQA on in
the two first dimensions of a Principal Coordinates Analysis:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Get coordinates of stations in the two first dimensions of the PCoA</span></span>
<span><span class="va">pcoa</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html" class="external-link">pcoa</a></span><span class="op">(</span><span class="va">grab_bc</span><span class="op">)</span></span>
<span><span class="va">PCOA_DIM1_2</span><span class="op">&lt;-</span><span class="va">pcoa</span><span class="op">[[</span><span class="st">"vectors"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Dim1</span><span class="op">&lt;-</span><span class="va">PCOA_DIM1_2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Dim2</span><span class="op">&lt;-</span><span class="va">PCOA_DIM1_2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Information about Treatment and Surveys </span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Treatment</span><span class="op">&lt;-</span><span class="va">Treatment</span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Surveys</span><span class="op">&lt;-</span><span class="va">Surveys</span></span>
<span></span>
<span></span>
<span><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">grab_assess</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dim1</span>, y<span class="op">=</span><span class="va">Dim2</span>, group<span class="op">=</span><span class="va">Status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape<span class="op">=</span><span class="va">Status</span>, color<span class="op">=</span><span class="va">Status</span>, size<span class="op">=</span><span class="va">SquaredDist</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span>, <span class="fl">17</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BFC4"</span>, <span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dim1</span>,y<span class="op">=</span><span class="va">Dim2</span>,group<span class="op">=</span><span class="va">Treatment</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"grey"</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="va">grab_assess</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Dim1</span>,y<span class="op">=</span><span class="va">Dim2</span>,label<span class="op">=</span><span class="va">ID</span><span class="op">)</span>,hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.3</span>, vjust<span class="op">=</span><span class="op">-</span><span class="fl">0.3</span>,size<span class="op">=</span><span class="fl">2.5</span>, color<span class="op">=</span><span class="st">"Black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"PCoA1 (13.3%)"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"PCoA2 (9.9%)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span><span class="op">&lt;-</span><span class="va">p</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># Hide some graphical elements</span></span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="IntroductionEQA_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<p>Since we are dealing with temporal data, we can create a bar plot
showing the evolution of the squared distance to the centroid of the
state reference envelope during the study period for each treatment:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Treatment</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Treatment</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL1"</span>,<span class="st">"CTRL2"</span>,<span class="st">"CTRL3"</span>,</span>
<span>                                                      <span class="st">"CD_10"</span>,<span class="st">"CD_30"</span>, </span>
<span>                                                      <span class="st">"QSD_10"</span>,<span class="st">"QSD_30"</span>,</span>
<span>                                                      <span class="st">"KSD_10"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Q</span><span class="op">&gt;=</span><span class="fl">0.5</span>,<span class="st">"Inside"</span>, <span class="st">"Outside"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grab_assess</span><span class="op">$</span><span class="va">Status</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Inside"</span>,<span class="st">"Outside"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">grab_assess</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Surveys</span>, y<span class="op">=</span><span class="va">SquaredDist</span>, color<span class="op">=</span><span class="va">Status</span>, fill<span class="op">=</span><span class="va">Status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,width<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Squared distance to the reference envelope"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Treatment</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionEQA_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>In addition, we can create the heatmap showing the evolution of the
distance between control and dredged stations during the
experimentation:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grabbc_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">grab_bc</span><span class="op">)</span>,rnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#selection of the observation of interest (i.e. control stations for heat map row, and dredged stations for heat map column)</span></span>
<span><span class="va">grabbc_sel</span><span class="op">&lt;-</span><span class="va">grabbc_sel</span><span class="op">[</span><span class="op">!</span><span class="va">grabbc_sel</span><span class="op">$</span><span class="va">Var2</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL1-S1"</span>,<span class="st">"CTRL2-S1"</span>,<span class="st">"CTRL3-S1"</span>,<span class="st">"CTRL4-S1"</span>,</span>
<span>                                                <span class="st">"CTRL1-S2"</span>,<span class="st">"CTRL2-S2"</span>,<span class="st">"CTRL3-S2"</span>,<span class="st">"CTRL4-S2"</span>,</span>
<span>                                                <span class="st">"CTRL1-S3"</span>,<span class="st">"CTRL2-S3"</span>,<span class="st">"CTRL3-S3"</span>,<span class="st">"CTRL4-S3"</span>,</span>
<span>                                                <span class="st">"CTRL1-S4"</span>,<span class="st">"CTRL2-S4"</span>,<span class="st">"CTRL3-S4"</span>,<span class="st">"CTRL4-S4"</span><span class="op">)</span>,<span class="op">]</span>   </span>
<span></span>
<span><span class="va">grabbc_sel</span><span class="op">&lt;-</span><span class="va">grabbc_sel</span><span class="op">[</span><span class="va">grabbc_sel</span><span class="op">$</span><span class="va">Var1</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL1-S1"</span>,<span class="st">"CTRL2-S1"</span>,<span class="st">"CTRL3-S1"</span>,<span class="st">"CTRL4-S1"</span>,</span>
<span>                                               <span class="st">"CTRL1-S2"</span>,<span class="st">"CTRL2-S2"</span>,<span class="st">"CTRL3-S2"</span>,<span class="st">"CTRL4-S2"</span>,</span>
<span>                                               <span class="st">"CTRL1-S3"</span>,<span class="st">"CTRL2-S3"</span>,<span class="st">"CTRL3-S3"</span>,<span class="st">"CTRL4-S3"</span>,</span>
<span>                                               <span class="st">"CTRL1-S4"</span>,<span class="st">"CTRL2-S4"</span>,<span class="st">"CTRL3-S4"</span>,<span class="st">"CTRL4-S4"</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">grabbc_sel</span><span class="op">$</span><span class="va">Var1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grabbc_sel</span><span class="op">$</span><span class="va">Var1</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL1-S1"</span>,<span class="st">"CTRL2-S1"</span>,<span class="st">"CTRL3-S1"</span>,<span class="st">"CTRL4-S1"</span>,</span>
<span>                          <span class="st">"CTRL1-S2"</span>,<span class="st">"CTRL2-S2"</span>,<span class="st">"CTRL3-S2"</span>,<span class="st">"CTRL4-S2"</span>,</span>
<span>                          <span class="st">"CTRL1-S3"</span>,<span class="st">"CTRL2-S3"</span>,<span class="st">"CTRL3-S3"</span>,<span class="st">"CTRL4-S3"</span>,</span>
<span>                          <span class="st">"CTRL1-S4"</span>,<span class="st">"CTRL2-S4"</span>,<span class="st">"CTRL3-S4"</span>,<span class="st">"CTRL4-S4"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grabbc_sel</span><span class="op">$</span><span class="va">Var2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grabbc_sel</span><span class="op">$</span><span class="va">Var2</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KSD_10-S1"</span>,<span class="st">"CD_10-S1"</span>,<span class="st">"CD_30-S1"</span>,<span class="st">"QSD_10-S1"</span>,<span class="st">"QSD_30-S1"</span>,</span>
<span>                          <span class="st">"KSD_10-S2"</span>,<span class="st">"CD_10-S2"</span>,<span class="st">"CD_30-S2"</span>,<span class="st">"QSD_10-S2"</span>,<span class="st">"QSD_30-S2"</span>,</span>
<span>                          <span class="st">"KSD_10-S3"</span>,<span class="st">"CD_10-S3"</span>,<span class="st">"CD_30-S3"</span>,<span class="st">"QSD_10-S3"</span>,<span class="st">"QSD_30-S3"</span>,</span>
<span>                          <span class="st">"KSD_10-S4"</span>,<span class="st">"CD_10-S4"</span>,<span class="st">"CD_30-S4"</span>,<span class="st">"QSD_10-S4"</span>,<span class="st">"QSD_30-S4"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">grabbc_sel</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Var2</span>, y<span class="op">=</span><span class="va">Var1</span>, fill<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionEQA_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="trajectory-based-eqa">4.5 Trajectory-based EQA<a class="anchor" aria-label="anchor" href="#trajectory-based-eqa"></a>
</h3>
<p>One of the nice features of EQA is the possibility to conduct the
quality assessment taking into account ecosystem dynamics. In this case,
the conservation target is defined by a set of trajectories conforming a
<strong>trajectory reference envelope</strong>, which in our case are
the three control stations:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Definition of the trajectory reference envelope </span></span>
<span><span class="va">grab_dynenv</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL1"</span>,<span class="st">"CTRL2"</span>,<span class="st">"CTRL3"</span><span class="op">)</span></span></code></pre></div>
<p>We are now ready to compare the assessed trajectories (those subject
to treatment) with respect to the trajectory reference envelope using
function <code><a href="../reference/envelope.html">compareToTrajectoryEnvelope()</a></code>:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Comparing assessed trajectories with respect to the trajectory reference envelope</span></span>
<span><span class="va">grab_dynassess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envelope.html">compareToTrajectoryEnvelope</a></span><span class="op">(</span><span class="va">grab_bc</span>,<span class="va">Treatment</span>, <span class="va">grab_dynenv</span>, </span>
<span>                                              m<span class="op">=</span><span class="fl">1.5</span>, distances_to_envelope <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As before, we can create a bar plot showing the squared distance to
the centroid of the trajectory reference envelope during the study
period for each treatment:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grab_dynassess</span><span class="op">$</span><span class="va">Treatment</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grab_dynassess</span><span class="op">$</span><span class="va">Site</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CTRL1"</span>,<span class="st">"CTRL2"</span>,<span class="st">"CTRL3"</span>,</span>
<span>                                                      <span class="st">"CD_10"</span>,<span class="st">"CD_30"</span>, </span>
<span>                                                      <span class="st">"QSD_10"</span>,<span class="st">"QSD_30"</span>,</span>
<span>                                                      <span class="st">"KSD_10"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grab_dynassess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">grab_dynassess</span><span class="op">$</span><span class="va">Q</span><span class="op">&gt;=</span><span class="fl">0.5</span>,<span class="st">"Inside"</span>, <span class="st">"Outside"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grab_dynassess</span><span class="op">$</span><span class="va">Status</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grab_dynassess</span><span class="op">$</span><span class="va">Status</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Inside"</span>,<span class="st">"Outside"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">grab_dynassess</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">Treatment</span>, <span class="va">SquaredDist</span><span class="op">)</span>, </span>
<span>                           y<span class="op">=</span><span class="va">SquaredDist</span>, color<span class="op">=</span><span class="va">Status</span>, fill<span class="op">=</span><span class="va">Status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,width<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Squared distance to the reference envelope"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionEQA_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">5. References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Sturbois, A., De Cáceres, M., Bifolchi, A., Bioret, F., Boyé, A.,
Gauthier, O., Grall, J., Grémare, A., Labrune, C., Robert, A., Schaal,
G., Desroy, N. (under review). Ecological Quality Assessment: a general
multivariate framework to report the quality of ecosystems and their
dynamics with respect to reference conditions.</p></li>
<li><p>Tauran, A., Dubreuil, J., Guyonnet, B., Grall, J., 2020. Impact
of fishing gears and fishing intensities on maerl beds: An experimental
approach. Journal of Experimental Marine Biology and Ecology 533,
151472. <a href="https://doi.org/10.1016/j.jembe.2020.151472" class="external-link uri">https://doi.org/10.1016/j.jembe.2020.151472</a></p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miquel De Cáceres, Anthony Sturbois.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
