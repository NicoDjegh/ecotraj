<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Distance metrics for trajectory resemblance • ecotraj</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distance metrics for trajectory resemblance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/TransformingTrajectories.html">Transforming trajectories</a></li>
    <li><a class="dropdown-item" href="../articles/TrajectoryDistanceMetrics.html">Distance metrics for trajectory resemblance</a></li>
    <li><a class="dropdown-item" href="../articles/Dissimilarities.html">Dissimilarities in community data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Stable Isotope Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Introduction to Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cyclical Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionCETA.html">Introduction to Cyclical Ecological Trajectory Analysis (CETA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Distance metrics for trajectory resemblance</h1>
                        <h4 data-toc-skip class="author">Miquel De
Cáceres</h4>
            
            <h4 data-toc-skip class="date">2025-10-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/vignettes/TrajectoryDistanceMetrics.Rmd" class="external-link"><code>vignettes/TrajectoryDistanceMetrics.Rmd</code></a></small>
      <div class="d-none name"><code>TrajectoryDistanceMetrics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="about-this-vignette">1.1 About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h3>
<p>In this vignette you will learn the differences between three
distance coefficients available for assessing trajectory resemblance. We
use small datasets where trajectories occur in a space of two
dimensions, so that geometric calculations can be followed more easily.
First of all, we load <code>ecotraj</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/ecotraj/">ecotraj</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Rcpp</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-three-distance-metrics">1.2 The three distance metrics<a class="anchor" aria-label="anchor" href="#the-three-distance-metrics"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>1</mn></msub><annotation encoding="application/x-tex">T_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>
be two trajectories to be compared. The first distance metric is
<strong>Segment Path Distance (SPD)</strong> (Besse et al. 2016),
defined as the average of the distances between each <em>point</em>
composing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>1</mn></msub><annotation encoding="application/x-tex">T_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>D</mi><mrow><mi>p</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">D_{SP}(T_1, T_2) = \frac{1}{n}\sum_{i=1}^{n}{D_{pt}(x_{1i}, T_2)}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>p</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">D_{pt}</annotation></semantics></math>
is the <em>distance between a point a a trajectory</em>. SPD is not
symmetric so it needs to be symmetrized:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>S</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>D</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>D</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>2</mn></msub><mo>,</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">D_{SSP}(T_1, T_2) = \frac{D_{SP}(T_1, T_2) + D_{SP}(T_2, T_1)}{2}</annotation></semantics></math></p>
<p>SPD is appropriate to compare the <em>location</em> and
<em>shape</em> of trajectories, but is not sensitive to trajectory
<em>direction</em>. For this reason, De Cáceres et al. (2019) introduced
the <strong>Directed Segment Path Dissimilarity (DSPD)</strong>, defined
as the average of the distance between each <em>directed segment</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>1</mn></msub><annotation encoding="application/x-tex">T_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>D</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>D</mi><mrow><mi>D</mi><mi>S</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">D_{DSP}(T_1, T_2) = \frac{1}{n-1}\sum_{i=1}^{n-1}{D_{DS}(S_{1i}, T_2)}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><annotation encoding="application/x-tex">D_{SP}</annotation></semantics></math>
is the <em>distance between a segment and a trajectory</em>. As before,
DSPD is not symmetric so it needs to be symmetrized:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>S</mi><mi>D</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>D</mi><mrow><mi>D</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>D</mi><mrow><mi>D</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>2</mn></msub><mo>,</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">D_{SDSP}(T_1, T_2) = \frac{D_{DSP}(T_1, T_2) + D_{DSP}(T_2, T_1)}{2}</annotation></semantics></math></p>
<p>DSPD is an appropriate metric to compare the <em>location</em>,
<em>shape</em> and <em>direction</em> of trajectories. Nevertheless, the
metric does not allow taking into account differences in trajectory
<em>speed</em>, because it does not use the information regarding the
time of observations (only the survey order).</p>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>1</mn></msub><annotation encoding="application/x-tex">T_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>
represent the dynamics of two sites that have been surveyed
synchronously (i.e., if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n = m</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>11</mn></msub><mo>=</mo><msub><mi>t</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">t_{11} = t_{21}</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>12</mn></msub><mo>=</mo><msub><mi>t</mi><mn>22</mn></msub></mrow><annotation encoding="application/x-tex">t_{12}=t_{22}</annotation></semantics></math>;…
;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub><mo>=</mo><msub><mi>t</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{1n} = t_{2n}</annotation></semantics></math>),
a straightforward way of comparing them is to calculate the average
across surveys of dissimilarity between the two sites, i.e. the mean of
the sequence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>11</mn></msub><mo>,</mo><msub><mi>x</mi><mn>21</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>12</mn></msub><mo>,</mo><msub><mi>x</mi><mn>22</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>…</mi><mo>,</mo><mspace width="0.167em"></mspace><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>x</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{d(x_{11}, x_{21}), \, d(x_{12}, x_{22}), \, \dots,\, d(x_{1n}, x_{2n})\}</annotation></semantics></math>.
For a more general solution the <strong>Time-Sensitive Path Distance
(TSPD)</strong> is the average of distances between each
<em>observation</em> in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>1</mn></msub><annotation encoding="application/x-tex">T_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>t</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">D_{TSP}(T_1, T_2) = \frac{1}{n}\sum_{i=1}^{n}{D_{ot}(\{x_{1i}, t_{1i}\}, T_2)}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>o</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">D_{ot}</annotation></semantics></math>
is the <em>distance between an observation and a trajectory</em>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>o</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">D_{ot}</annotation></semantics></math>
is the calculated as the distance between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">x_{1i}</annotation></semantics></math>
and the point in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>
corresponding to time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">t_{1i}</annotation></semantics></math>,
which may need to be interpolated if does not correspond to any value in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>t</mi><mn>21</mn></msub><mo>,</mo><msub><mi>t</mi><mn>22</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>t</mi><mrow><mn>2</mn><mi>m</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{t_{21}, t_{22}, \dots,t_{2m}\}</annotation></semantics></math>.
If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">t_{1i}</annotation></semantics></math>
is beyond the time boundaries of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>,
then the distance to the closest time point is taken. As before, TSPD is
not symmetric so it needs to be symmetrized:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>S</mi><mi>T</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>D</mi><mrow><mi>T</mi><mi>S</mi><mi>P</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>2</mn></msub><mo>,</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">D_{STSP}(T_1, T_2) = \frac{D_{TSP}(T_1, T_2) + D_{TSP}(T_2, T_1)}{2}</annotation></semantics></math></p>
<p>TSPD is sensitive to differences in <em>location</em>,
<em>shape</em>, <em>direction</em> and <em>speed</em>, as will be
illustrated in the following examples.</p>
</div>
</div>
<div class="section level2">
<h2 id="linear-trajectories">2. Linear trajectories<a class="anchor" aria-label="anchor" href="#linear-trajectories"></a>
</h2>
<p>Let us first compare the behavior of the three distance metrics for
comparisons between linear trajectories. In all cases, the reference
trajectory is composed of three linear segments.</p>
<div class="section level3">
<h3 id="oposed-linear-trajectories">2.1 Oposed linear trajectories<a class="anchor" aria-label="anchor" href="#oposed-linear-trajectories"></a>
</h3>
<p>We compare first a linear trajectory with its oposed one, i.e. a
trajectory going in the exact oposite sense.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>, <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">8</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<p>We can display the two (overlapping) trajectories using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The two trajectories have the same lengths and speeds:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    3</span></span>
<span><span class="co">## 2  1  1  1    3</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    1</span></span>
<span><span class="co">## 2  1  1  1    1</span></span></code></pre>
<p>When we examine trajectory (temporal) shifts we see the oposing
character:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   reference site survey time timeRef shift</span></span>
<span><span class="co">## 1         1    2      1    0       3     3</span></span>
<span><span class="co">## 2         1    2      2    1       2     1</span></span>
<span><span class="co">## 3         1    2      3    2       1    -1</span></span>
<span><span class="co">## 4         1    2      4    3       0    -3</span></span>
<span><span class="co">## 5         2    1      1    0       3     3</span></span>
<span><span class="co">## 6         2    1      2    1       2     1</span></span>
<span><span class="co">## 7         2    1      3    2       1    -1</span></span>
<span><span class="co">## 8         2    1      4    3       0    -3</span></span></code></pre>
<p>Calculating SPD yields zero dissimilarity, because the distance does
not take into account differences in direction:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1</span></span>
<span><span class="co">## 2 0</span></span></code></pre>
<p>The other two dissimilarity metrics do yield non-zero values:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1</span></span>
<span><span class="co">## 2 1</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1</span></span>
<span><span class="co">## 2 2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="equal-pathways-and-speeds-but-different-number-of-segments">2.2 Equal pathways and speeds but different number of segments<a class="anchor" aria-label="anchor" href="#equal-pathways-and-speeds-but-different-number-of-segments"></a>
</h3>
<p>Here we compare three trajectories with the same linear pathway and
speed. They only differ in the number of segments used to describe
them:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">1.5</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">9</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1.5</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<p>We plot the three trajectories in separate panels for clarity:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"1"</span><span class="op">)</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"2"</span><span class="op">)</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"3"</span><span class="op">)</span>,</span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;">
Note that reversals may occur because of PCoA eigen analysis. But
together the trajectories look like:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can check that the three trajectories have the same total length
and average speed:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    S1  S2 S3 Path</span></span>
<span><span class="co">## 1 1.0 1.0  1    3</span></span>
<span><span class="co">## 2 1.5 1.5 NA    3</span></span>
<span><span class="co">## 3 3.0  NA NA    3</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    1</span></span>
<span><span class="co">## 2  1  1 NA    1</span></span>
<span><span class="co">## 3  1 NA NA    1</span></span></code></pre>
<p>There are no temporal shifts between the trajectories:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    reference site survey time timeRef shift</span></span>
<span><span class="co">## 1          1    2      1  0.0     0.0     0</span></span>
<span><span class="co">## 2          1    2      2  1.5     1.5     0</span></span>
<span><span class="co">## 3          1    2      3  3.0     3.0     0</span></span>
<span><span class="co">## 4          1    3      1  0.0     0.0     0</span></span>
<span><span class="co">## 5          1    3      2  3.0     3.0     0</span></span>
<span><span class="co">## 6          2    1      1  0.0     0.0     0</span></span>
<span><span class="co">## 7          2    1      2  1.0     1.0     0</span></span>
<span><span class="co">## 8          2    1      3  2.0     2.0     0</span></span>
<span><span class="co">## 9          2    1      4  3.0     3.0     0</span></span>
<span><span class="co">## 10         2    3      1  0.0     0.0     0</span></span>
<span><span class="co">## 11         2    3      2  3.0     3.0     0</span></span>
<span><span class="co">## 12         3    1      1  0.0      NA    NA</span></span>
<span><span class="co">## 13         3    1      2  1.0      NA    NA</span></span>
<span><span class="co">## 14         3    1      3  2.0      NA    NA</span></span>
<span><span class="co">## 15         3    1      4  3.0      NA    NA</span></span>
<span><span class="co">## 16         3    2      1  0.0      NA    NA</span></span>
<span><span class="co">## 17         3    2      2  1.5     1.5     0</span></span>
<span><span class="co">## 18         3    2      3  3.0      NA    NA</span></span></code></pre>
<p>Here SPD yields zero distance, because the three trajectories have
the same shape:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1 2</span></span>
<span><span class="co">## 2 0  </span></span>
<span><span class="co">## 3 0 0</span></span></code></pre>
<p>Since it is defined by means of distances between directed segments,
DSPD seems to be affected by the different segmentation of trajectories,
so that it yields non-zero values:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.5833333          </span></span>
<span><span class="co">## 3 1.3333333 1.5000000</span></span></code></pre>
<p>In contrast, TSPD yields again zero distance values, because the
trajectories do not differ in neither speed or shape.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1 2</span></span>
<span><span class="co">## 2 0  </span></span>
<span><span class="co">## 3 0 0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="equal-pathways-but-different-speeds">2.3 Equal pathways but different speeds<a class="anchor" aria-label="anchor" href="#equal-pathways-but-different-speeds"></a>
</h3>
<p>In this example the three trajectories have the same segments and
pathways, but they differ in the speed of changes:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1.5</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<p>Again we use separate plots to show the differences in speed:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"1"</span><span class="op">)</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"2"</span><span class="op">)</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"3"</span><span class="op">)</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;">
We can check that there are no differences in segment or total path
lengths, but they indeed differ in trajectory speed:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    3</span></span>
<span><span class="co">## 2  1  1  1    3</span></span>
<span><span class="co">## 3  1  1  1    3</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    S1  S2  S3 Path</span></span>
<span><span class="co">## 1 2.0 2.0 2.0  2.0</span></span>
<span><span class="co">## 2 1.0 1.0 1.0  1.0</span></span>
<span><span class="co">## 3 0.5 0.5 0.5  0.5</span></span></code></pre>
<p>Differences in speed also lead to temporal shifts between
trajectories:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    reference site survey time timeRef shift</span></span>
<span><span class="co">## 1          1    2      1  0.0     0.0   0.0</span></span>
<span><span class="co">## 2          1    2      2  1.0     0.5  -0.5</span></span>
<span><span class="co">## 3          1    2      3  2.0     1.0  -1.0</span></span>
<span><span class="co">## 4          1    2      4  3.0     1.5  -1.5</span></span>
<span><span class="co">## 5          1    3      1  0.0     0.0   0.0</span></span>
<span><span class="co">## 6          1    3      2  2.0     0.5  -1.5</span></span>
<span><span class="co">## 7          1    3      3  4.0     1.0  -3.0</span></span>
<span><span class="co">## 8          1    3      4  6.0     1.5  -4.5</span></span>
<span><span class="co">## 9          2    1      1  0.0     0.0   0.0</span></span>
<span><span class="co">## 10         2    1      2  0.5     1.0   0.5</span></span>
<span><span class="co">## 11         2    1      3  1.0     2.0   1.0</span></span>
<span><span class="co">## 12         2    1      4  1.5     3.0   1.5</span></span>
<span><span class="co">## 13         2    3      1  0.0     0.0   0.0</span></span>
<span><span class="co">## 14         2    3      2  2.0     1.0  -1.0</span></span>
<span><span class="co">## 15         2    3      3  4.0     2.0  -2.0</span></span>
<span><span class="co">## 16         2    3      4  6.0     3.0  -3.0</span></span>
<span><span class="co">## 17         3    1      1  0.0     0.0   0.0</span></span>
<span><span class="co">## 18         3    1      2  0.5     2.0   1.5</span></span>
<span><span class="co">## 19         3    1      3  1.0     4.0   3.0</span></span>
<span><span class="co">## 20         3    1      4  1.5     6.0   4.5</span></span>
<span><span class="co">## 21         3    2      1  0.0     0.0   0.0</span></span>
<span><span class="co">## 22         3    2      2  1.0     2.0   1.0</span></span>
<span><span class="co">## 23         3    2      3  2.0     4.0   2.0</span></span>
<span><span class="co">## 24         3    2      4  3.0     6.0   3.0</span></span></code></pre>
<p>If we calculate distances using SPD, the distance metric does not
detect the differences in speed and tells us that the trajectories are
equal:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1 2</span></span>
<span><span class="co">## 2 0  </span></span>
<span><span class="co">## 3 0 0</span></span></code></pre>
<p>And the same happens with DSPD:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1 2</span></span>
<span><span class="co">## 2 0  </span></span>
<span><span class="co">## 3 0 0</span></span></code></pre>
<p>It is only when we apply TSPD that we can observe differences between
trajectories:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        1      2</span></span>
<span><span class="co">## 2 0.6250       </span></span>
<span><span class="co">## 3 0.9375 0.6250</span></span></code></pre>
<p>The distance between the first and the third trajectory is largest
because their difference in speed is also largest.</p>
</div>
<div class="section level3">
<h3 id="space-shifted-trajectories">2.4 Space-shifted trajectories<a class="anchor" aria-label="anchor" href="#space-shifted-trajectories"></a>
</h3>
<p>Let us now evaluate a case where trajectories are the same but have
been displaced in one dimension:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="co"># States are all shifted half unit with respect to site "1"</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.5</span> </span>
<span><span class="co"># States are all shifted one unit with respect to site "1"</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.0</span>  </span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<p>We use a single plot, though not very clear, to display the three
trajectories:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;">
In this case differences do not exist in terms of lengths nor
speeds:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    3</span></span>
<span><span class="co">## 2  1  1  1    3</span></span>
<span><span class="co">## 3  1  1  1    3</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    1</span></span>
<span><span class="co">## 2  1  1  1    1</span></span>
<span><span class="co">## 3  1  1  1    1</span></span></code></pre>
<p>But (temporal) shifts reflect the spatial ones:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    reference site survey time timeRef shift</span></span>
<span><span class="co">## 1          1    2      1    1     1.5   0.5</span></span>
<span><span class="co">## 2          1    2      2    2     2.5   0.5</span></span>
<span><span class="co">## 3          1    2      3    3     3.5   0.5</span></span>
<span><span class="co">## 4          1    2      4    4      NA    NA</span></span>
<span><span class="co">## 5          1    3      1    1     2.0   1.0</span></span>
<span><span class="co">## 6          1    3      2    2     3.0   1.0</span></span>
<span><span class="co">## 7          1    3      3    3     4.0   1.0</span></span>
<span><span class="co">## 8          1    3      4    4      NA    NA</span></span>
<span><span class="co">## 9          2    1      1    1      NA    NA</span></span>
<span><span class="co">## 10         2    1      2    2     1.5  -0.5</span></span>
<span><span class="co">## 11         2    1      3    3     2.5  -0.5</span></span>
<span><span class="co">## 12         2    1      4    4     3.5  -0.5</span></span>
<span><span class="co">## 13         2    3      1    1     1.5   0.5</span></span>
<span><span class="co">## 14         2    3      2    2     2.5   0.5</span></span>
<span><span class="co">## 15         2    3      3    3     3.5   0.5</span></span>
<span><span class="co">## 16         2    3      4    4      NA    NA</span></span>
<span><span class="co">## 17         3    1      1    1      NA    NA</span></span>
<span><span class="co">## 18         3    1      2    2     1.0  -1.0</span></span>
<span><span class="co">## 19         3    1      3    3     2.0  -1.0</span></span>
<span><span class="co">## 20         3    1      4    4     3.0  -1.0</span></span>
<span><span class="co">## 21         3    2      1    1      NA    NA</span></span>
<span><span class="co">## 22         3    2      2    2     1.5  -0.5</span></span>
<span><span class="co">## 23         3    2      3    3     2.5  -0.5</span></span>
<span><span class="co">## 24         3    2      4    4     3.5  -0.5</span></span></code></pre>
<p>In this case, all three metrics are responsive to differences in
trajectory location:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       1     2</span></span>
<span><span class="co">## 2 0.125      </span></span>
<span><span class="co">## 3 0.250 0.125</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.5000000          </span></span>
<span><span class="co">## 3 0.3333333 0.5000000</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     1   2</span></span>
<span><span class="co">## 2 0.5    </span></span>
<span><span class="co">## 3 1.0 0.5</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="space-expanded-trajectories">2.5 Space-expanded trajectories<a class="anchor" aria-label="anchor" href="#space-expanded-trajectories"></a>
</h3>
<p>In this example, the three linear trajectories are surveyed the same
times but they differ in total path length due to differences in
trajectory speed.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">1.5</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">2</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<p>We draw the three (overlapping) trajectories:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-29-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In this case both lengths and speeds are different between
trajectories:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    S1  S2  S3 Path</span></span>
<span><span class="co">## 1 1.0 1.0 1.0  3.0</span></span>
<span><span class="co">## 2 1.5 1.5 1.5  4.5</span></span>
<span><span class="co">## 3 2.0 2.0 2.0  6.0</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    S1  S2  S3 Path</span></span>
<span><span class="co">## 1 1.0 1.0 1.0  1.0</span></span>
<span><span class="co">## 2 1.5 1.5 1.5  1.5</span></span>
<span><span class="co">## 3 2.0 2.0 2.0  2.0</span></span></code></pre>
<p>This is also translated to trajectory shifts:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    reference site survey time   timeRef      shift</span></span>
<span><span class="co">## 1          1    2      1    0 0.0000000  0.0000000</span></span>
<span><span class="co">## 2          1    2      2    1 1.5000000  0.5000000</span></span>
<span><span class="co">## 3          1    2      3    2 3.0000000  1.0000000</span></span>
<span><span class="co">## 4          1    2      4    3        NA         NA</span></span>
<span><span class="co">## 5          1    3      1    0 0.0000000  0.0000000</span></span>
<span><span class="co">## 6          1    3      2    1 2.0000000  1.0000000</span></span>
<span><span class="co">## 7          1    3      3    2        NA         NA</span></span>
<span><span class="co">## 8          1    3      4    3        NA         NA</span></span>
<span><span class="co">## 9          2    1      1    0 0.0000000  0.0000000</span></span>
<span><span class="co">## 10         2    1      2    1 0.6666667 -0.3333333</span></span>
<span><span class="co">## 11         2    1      3    2 1.3333333 -0.6666667</span></span>
<span><span class="co">## 12         2    1      4    3 2.0000000 -1.0000000</span></span>
<span><span class="co">## 13         2    3      1    0 0.0000000  0.0000000</span></span>
<span><span class="co">## 14         2    3      2    1 1.3333333  0.3333333</span></span>
<span><span class="co">## 15         2    3      3    2 2.6666667  0.6666667</span></span>
<span><span class="co">## 16         2    3      4    3        NA         NA</span></span>
<span><span class="co">## 17         3    1      1    0 0.0000000  0.0000000</span></span>
<span><span class="co">## 18         3    1      2    1 0.5000000 -0.5000000</span></span>
<span><span class="co">## 19         3    1      3    2 1.0000000 -1.0000000</span></span>
<span><span class="co">## 20         3    1      4    3 1.5000000 -1.5000000</span></span>
<span><span class="co">## 21         3    2      1    0 0.0000000  0.0000000</span></span>
<span><span class="co">## 22         3    2      2    1 0.7500000 -0.2500000</span></span>
<span><span class="co">## 23         3    2      3    2 1.5000000 -0.5000000</span></span>
<span><span class="co">## 24         3    2      4    3 2.2500000 -0.7500000</span></span></code></pre>
<p>Since the trajectories differ in length, this is captured by all
three metrics:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        1      2</span></span>
<span><span class="co">## 2 0.1875       </span></span>
<span><span class="co">## 3 0.5000 0.1875</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.7500000          </span></span>
<span><span class="co">## 3 1.3333333 0.9166667</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      1    2</span></span>
<span><span class="co">## 2 0.75     </span></span>
<span><span class="co">## 3 1.50 0.75</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="curved-trajectories">3. Curved trajectories<a class="anchor" aria-label="anchor" href="#curved-trajectories"></a>
</h2>
<p>In this second set of examples we examine the behavior of the metrics
when comparing trajectories that are not always linear.</p>
<div class="section level3">
<h3 id="constant-speed">3.1 Constant speed<a class="anchor" aria-label="anchor" href="#constant-speed"></a>
</h3>
<p>Here the three trajectories have the same length and speed, but
trajectory 2 and 3 are progressively curved:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.0</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in cmdscale(d, eig = TRUE, add = TRUE, k = nrow(as.matrix(d)) - : only</span></span>
<span><span class="co">## 10 of the first 11 eigenvalues are &gt; 0</span></span></code></pre>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-34-1.png" width="480" style="display: block; margin: auto;"></p>
<p>As expected, no differences are found in terms of lengths or
speeds:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    3</span></span>
<span><span class="co">## 2  1  1  1    3</span></span>
<span><span class="co">## 3  1  1  1    3</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    1</span></span>
<span><span class="co">## 2  1  1  1    1</span></span>
<span><span class="co">## 3  1  1  1    1</span></span></code></pre>
<p>The three distance metrics are responsive to differences of
trajectory shape:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.5743683          </span></span>
<span><span class="co">## 3 0.6250000 0.4267767</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.7658244          </span></span>
<span><span class="co">## 3 0.9023689 0.6868867</span></span></code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.7267030          </span></span>
<span><span class="co">## 3 1.1441228 0.6532815</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="different-speed">3.2 Different speed<a class="anchor" aria-label="anchor" href="#different-speed"></a>
</h3>
<p>This example is similar to the previous one, but here we changed the
survey times, so that the observed trajectory shapes correspond also to
different speeds:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1.5</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.0</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, sites <span class="op">=</span> <span class="va">sites</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<p>The trajectory plot looks as before, except for the time labels:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in cmdscale(d, eig = TRUE, add = TRUE, k = nrow(as.matrix(d)) - : only</span></span>
<span><span class="co">## 10 of the first 11 eigenvalues are &gt; 0</span></span></code></pre>
<p><img src="TrajectoryDistanceMetrics_files/figure-html/unnamed-chunk-38-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In this case trajectories differ in speed but not length:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1 S2 S3 Path</span></span>
<span><span class="co">## 1  1  1  1    3</span></span>
<span><span class="co">## 2  1  1  1    3</span></span>
<span><span class="co">## 3  1  1  1    3</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    S1  S2  S3 Path</span></span>
<span><span class="co">## 1 2.0 2.0 2.0  2.0</span></span>
<span><span class="co">## 2 1.0 1.0 1.0  1.0</span></span>
<span><span class="co">## 3 0.5 0.5 0.5  0.5</span></span></code></pre>
<p>The three metrics detect differences in shape, as before.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.5743683          </span></span>
<span><span class="co">## 3 0.6250000 0.4267767</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.7658244          </span></span>
<span><span class="co">## 3 0.9023689 0.6868867</span></span></code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.9748813          </span></span>
<span><span class="co">## 3 1.4872932 0.8433407</span></span></code></pre>
<p>However, note that the values of SPD and DSPD are exactly the same to
those of the previous example, whereas TSPD yields higher distance
values because of the differences in trajectory speed.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">4. References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Besse, P., Guillouet, B., Loubes, J.-M. &amp; François, R.
(2016). Review and perspective for distance based trajectory clustering.
IEEE Trans. Intell. Transp. Syst., 17, 3306–3317.</p></li>
<li><p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ,
Condit R &amp; Hubbell S. (2019). Trajectory analysis in community
ecology. Ecological Monographs 89, e01350.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Djeghri, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
