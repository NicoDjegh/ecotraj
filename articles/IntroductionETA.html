<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to Ecological Trajectory Analysis (ETA) • ecotraj</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Ecological Trajectory Analysis (ETA)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/TransformingTrajectories.html">Transforming trajectories</a></li>
    <li><a class="dropdown-item" href="../articles/TrajectoryDistanceMetrics.html">Distance metrics for trajectory resemblance</a></li>
    <li><a class="dropdown-item" href="../articles/Dissimilarities.html">Dissimilarities in community data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Stable Isotope Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Introduction to Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cyclical Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionCETA.html">Introduction to Cyclical Ecological Trajectory Analysis (CETA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to Ecological Trajectory Analysis (ETA)</h1>
                        <h4 data-toc-skip class="author">Miquel De
Cáceres</h4>
            
            <h4 data-toc-skip class="date">2025-06-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/vignettes/IntroductionETA.Rmd" class="external-link"><code>vignettes/IntroductionETA.Rmd</code></a></small>
      <div class="d-none name"><code>IntroductionETA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="what-is-ecological-trajectory-analysis">1.1 What is Ecological Trajectory Analysis?<a class="anchor" aria-label="anchor" href="#what-is-ecological-trajectory-analysis"></a>
</h3>
<p><em>Ecological Trajectory Analysis</em> (ETA) is a framework to
analyze the dynamics of ecological entities (e.g. individuals,
communities or ecosystems). The key aspect of ETA is that dynamics are
represented using trajectories in a chosen multivariate space (noted
using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>).
These trajectories are then analyzed and compared geometrically.</p>
<p>The ETA framework was presented for community ecology in De Cáceres
et al (2019), and was extended with new metrics and visualisation modes
in Sturbois et al. (2021a). Procedures of trajectory analysis can be
applied to data beyond community data tables. For example, the same
framework was applied to stable isotope data in Sturbois et
al. (2021b).</p>
<p>Since it can be applied to multiple target entities and multivariate
spaces, we now refer to the framework as <em>Ecological Trajectory
Analysis</em> and provide a package <strong>ecotraj</strong> that offers
a set of functions to calculate metrics and produce plots.</p>
</div>
<div class="section level3">
<h3 id="about-this-vignette">1.2 About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h3>
<p>In this vignette you will learn how to conduct ETA using different
package functions. In most of the vignette we describe how to study the
trajectories of three target entities (i.e. sites, individuals,
communities, etc.) that have been surveyed four times each. We use a
small data set where trajectories occur in a space of two dimensions, so
that geometric calculations can be followed more easily. In the last
section a real example is presented.</p>
<p>First of all, we load <code>ecotraj</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/ecotraj/">ecotraj</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Rcpp</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="trajectory-objects">2. Trajectory objects<a class="anchor" aria-label="anchor" href="#trajectory-objects"></a>
</h2>
<div class="section level3">
<h3 id="trajectory-data">2.1 Trajectory data<a class="anchor" aria-label="anchor" href="#trajectory-data"></a>
</h3>
<div class="section level4">
<h4 id="trajectory-data-items">2.1.1 Trajectory data items<a class="anchor" aria-label="anchor" href="#trajectory-data-items"></a>
</h4>
<p>To specify dynamics of a set of target entities, the following data
items need to be distinguished:</p>
<ol style="list-style-type: lower-alpha">
<li>A set of ecological states (i.e. coordinates in space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>)
implicitly described using a <strong>distance matrix</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">D</mi><annotation encoding="application/x-tex">\mathrm{D}</annotation></semantics></math>.</li>
<li>A <em>character vector</em> specifying the <strong>ecological
entity</strong> (i.e. sampling unit, community, ecosystem or individual)
corresponding to each ecological state. Trajectory names are identified
from unique values of entities.</li>
<li>An <em>integer vector</em> specifying the <strong>survey</strong>
(i.e. census) corresponding to the observation of each ecological state.
This vector is important for survey order. If not provided, the order
will be assumed to be incremental for each repetition of entity
value.</li>
<li>A <em>numeric vector</em> specifying the <strong>survey
time</strong> corresponding the observation of each ecological state.
This is needed for some metrics such as trajectory speed.</li>
</ol>
<p>In ETA, target entities do not need to be surveyed synchronously nor
the same number of times.</p>
</div>
<div class="section level4">
<h4 id="example-data-set">2.1.2 Example data set<a class="anchor" aria-label="anchor" href="#example-data-set"></a>
</h4>
<p>Let us first define the vectors that describe the ecological entity
and the survey of each observation:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">entities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>We then define a matrix whose coordinates correspond to the set of
ecological states observed. The number of rows in this matrix has to be
equal to the length of vectors <code>entities</code> and
<code>surveys</code>. For simplicity, we assume here that the ecological
state space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
has two dimensions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1.5</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0.5</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">0.25</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span><span class="fl">1.5</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.25</span>,<span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">xy</span></span></code></pre></div>
<pre><code><span><span class="co">##       [,1] [,2]</span></span>
<span><span class="co">##  [1,] 0.00 0.00</span></span>
<span><span class="co">##  [2,] 0.00 1.00</span></span>
<span><span class="co">##  [3,] 0.00 2.00</span></span>
<span><span class="co">##  [4,] 0.00 3.00</span></span>
<span><span class="co">##  [5,] 0.25 0.00</span></span>
<span><span class="co">##  [6,] 0.25 1.00</span></span>
<span><span class="co">##  [7,] 0.50 1.50</span></span>
<span><span class="co">##  [8,] 1.00 2.00</span></span>
<span><span class="co">##  [9,] 0.50 0.00</span></span>
<span><span class="co">## [10,] 0.50 1.00</span></span>
<span><span class="co">## [11,] 1.00 1.25</span></span>
<span><span class="co">## [12,] 1.50 1.00</span></span></code></pre>
<p>The matrix of Euclidean distances
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
between ecological states in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
is then:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="va">d</span></span></code></pre></div>
<pre><code><span><span class="co">##            1         2         3         4         5         6         7</span></span>
<span><span class="co">## 2  1.0000000                                                            </span></span>
<span><span class="co">## 3  2.0000000 1.0000000                                                  </span></span>
<span><span class="co">## 4  3.0000000 2.0000000 1.0000000                                        </span></span>
<span><span class="co">## 5  0.2500000 1.0307764 2.0155644 3.0103986                              </span></span>
<span><span class="co">## 6  1.0307764 0.2500000 1.0307764 2.0155644 1.0000000                    </span></span>
<span><span class="co">## 7  1.5811388 0.7071068 0.7071068 1.5811388 1.5206906 0.5590170          </span></span>
<span><span class="co">## 8  2.2360680 1.4142136 1.0000000 1.4142136 2.1360009 1.2500000 0.7071068</span></span>
<span><span class="co">## 9  0.5000000 1.1180340 2.0615528 3.0413813 0.2500000 1.0307764 1.5000000</span></span>
<span><span class="co">## 10 1.1180340 0.5000000 1.1180340 2.0615528 1.0307764 0.2500000 0.5000000</span></span>
<span><span class="co">## 11 1.6007811 1.0307764 1.2500000 2.0155644 1.4577380 0.7905694 0.5590170</span></span>
<span><span class="co">## 12 1.8027756 1.5000000 1.8027756 2.5000000 1.6007811 1.2500000 1.1180340</span></span>
<span><span class="co">##            8         9        10        11</span></span>
<span><span class="co">## 2                                         </span></span>
<span><span class="co">## 3                                         </span></span>
<span><span class="co">## 4                                         </span></span>
<span><span class="co">## 5                                         </span></span>
<span><span class="co">## 6                                         </span></span>
<span><span class="co">## 7                                         </span></span>
<span><span class="co">## 8                                         </span></span>
<span><span class="co">## 9  2.0615528                              </span></span>
<span><span class="co">## 10 1.1180340 1.0000000                    </span></span>
<span><span class="co">## 11 0.7500000 1.3462912 0.5590170          </span></span>
<span><span class="co">## 12 1.1180340 1.4142136 1.0000000 0.5590170</span></span></code></pre>
<p>ETA is based on the analysis of information in the distance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">D</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>d</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{D} = [d]</annotation></semantics></math>.
Therefore, it does not require explicit coordinates. This is an
advantage because it allows the analysis to be conducted on arbitrary
metric (or semi-metric) spaces. The choice of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is left to the user and will depend on the problem at hand.</p>
</div>
</div>
<div class="section level3">
<h3 id="defining-trajectories">2.2 Defining trajectories<a class="anchor" aria-label="anchor" href="#defining-trajectories"></a>
</h3>
<p>To perform ETA, we need to combine the distance matrix and the
entity/survey information in a single object using function
<code><a href="../reference/defineTrajectories.html">defineTrajectories()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">entities</span>, <span class="va">surveys</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>surveys</code> may be omitted, and in this case
surveys for each entity are assumed to be ordered. The function returns
an object (a list) of class <code>trajectories</code> that contains all
the information for analysis:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "trajectories" "list"</span></span></code></pre>
<p>This object contains two elements:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "d"        "metadata"</span></span></code></pre>
<p>Element <code>d</code> contains the input distance matrix, whereas
<code>metadata</code> is a data frame including information of
observations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span></span></code></pre></div>
<pre><code><span><span class="co">##    sites surveys times</span></span>
<span><span class="co">## 1      1       1     1</span></span>
<span><span class="co">## 2      1       2     2</span></span>
<span><span class="co">## 3      1       3     3</span></span>
<span><span class="co">## 4      1       4     4</span></span>
<span><span class="co">## 5      2       1     1</span></span>
<span><span class="co">## 6      2       2     2</span></span>
<span><span class="co">## 7      2       3     3</span></span>
<span><span class="co">## 8      2       4     4</span></span>
<span><span class="co">## 9      3       1     1</span></span>
<span><span class="co">## 10     3       2     2</span></span>
<span><span class="co">## 11     3       3     3</span></span>
<span><span class="co">## 12     3       4     4</span></span></code></pre>
<p>Column <code>sites</code> identifies the ecological entities (calling
them <code>sites</code> is an inherited notation from the original
framework of community trajectory analysis). Note that columns
<code>surveys</code> and <code>times</code> have exactly the same
values. This happens because we did not supplied a vector for
<code>times</code> so that surveys are assumed to happen every time step
(of whatever units). Moreover, the <code>surveys</code> vector itself
can be omitted in calls to <code><a href="../reference/defineTrajectories.html">defineTrajectories()</a></code>. If so, the
function will (correctly, in this case) interpret that every repetition
of a given entity corresponds to a new survey:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">entities</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span></span></code></pre></div>
<pre><code><span><span class="co">##    sites surveys times</span></span>
<span><span class="co">## 1      1       1     1</span></span>
<span><span class="co">## 2      1       2     2</span></span>
<span><span class="co">## 3      1       3     3</span></span>
<span><span class="co">## 4      1       4     4</span></span>
<span><span class="co">## 5      2       1     1</span></span>
<span><span class="co">## 6      2       2     2</span></span>
<span><span class="co">## 7      2       3     3</span></span>
<span><span class="co">## 8      2       4     4</span></span>
<span><span class="co">## 9      3       1     1</span></span>
<span><span class="co">## 10     3       2     2</span></span>
<span><span class="co">## 11     3       3     3</span></span>
<span><span class="co">## 12     3       4     4</span></span></code></pre>
<p>Let us assume the following sampling times, in units of years:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">2.2</span>,<span class="fl">3.1</span>,<span class="fl">4.2</span>,<span class="fl">1.0</span>,<span class="fl">1.5</span>,<span class="fl">2.8</span>,<span class="fl">3.9</span>,<span class="fl">1.6</span>,<span class="fl">2.8</span>,<span class="fl">3.9</span>,<span class="fl">4.3</span><span class="op">)</span></span></code></pre></div>
<p>The call to <code><a href="../reference/defineTrajectories.html">defineTrajectories()</a></code> using all the
information would be:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">entities</span>, <span class="va">surveys</span>, <span class="va">times</span><span class="op">)</span></span>
<span><span class="va">xt</span><span class="op">$</span><span class="va">metadata</span></span></code></pre></div>
<pre><code><span><span class="co">##    sites surveys times</span></span>
<span><span class="co">## 1      1       1   1.0</span></span>
<span><span class="co">## 2      1       2   2.2</span></span>
<span><span class="co">## 3      1       3   3.1</span></span>
<span><span class="co">## 4      1       4   4.2</span></span>
<span><span class="co">## 5      2       1   1.0</span></span>
<span><span class="co">## 6      2       2   1.5</span></span>
<span><span class="co">## 7      2       3   2.8</span></span>
<span><span class="co">## 8      2       4   3.9</span></span>
<span><span class="co">## 9      3       1   1.6</span></span>
<span><span class="co">## 10     3       2   2.8</span></span>
<span><span class="co">## 11     3       3   3.9</span></span>
<span><span class="co">## 12     3       4   4.3</span></span></code></pre>
<p>Note that in <code>x</code> all entities have been surveyed in the
exact same times. The resulting trajectories are called
<strong>synchronous</strong>. In contrast, in <code>xt</code> the
entities have been surveyed at different times, so that trajectories are
<strong>non-synchronous</strong>. In the following, we will use
<code>xt</code> whenever this distinction is relevant.</p>
</div>
<div class="section level3">
<h3 id="subsetting-trajectories">2.3 Subsetting trajectories<a class="anchor" aria-label="anchor" href="#subsetting-trajectories"></a>
</h3>
<p>At some point in the ETA, one may desire to focus on particular
trajectories or surveys. Function <code>subsetTrajectory()</code> allows
subsetting objects of class <code>trajectories</code>, For example, we
can decide to work with the trajectories of the second and third
entities (sites):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x23</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>, site_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x23</span></span></code></pre></div>
<pre><code><span><span class="co">## $d</span></span>
<span><span class="co">##           1         2         3         4         5         6         7</span></span>
<span><span class="co">## 2 1.0000000                                                            </span></span>
<span><span class="co">## 3 1.5206906 0.5590170                                                  </span></span>
<span><span class="co">## 4 2.1360009 1.2500000 0.7071068                                        </span></span>
<span><span class="co">## 5 0.2500000 1.0307764 1.5000000 2.0615528                              </span></span>
<span><span class="co">## 6 1.0307764 0.2500000 0.5000000 1.1180340 1.0000000                    </span></span>
<span><span class="co">## 7 1.4577380 0.7905694 0.5590170 0.7500000 1.3462912 0.5590170          </span></span>
<span><span class="co">## 8 1.6007811 1.2500000 1.1180340 1.1180340 1.4142136 1.0000000 0.5590170</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $metadata</span></span>
<span><span class="co">##   sites surveys times</span></span>
<span><span class="co">## 1     2       1     1</span></span>
<span><span class="co">## 2     2       2     2</span></span>
<span><span class="co">## 3     2       3     3</span></span>
<span><span class="co">## 4     2       4     4</span></span>
<span><span class="co">## 5     3       1     1</span></span>
<span><span class="co">## 6     3       2     2</span></span>
<span><span class="co">## 7     3       3     3</span></span>
<span><span class="co">## 8     3       4     4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "trajectories" "list"</span></span></code></pre>
<p>We can decide to focus on the last three surveys:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x23s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>                           site_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span>, </span>
<span>                           survey_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x23s</span></span></code></pre></div>
<pre><code><span><span class="co">## $d</span></span>
<span><span class="co">##           1         2         3         4         5</span></span>
<span><span class="co">## 2 0.5590170                                        </span></span>
<span><span class="co">## 3 1.2500000 0.7071068                              </span></span>
<span><span class="co">## 4 0.2500000 0.5000000 1.1180340                    </span></span>
<span><span class="co">## 5 0.7905694 0.5590170 0.7500000 0.5590170          </span></span>
<span><span class="co">## 6 1.2500000 1.1180340 1.1180340 1.0000000 0.5590170</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $metadata</span></span>
<span><span class="co">##   sites surveys times</span></span>
<span><span class="co">## 1     2       1     2</span></span>
<span><span class="co">## 2     2       2     3</span></span>
<span><span class="co">## 3     2       3     4</span></span>
<span><span class="co">## 4     3       1     2</span></span>
<span><span class="co">## 5     3       2     3</span></span>
<span><span class="co">## 6     3       3     4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "trajectories" "list"</span></span></code></pre>
<p>You will notice that <code>surveys</code> have been renumbered (but
original <code>times</code> are not modified). This illustrates that the
vector <code>surveys</code> is only used to indicate the survey order
within each trajectory.</p>
</div>
<div class="section level3">
<h3 id="displaying-trajectories">2.4 Displaying trajectories<a class="anchor" aria-label="anchor" href="#displaying-trajectories"></a>
</h3>
<p>To begin our analysis of the three trajectories, we display them in
an ordination space, using function <code><a href="../reference/trajectoryPlot.html">trajectoryPCoA()</a></code>. Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
has only two dimensions in this example, the Principal Coordinates
Analysis (PCoA) on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
displays the complete space:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">x</span>, traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               survey.labels <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Entity 1"</span>, <span class="st">"Entity 2"</span>, <span class="st">"Entity 3"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/pcoa-1.png" width="480" style="display: block; margin: auto;"></p>
<p>While trajectory of entity ‘1’ (black arrows) is made of three
segments of the same length and direction, trajectory of entity ‘2’ (red
arrows) has a second and third segments that bend and are shorter than
that of the second segment of entity ‘1’. Trajectory of entity ‘3’
includes a stronger change in direction and shorter segments.</p>
<p>As this example has two dimensions and we used Euclidean distance,
the same plot (albeit rotated) can be straightforwardly obtained using
matrix <code>xy</code> and function <code><a href="../reference/trajectoryPlot.html">trajectoryPlot()</a></code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span>, traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               survey.labels <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Entity 1"</span>, <span class="st">"Entity 2"</span>, <span class="st">"Entity 3"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/xy-1.png" width="480" style="display: block; margin: auto;"></p>
<p>While <code><a href="../reference/trajectoryPlot.html">trajectoryPCoA()</a></code> uses PCoA (also known as
classical Multidimensional Scaling) to display trajectories, users can
display ecosystem trajectories using other ordination techniques such as
metric Multidimensional Scaling (mMDS; see function <em>mds</em> of
package <strong>smacof</strong>) or non-metric MDS (nMDS; see function
<em>metaMDS</em> in package <strong>vegan</strong> or function
<em>isoMDS</em> in package <strong>MASS</strong>). Function
<code><a href="../reference/trajectoryPlot.html">trajectoryPlot()</a></code> will help drawing arrows between segments
to represent trajectories on the ordination space given by any of these
methods.</p>
<p>Functions <code><a href="../reference/trajectoryPlot.html">trajectoryPCoA()</a></code>and
<code><a href="../reference/trajectoryPlot.html">trajectoryPlot()</a></code> can be used to display a subset of
trajectories if we combine them with function
<code><a href="../reference/subsetTrajectories.html">subsetTrajectories()</a></code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x</span>, site_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               survey.labels <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Entity 2"</span>, <span class="st">"Entity 3"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="trajectory-metrics">3. Trajectory metrics<a class="anchor" aria-label="anchor" href="#trajectory-metrics"></a>
</h2>
<p>One may be interested in studying the geometric properties of
particular trajectories. This is illustrated in this section</p>
<div class="section level3">
<h3 id="changes-in-ecological-state">3.1 Changes in ecological state<a class="anchor" aria-label="anchor" href="#changes-in-ecological-state"></a>
</h3>
<p>Several metrics are related to the magnitude of temporal changes in
state. For example, one can obtain the length of trajectory segments and
the total path length using function
<code><a href="../reference/trajectoryMetrics.html">trajectoryLengths()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1       S2        S3     Path</span></span>
<span><span class="co">## 1  1 1.000000 1.0000000 3.000000</span></span>
<span><span class="co">## 2  1 0.559017 0.7071068 2.266124</span></span>
<span><span class="co">## 3  1 0.559017 0.5590170 2.118034</span></span></code></pre>
<p>Since the difference between <code>x</code> and <code>xt</code> is in
observation times, we will obtain the same result when calculating
lengths on <code>xt</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1       S2        S3     Path</span></span>
<span><span class="co">## 1  1 1.000000 1.0000000 3.000000</span></span>
<span><span class="co">## 2  1 0.559017 0.7071068 2.266124</span></span>
<span><span class="co">## 3  1 0.559017 0.5590170 2.118034</span></span></code></pre>
<p>When observation times are available, it may be of interest to
calculate segment or trajectory speeds. One can obtain the speed of
trajectory segments and the total path speed using function
<code><a href="../reference/trajectoryMetrics.html">trajectorySpeeds()</a></code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   S1       S2        S3      Path</span></span>
<span><span class="co">## 1  1 1.000000 1.0000000 1.0000000</span></span>
<span><span class="co">## 2  1 0.559017 0.7071068 0.7553746</span></span>
<span><span class="co">## 3  1 0.559017 0.5590170 0.7060113</span></span></code></pre>
<p>Note that the units of lengths and speeds will depend on the
definition of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
space and, in the latter case, on the units of <code>times</code>.
Trajectory speeds are affected by observation times and, since in
<code>x</code> times are consecutive integers, segment speeds are equal
to segment lengths (but not the average trajectory speed). We will
obtain a different result for speeds with <code>xt</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          S1        S2        S3     Path</span></span>
<span><span class="co">## 1 0.8333333 1.1111111 0.9090909 0.937500</span></span>
<span><span class="co">## 2 2.0000000 0.4300131 0.6428243 0.781422</span></span>
<span><span class="co">## 3 0.8333333 0.5081973 1.3975425 0.784457</span></span></code></pre>
<p>Finally, one may calculate the internal variation of states within
each trajectory using <code><a href="../reference/trajectoryMetrics.html">trajectoryInternalVariation()</a></code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryInternalVariation</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        ss_1      ss_2      ss_3      ss_4 internal_ss internal_variance</span></span>
<span><span class="co">## 1 2.2500000 0.2500000 0.2500000 2.2500000    5.000000         1.6666667</span></span>
<span><span class="co">## 2 1.3281250 0.0781250 0.1406250 1.0156250    2.562500         0.8541667</span></span>
<span><span class="co">## 3 0.8007812 0.1757812 0.2070312 0.4257813    1.609375         0.5364583</span></span></code></pre>
<p>The function returns the (absolute or relative) contribution of each
observation to the internal variation, the total sum of squares and an
unbiased estimation of internal variance. Note that in this example the
third (more curved) trajectory has lower internal variation, compared to
the first and second (straighter) ones.</p>
</div>
<div class="section level3">
<h3 id="changes-in-direction">3.2 Changes in direction<a class="anchor" aria-label="anchor" href="#changes-in-direction"></a>
</h3>
<p>In CTA, angles are measured using triplets of time-ordered ecological
states (a pair of consecutive segments is an example of such triplets).
As matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">D</mi><annotation encoding="application/x-tex">\mathrm{D}</annotation></semantics></math>
may represent a space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
of multiple dimensions, angles cannot be calculated with respect to a
single plane. Instead, each angle is measured on the plane defined by
each triplet. Zero angles indicate that the three points (e.g. the two
consecutive segments) are in a straight line. The larger the angle
value, the more is trajectory changing in direction. Mean and standard
deviation statistics of angles are calculated according to circular
statistics. Function <code><a href="../reference/trajectoryMetrics.html">trajectoryAngles()</a></code> allows calculating
the angles between consecutive segments:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryAngles</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      S1-S2    S2-S3     mean         sd       rho</span></span>
<span><span class="co">## 1  0.00000  0.00000  0.00000 0.00000000 1.0000000</span></span>
<span><span class="co">## 2 26.56505 18.43495 22.50000 0.07097832 0.9974842</span></span>
<span><span class="co">## 3 63.43495 53.13010 58.28253 0.08998746 0.9959593</span></span></code></pre>
<p>While entity ‘1’ follows a straight path, angles are &gt; 0 for
trajectories of entity ‘2’ and ‘3’, denoting the change in direction. In
this case, the same information could be obtained by inspecting the
previous plots, but in a case where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
has many dimensions, the representation will correspond to a reduced
(ordination) space and hence, angles and lengths in the plot will not
correspond exactly to those of functions
<code><a href="../reference/trajectoryMetrics.html">trajectoryLengths()</a></code> and <code><a href="../reference/trajectoryMetrics.html">trajectoryAngles()</a></code>,
which take into account the complete
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
space.</p>
<p>Angles can be calculated not only for all consecutive segments but
for all four triplets of ordered ecological states, whether of
consecutive segments or not (i.e., between points 1-2-3, 1-2-4, 1-3-4
and 2-3-4). This is done by specifying <code>all=TRUE</code> in
<code><a href="../reference/trajectoryMetrics.html">trajectoryAngles()</a></code>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryAngles</a></span><span class="op">(</span><span class="va">x</span>, all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         A1      A2       A3       A4     mean        sd       rho</span></span>
<span><span class="co">## 1  0.00000  0.0000  0.00000  0.00000  0.00000 0.0000000 1.0000000</span></span>
<span><span class="co">## 2 26.56505 36.8699 35.53768 18.43495 29.36033 0.1300790 0.9915754</span></span>
<span><span class="co">## 3 63.43495 90.0000 94.76364 53.13010 75.36015 0.3078934 0.9537066</span></span></code></pre>
<p>The <em>mean resultant length</em> of circular statistics (column
<code>rho</code> of the previous result), which takes values between 0
and 1, can be used to assess the degree of homogeneity of angle values
and it will take a value of 1 if all angles are the same. This approach,
however, uses only angular information and does not take into account
the length of segments.</p>
<p>To measure the overall directionality of an ecosystem trajectory
(i.e. if the path consistently follows the same direction in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
), we recommend using another statistic that is sensitive to both angles
and segment lengths and is implemented in function
<code><a href="../reference/trajectoryMetrics.html">trajectoryDirectionality()</a></code>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryDirectionality</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         1         2         3 </span></span>
<span><span class="co">## 1.0000000 0.8274026 0.5620859</span></span></code></pre>
<p>As known from previous plots, trajectory of entity ‘2’ is less
straight than trajectory of entity ‘1’ and that of entity ‘3’ has the
lowest directionality value. By default the function only computes a
descriptive statistic, i.e. it does not perform any statistical test on
directionality. A permutational test can be performed, but this feature
is experimental and needs to be tested before recommendation.</p>
</div>
<div class="section level3">
<h3 id="assessing-multiple-metrics-at-once">3.2 Assessing multiple metrics at once<a class="anchor" aria-label="anchor" href="#assessing-multiple-metrics-at-once"></a>
</h3>
<p>It is possible to assess multiple trajectory metrics in one function
call to <code><a href="../reference/trajectoryMetrics.html">trajectoryMetrics()</a></code>. This will only provide metrics
that apply to the whole trajectory path:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryMetrics</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   trajectory n t_start t_end duration   length mean_speed mean_angle</span></span>
<span><span class="co">## 1          1 4       1     4        3 3.000000  1.0000000    0.00000</span></span>
<span><span class="co">## 2          2 4       1     4        3 2.266124  0.7553746   22.50000</span></span>
<span><span class="co">## 3          3 4       1     4        3 2.118034  0.7060113   58.28253</span></span>
<span><span class="co">##   directionality internal_ss internal_variance</span></span>
<span><span class="co">## 1      1.0000000    5.000000         1.6666667</span></span>
<span><span class="co">## 2      0.8274026    2.562500         0.8541667</span></span>
<span><span class="co">## 3      0.5620859    1.609375         0.5364583</span></span></code></pre>
<p>If we calculate metrics on <code>xt</code> we will confirm that only
trajectory speeds are affected by observation times:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryMetrics</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   trajectory n t_start t_end duration   length mean_speed mean_angle</span></span>
<span><span class="co">## 1          1 4     1.0   4.2      3.2 3.000000   0.937500    0.00000</span></span>
<span><span class="co">## 2          2 4     1.0   3.9      2.9 2.266124   0.781422   22.50000</span></span>
<span><span class="co">## 3          3 4     1.6   4.3      2.7 2.118034   0.784457   58.28253</span></span>
<span><span class="co">##   directionality internal_ss internal_variance</span></span>
<span><span class="co">## 1      1.0000000    5.000000         1.6666667</span></span>
<span><span class="co">## 2      0.8274026    2.562500         0.8541667</span></span>
<span><span class="co">## 3      0.5620859    1.609375         0.5364583</span></span></code></pre>
<p>Another function, called <code><a href="../reference/trajectoryMetrics.html">trajectoryWindowMetrics()</a></code>
calculates trajectory metrics on moving windows over trajectories, but
will not be illustrated here.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-trajectories">4. Comparing trajectories<a class="anchor" aria-label="anchor" href="#comparing-trajectories"></a>
</h2>
<div class="section level3">
<h3 id="relative-positions-within-trajectories">4.1 Relative positions within trajectories<a class="anchor" aria-label="anchor" href="#relative-positions-within-trajectories"></a>
</h3>
<p>Ecological states occupy a position within their trajectory that
depends on the total path length of the trajectory (see Fig. 2 of De
Cáceres et al. 2019). By adding the length of segments prior to a given
state and dividing the sum by the total length of the trajectory we
obtain the relative position of the ecological state. Function
<code><a href="../reference/trajectoryProjection.html">trajectoryProjection()</a></code> allows obtaining the relative
position of each ecological state of a trajectory. To use it for this
purpose one should use as parameters the distance matrix between states
and the indices that conform the trajectory, which have to be entered
twice. For example for the two example trajectories we would have:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryProjection.html">trajectoryProjection</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   distanceToTrajectory segment relativeSegmentPosition</span></span>
<span><span class="co">## 1                    0       1                       0</span></span>
<span><span class="co">## 2                    0       1                       1</span></span>
<span><span class="co">## 3                    0       2                       1</span></span>
<span><span class="co">## 4                    0       3                       1</span></span>
<span><span class="co">##   relativeTrajectoryPosition</span></span>
<span><span class="co">## 1                  0.0000000</span></span>
<span><span class="co">## 2                  0.3333333</span></span>
<span><span class="co">## 3                  0.6666667</span></span>
<span><span class="co">## 4                  1.0000000</span></span></code></pre>
<p>If we inspect the relative positions of the points in the trajectory
of entity ‘2’, we find than the second and third segments have relative
positions larger than 1/3 and 2/3, respectively, because the second and
third segments are shorter:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryProjection.html">trajectoryProjection</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   distanceToTrajectory segment relativeSegmentPosition</span></span>
<span><span class="co">## 5                    0       1                       0</span></span>
<span><span class="co">## 6                    0       1                       1</span></span>
<span><span class="co">## 7                    0       2                       1</span></span>
<span><span class="co">## 8                    0       3                       1</span></span>
<span><span class="co">##   relativeTrajectoryPosition</span></span>
<span><span class="co">## 5                  0.0000000</span></span>
<span><span class="co">## 6                  0.4412822</span></span>
<span><span class="co">## 7                  0.6879664</span></span>
<span><span class="co">## 8                  1.0000000</span></span></code></pre>
<p>Function <code><a href="../reference/trajectoryProjection.html">trajectoryProjection()</a></code> can also be used to
perform an <strong>orthogonal projection</strong> of arbitrary
ecological states onto a given reference trajectory. For example we can
study the projection of third state of the trajectory of entity ‘2’
(i.e. state 7) onto the trajectory of entity ‘1’ (i.e. states 1 to 4),
which happens to be in the half of the trajectory:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryProjection.html">trajectoryProjection</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   distanceToTrajectory segment relativeSegmentPosition</span></span>
<span><span class="co">## 7                  0.5       2                     0.5</span></span>
<span><span class="co">##   relativeTrajectoryPosition</span></span>
<span><span class="co">## 7                        0.5</span></span></code></pre>
<p>If we project the points of the trajectory of entity ‘3’ onto the
trajectory of entity ‘1’ we see how the curved path of entity ‘3’
projects its fourth point to the same relative position as its second
point.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryProjection.html">trajectoryProjection</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    distanceToTrajectory segment relativeSegmentPosition</span></span>
<span><span class="co">## 9                   0.5       1                    0.00</span></span>
<span><span class="co">## 10                  0.5       2                    0.00</span></span>
<span><span class="co">## 11                  1.0       2                    0.25</span></span>
<span><span class="co">## 12                  1.5       1                    1.00</span></span>
<span><span class="co">##    relativeTrajectoryPosition</span></span>
<span><span class="co">## 9                   0.0000000</span></span>
<span><span class="co">## 10                  0.3333333</span></span>
<span><span class="co">## 11                  0.4166667</span></span>
<span><span class="co">## 12                  0.3333333</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="trajectory-shifts">4.2 Trajectory shifts<a class="anchor" aria-label="anchor" href="#trajectory-shifts"></a>
</h3>
<p>Sometimes different entities follow the same or similar trajectory
but with different speeds, or with an observations starting at a
different point in the dynamic sequence. We can quantify those
differences using function <code><a href="../reference/trajectoryComparison.html">trajectoryShifts()</a></code>, which
internally uses orthogonal projection. To illustrate this function, we
will first build a small data set of three linear trajectories, but
where the second and the third are modified:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Description of entities and times</span></span>
<span><span class="va">entities3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span>
<span><span class="va">times3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co">#Raw data table</span></span>
<span><span class="va">xy3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy3</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="co"># States are all shifted with respect to entity "1"</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">xy3</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy3</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">1.25</span>  <span class="co"># 1.25 times faster than entity "1"</span></span></code></pre></div>
<p>We can see the differences graphically:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy3</span>, <span class="va">entities3</span>,  </span>
<span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trajectory 1"</span>, <span class="st">"Trajectory 2"</span>, <span class="st">"Trajectory 3"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/unnamed-chunk-29-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We now build the usual <code>trajectories</code> object:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy3</span><span class="op">)</span>, <span class="va">entities3</span>, times <span class="op">=</span> <span class="va">times3</span><span class="op">)</span></span></code></pre></div>
<p>We can check that indeed the third trajectory is faster using:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     S1   S2   S3 Path</span></span>
<span><span class="co">## 1 1.00 1.00 1.00 1.00</span></span>
<span><span class="co">## 2 1.00 1.00 1.00 1.00</span></span>
<span><span class="co">## 3 1.25 1.25 1.25 1.25</span></span></code></pre>
<p>Function <code><a href="../reference/trajectoryComparison.html">trajectoryShifts()</a></code> allows comparing different
observations to a reference trajectory. For example we can compare
trajectory for entities “1” and “2”:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   reference site survey time timeRef shift</span></span>
<span><span class="co">## 1         1    2      1    1     1.5   0.5</span></span>
<span><span class="co">## 2         1    2      2    2     2.5   0.5</span></span>
<span><span class="co">## 3         1    2      3    3     3.5   0.5</span></span>
<span><span class="co">## 4         1    2      4    4      NA    NA</span></span>
<span><span class="co">## 5         2    1      1    1      NA    NA</span></span>
<span><span class="co">## 6         2    1      2    2     1.5  -0.5</span></span>
<span><span class="co">## 7         2    1      3    3     2.5  -0.5</span></span>
<span><span class="co">## 8         2    1      4    4     3.5  -0.5</span></span></code></pre>
<p>Where we see that the observations of trajectory “2” correspond to
states of trajectory “1” at 0.5 time units later in time. Surveys with
missing values indicate that the projection of the target state cannot
be determined (because the reference trajectory is too short).</p>
<p>We can also compare trajectories “1” and “3”:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryShifts</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">x3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"3"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   reference site survey time timeRef shift</span></span>
<span><span class="co">## 1         1    3      1    1    1.00  0.00</span></span>
<span><span class="co">## 2         1    3      2    2    2.25  0.25</span></span>
<span><span class="co">## 3         1    3      3    3    3.50  0.50</span></span>
<span><span class="co">## 4         1    3      4    4      NA    NA</span></span>
<span><span class="co">## 5         3    1      1    1    1.00  0.00</span></span>
<span><span class="co">## 6         3    1      2    2    1.80 -0.20</span></span>
<span><span class="co">## 7         3    1      3    3    2.60 -0.40</span></span>
<span><span class="co">## 8         3    1      4    4    3.40 -0.60</span></span></code></pre>
<p>Here we see that shifts increase progressively, indicating the faster
speed of trajectory “3”.</p>
</div>
<div class="section level3">
<h3 id="trajectory-convergencedivergence">4.3 Trajectory convergence/divergence<a class="anchor" aria-label="anchor" href="#trajectory-convergencedivergence"></a>
</h3>
<p>When trajectories are synchronous, one can study their symmetric
convergence or divergence (see Fig. 3a of De Cáceres et al. 2019).
Function <code><a href="../reference/trajectoryComparison.html">trajectoryConvergence()</a></code> allows performing tests of
convergence based on the trend analysis of the sequences of distances
between points of the two trajectories (i.e. first-first, second-second,
…):</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryConvergence</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"pairwise.symmetric"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tau</span></span>
<span><span class="co">##           1         2         3</span></span>
<span><span class="co">## 1        NA 0.9128709 0.9128709</span></span>
<span><span class="co">## 2 0.9128709        NA 0.9128709</span></span>
<span><span class="co">## 3 0.9128709 0.9128709        NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p.value</span></span>
<span><span class="co">##           1         2         3</span></span>
<span><span class="co">## 1        NA 0.1485617 0.1485617</span></span>
<span><span class="co">## 2 0.1485617        NA 0.1485617</span></span>
<span><span class="co">## 3 0.1485617 0.1485617        NA</span></span></code></pre>
<p>The function performs the Mann-Whitney trend test. Values of the
statistic (‘tau’) larger than 0 correspond to trajectories that are
diverging, whereas values lower than 0 correspond to trajectories that
are converging. By setting <code>type = "pairwise.asymmetric"</code> the
convergence test becomes asymmetric (see Figs. 3b and 3c of De Cáceres
et al. 2019). In this case the sequence of distances <em>between every
point of one trajectory and the other</em>:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryConvergence</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"pairwise.asymmetric"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tau</span></span>
<span><span class="co">##           1         2         3</span></span>
<span><span class="co">## 1        NA 0.9128709 0.9128709</span></span>
<span><span class="co">## 2 0.9128709        NA 0.9128709</span></span>
<span><span class="co">## 3 0.9128709 0.9128709        NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p.value</span></span>
<span><span class="co">##           1         2         3</span></span>
<span><span class="co">## 1        NA 0.1485617 0.1485617</span></span>
<span><span class="co">## 2 0.1485617        NA 0.1485617</span></span>
<span><span class="co">## 3 0.1485617 0.1485617        NA</span></span></code></pre>
<p>The asymmetric test is useful to determine if one trajectory is
becoming closer to the other or if it is departing from the other. The
asymmetric test can be applied on non-synchronous trajectories. Finally,
if the trajectories have been surveyed synchronously, one can also
perform a global test of convergence/divergence between trajectories,
using <code>type = "multiple"</code>:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryConvergence</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"multiple"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tau</span></span>
<span><span class="co">## [1] 0.9128709</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p.value</span></span>
<span><span class="co">## [1] 0.1485617</span></span></code></pre>
<p>In this case we are testing whether the average distance between
ecological states corresponding to the same observation time is
increasing or decreasing with time. In all these tests trajectories are
diverging (as indicated by the positive tau values) but the tests are
not statistically significance due to the small number of surveys.</p>
</div>
<div class="section level3">
<h3 id="distances-between-segments-and-between-trajectories">4.4 Distances between segments and between trajectories<a class="anchor" aria-label="anchor" href="#distances-between-segments-and-between-trajectories"></a>
</h3>
<p>The ETA framework allows quantifying the resemblance in the dynamics
of target entities by assessing the dissimilarity of their corresponding
trajectories. Broadly speaking, dissimilarity between trajectories will
be influenced both by differences in ecological states that are constant
in time and differences that arise from temporal changes. To focus on
the second, distances between trajectories can be calculated after
centering them (i.e. after bringing all trajectories to the center of
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
space). This is done using function <code><a href="../reference/transformTrajectories.html">centerTrajectories()</a></code>,
which returns a new dissimilarity matrix and is illustrated in article
“Transforming trajectories”.</p>
<div class="section level4">
<h4 id="distances-between-segments">4.4.1 Distances between segments<a class="anchor" aria-label="anchor" href="#distances-between-segments"></a>
</h4>
<p>For some trajectory dissimilarity coefficients, one intermediate step
is the calculation of distances between directed segments (see Fig. 4 of
De Cáceres et al. 2019), which can be obtained by calling function
<code>segmentDistances</code>:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trajectoryComparison.html">segmentDistances</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">Dseg</span></span>
<span><span class="va">Ds</span></span></code></pre></div>
<pre><code><span><span class="co">##           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span></span>
<span><span class="co">## 1[2-3] 1.0000000                                                            </span></span>
<span><span class="co">## 1[3-4] 2.0000000 1.0000000                                                  </span></span>
<span><span class="co">## 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span></span>
<span><span class="co">## 2[2-3] 1.0307764 0.7071068 1.5811388 1.0000000                              </span></span>
<span><span class="co">## 2[3-4] 1.5811388 1.0000000 1.4142136 1.5206906 0.7071068                    </span></span>
<span><span class="co">## 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 1.0307764 1.5000000          </span></span>
<span><span class="co">## 3[2-3] 1.1180340 1.1180340 2.0124612 1.0307764 0.5590170 0.7500000 1.0000000</span></span>
<span><span class="co">## 3[3-4] 1.6007811 1.5590170 2.0155644 1.4577380 1.1180340 1.0606602 1.5590170</span></span>
<span><span class="co">##           3[2-3]</span></span>
<span><span class="co">## 1[2-3]          </span></span>
<span><span class="co">## 1[3-4]          </span></span>
<span><span class="co">## 2[1-2]          </span></span>
<span><span class="co">## 2[2-3]          </span></span>
<span><span class="co">## 2[3-4]          </span></span>
<span><span class="co">## 3[1-2]          </span></span>
<span><span class="co">## 3[2-3]          </span></span>
<span><span class="co">## 3[3-4] 0.5590170</span></span></code></pre>
<p>Distances between segments are affected by differences in both
<em>position</em>, <em>size</em> and <em>direction</em>. Hence, among
the six segments of this example, the distance is maximum between the
last segment of trajectory ‘1’ (named <code>1[3-4]</code>) and the first
segment of trajectory ‘3’ (named <code>3[1-2]</code>).</p>
<p>One can display distances between segments in two dimensions using
mMDS.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mMDS</span> <span class="op">&lt;-</span> <span class="fu">smacof</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/smacof/man/smacofSym.html" class="external-link">mds</a></span><span class="op">(</span><span class="va">Ds</span><span class="op">)</span></span>
<span><span class="va">mMDS</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## smacof::mds(delta = Ds)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: Symmetric SMACOF </span></span>
<span><span class="co">## Number of objects: 9 </span></span>
<span><span class="co">## Stress-1 value: 0.062 </span></span>
<span><span class="co">## Number of iterations: 15</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xret</span> <span class="op">&lt;-</span> <span class="va">mMDS</span><span class="op">$</span><span class="va">conf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xret</span>, xlab<span class="op">=</span><span class="st">"axis 1"</span>, ylab <span class="op">=</span> <span class="st">"axis 2"</span>, asp<span class="op">=</span><span class="fl">1</span>, pch<span class="op">=</span><span class="fl">21</span>,</span>
<span>     bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">xret</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"s"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, pt.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">21</span>, bty<span class="op">=</span><span class="st">"n"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trajectory 1"</span>, <span class="st">"Trajectory 2"</span>, <span class="st">"Trajectory 3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/unnamed-chunk-38-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="distances-between-trajectories">4.4.2 Distances between trajectories<a class="anchor" aria-label="anchor" href="#distances-between-trajectories"></a>
</h4>
<p>Distances between segments are internally calculated when comparing
whole trajectories using function <code><a href="../reference/trajectoryComparison.html">trajectoryDistances()</a></code>.
Here we show the dissimilarity between the two trajectories as assessed
using either the <em>Hausdorff</em> distance (equal to the maximum
distance between directed segments; see eq. 8 in De Cáceres et
al. 2019), the <em>segment path distance</em> (Besse et al, 2016), the
<em>directed segment path distance</em> (see eq. 13 in De Cáceres et
al. 2019) or the <em>time-sensitive path distance</em>
(unpublished):</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"Hausdorff"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          1        2</span></span>
<span><span class="co">## 2 2.015564         </span></span>
<span><span class="co">## 3 2.061553 1.500000</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"SPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.5776650          </span></span>
<span><span class="co">## 3 0.9538119 0.4702263</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.7214045          </span></span>
<span><span class="co">## 3 1.1345910 0.5714490</span></span></code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2</span></span>
<span><span class="co">## 2 0.6553301          </span></span>
<span><span class="co">## 3 1.1875000 0.5442627</span></span></code></pre>
<p>SPD, DSPD and TSPD are symmetrized by default. To calculate
non-symmetric distances one uses, for example (see eq. 11 in De Cáceres
et al. 2019):</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span>, symmetrization <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1         2         3</span></span>
<span><span class="co">## 1 0.0000000 0.7904401 1.2101651</span></span>
<span><span class="co">## 2 0.6523689 0.0000000 0.5196723</span></span>
<span><span class="co">## 3 1.0590170 0.6232257 0.0000000</span></span></code></pre>
<p>A detailed comparison of trajectory dissimilarity indices can be
found in article “Distance metrics for trajectory resemblance”.</p>
<p>When estimating dissimilarities between a set of trajectories one is
building a new space (noted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ω</mi><mi>T</mi></msub><annotation encoding="application/x-tex">\Omega_T</annotation></semantics></math>).
One can display the location of trajectories in two dimensions using
mMDS.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mMDS</span> <span class="op">&lt;-</span> <span class="fu">smacof</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/smacof/man/smacofSym.html" class="external-link">mds</a></span><span class="op">(</span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mMDS</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## smacof::mds(delta = trajectoryDistances(x, distance.type = "TSPD"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: Symmetric SMACOF </span></span>
<span><span class="co">## Number of objects: 3 </span></span>
<span><span class="co">## Stress-1 value: 0 </span></span>
<span><span class="co">## Number of iterations: 1</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xret</span> <span class="op">&lt;-</span> <span class="va">mMDS</span><span class="op">$</span><span class="va">conf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xret</span>, xlab<span class="op">=</span><span class="st">"axis 1"</span>, ylab <span class="op">=</span> <span class="st">"axis 2"</span>, asp<span class="op">=</span><span class="fl">1</span>, pch<span class="op">=</span><span class="fl">21</span>,</span>
<span>     bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.0</span>,<span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, pt.bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">21</span>, bty<span class="op">=</span><span class="st">"n"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trajectory 1"</span>, <span class="st">"Trajectory 2"</span>, <span class="st">"Trajectory 3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/unnamed-chunk-41-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="dynamic-variation">4.5 Dynamic variation<a class="anchor" aria-label="anchor" href="#dynamic-variation"></a>
</h3>
<p>One may be interested in knowing how much diverse are a set of
trajectories, and which entities follow dynamics more distinct from
others. We refer to the diversity of trajectories as <strong>dynamic
variation</strong>., and these questions can be addressed using function
<code><a href="../reference/dynamicVariation.html">dynamicVariation()</a></code>, for example:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dynamicVariation.html">dynamicVariation</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $dynamic_ss</span></span>
<span><span class="co">## [1] 0.7114251</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dynamic_variance</span></span>
<span><span class="co">## [1] 0.3557125</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $relative_contributions</span></span>
<span><span class="co">##          1          2          3 </span></span>
<span><span class="co">## 0.51366204 0.06351261 0.42282535</span></span></code></pre>
<p>Analogously to <code><a href="../reference/trajectoryMetrics.html">trajectoryInternalVariation()</a></code>, function
<code><a href="../reference/dynamicVariation.html">dynamicVariation()</a></code> returns the sum of squares of dynamic
variation, an unbiased dynamic variance estimator and the relative
contribution of individual trajectories to the overall sum of squares.
Function <code><a href="../reference/dynamicVariation.html">dynamicVariation()</a></code>, makes internal calls to
<code><a href="../reference/trajectoryComparison.html">trajectoryDistances()</a></code>, which means that we may get slightly
different results if we change the trajectory dissimilarity
coefficient:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dynamicVariation.html">dynamicVariation</a></span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"TSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $dynamic_ss</span></span>
<span><span class="co">## [1] 0.7119452</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dynamic_variance</span></span>
<span><span class="co">## [1] 0.3559726</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $relative_contributions</span></span>
<span><span class="co">##           1           2           3 </span></span>
<span><span class="co">## 0.527975317 0.006430374 0.465594309</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="real-example-structural-dynamics-in-permanent-plots">5. Real example: structural dynamics in permanent plots<a class="anchor" aria-label="anchor" href="#real-example-structural-dynamics-in-permanent-plots"></a>
</h2>
<p>In this example we analyze the dynamics of 8 permanent forest plots
located on slopes of a valley in the New Zealand Alps. The study area is
mountainous and centered on the Craigieburn Range (Southern Alps), South
Island, New Zealand (see map in Fig. 8 of De Cáceres et al. 2019).
Forests plots are almost monospecific, being the mountain beech
(<em>Fuscospora cliffortioides</em>) the main dominant tree species.
Previously forests consisted of largely mature stands, but some of them
were affected by different disturbances during the sampling period
(1972-2009) which includes 9 surveys. We begin our example by loading
the data set, which includes 72 plot observations:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"avoca"</span><span class="op">)</span></span></code></pre></div>
<p>Community data is in form of an object
<code>stratifiedvegdata</code>. To account for differences in tree
diameter, while emphasizing regeneration, the data contains individual
counts to represent tree abundance and trees are classified in 19
quadratic diameter bins (in cm): {(2.25, 4], (4, 6.25], (6.25, 9], …
(110.25, 121]}. The data set also includes vectors
<code>avoca_surveys</code> and <code>avoca_sites</code> that indicate
the survey and forest plot corresponding to each forest state.</p>
<p>Before starting ETA, we have to use function
<code>vegdiststruct</code> from package <strong>vegclust</strong> to
calculate distances between forest plot states in terms of structure and
composition (see De Cáceres M, Legendre P, He F (2013) Dissimilarity
measurements and the size structure of ecological communities. Methods
Ecol Evol 4:1167–1177. <a href="https://doi.org/10.1111/2041-210X.12116" class="external-link uri">https://doi.org/10.1111/2041-210X.12116</a>):</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoca_D_man</span> <span class="op">&lt;-</span> <span class="fu">vegclust</span><span class="fu">::</span><span class="fu"><a href="https://emf-creaf.github.io/vegclust/reference/vegdiststruct.html" class="external-link">vegdiststruct</a></span><span class="op">(</span><span class="va">avoca_strat</span>, </span>
<span>                                       method<span class="op">=</span><span class="st">"manhattan"</span>, </span>
<span>                                       transform <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Distances in <code>avoca_D_man</code> are calculated using the
Manhattan metric, after applying a logarithm transformation to abundance
data.</p>
<div class="section level3">
<h3 id="defining-trajectories-1">5.1 Defining trajectories<a class="anchor" aria-label="anchor" href="#defining-trajectories-1"></a>
</h3>
<p>We start by defining our trajectories, which implies combining the
information about distances, entities (sites) and observation times. The
nine surveys were conducted in years 1970/72, 1974, 1978, 1983, 1987,
1993, 1999, 2004 and 2009. Since plots have been surveyed rather
synchronously, we can define observation times using:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1971</span>, <span class="fl">1974</span>, <span class="fl">1978</span>, <span class="fl">1983</span>, <span class="fl">1987</span>, <span class="fl">1993</span>, <span class="fl">1999</span>, <span class="fl">2004</span>, <span class="fl">2009</span><span class="op">)</span></span>
<span><span class="va">avoca_times</span> <span class="op">&lt;-</span> <span class="va">years</span><span class="op">[</span><span class="va">avoca_surveys</span><span class="op">]</span></span></code></pre></div>
<p>And then define trajectories using:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoca_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">avoca_D_man</span>,  </span>
<span>                              sites <span class="op">=</span> <span class="va">avoca_sites</span>, </span>
<span>                              times <span class="op">=</span> <span class="va">avoca_times</span><span class="op">)</span></span></code></pre></div>
<p>In this dataset trajectories , as indicated by function
<code><a href="../reference/is.synchronous.html">is.synchronous()</a></code>.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.synchronous.html">is.synchronous</a></span><span class="op">(</span><span class="va">avoca_x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>On the other hand, the Manhattan metric produces a distance matrix
(and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
space) that is indeed metric:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.metric.html">is.metric</a></span><span class="op">(</span><span class="va">avoca_x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="displaying-trajectories-in-pcoa">5.2 Displaying trajectories in PCoA<a class="anchor" aria-label="anchor" href="#displaying-trajectories-in-pcoa"></a>
</h3>
<p>The distance matrix <code>avoca_D_man</code> conforms our definition
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>.
We use <code><a href="../reference/trajectoryPlot.html">trajectoryPCoA()</a></code> to display the relations between
forest plot states in this space and to draw the trajectory of each
plot:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="va">avoca_x</span>,</span>
<span>               traj.colors <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span>, </span>
<span>               axes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, bty<span class="op">=</span><span class="st">"n"</span>, legend <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, col <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/avoca_pcoa-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Note that in this case, the full
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
includes more than two dimensions, and PCoA is representing 43% of total
variance (correction for negative eigenvalues is included in the call to
<code>cmdscale</code> from <code><a href="../reference/trajectoryPlot.html">trajectoryPCoA()</a></code>), so one has to
be careful when interpreting trajectories visually.</p>
<p>Another option is to use mMDS to represent trajectories, which in
this case produces a similar result:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mMDS</span> <span class="op">&lt;-</span> <span class="fu">smacof</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/smacof/man/smacofSym.html" class="external-link">mds</a></span><span class="op">(</span><span class="va">avoca_D_man</span><span class="op">)</span></span>
<span><span class="va">mMDS</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## smacof::mds(delta = avoca_D_man)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: Symmetric SMACOF </span></span>
<span><span class="co">## Number of objects: 72 </span></span>
<span><span class="co">## Stress-1 value: 0.114 </span></span>
<span><span class="co">## Number of iterations: 49</span></span></code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">mMDS</span><span class="op">$</span><span class="va">conf</span>,  <span class="va">avoca_sites</span>, <span class="va">avoca_surveys</span>,</span>
<span>               traj.colors <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span>, </span>
<span>               axes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, bty<span class="op">=</span><span class="st">"n"</span>, legend <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, col <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/avoca_mmds-1.png" width="480" style="display: block; margin: auto;"></p>
<p>One can inspect specific trajectories using
<code><a href="../reference/subsetTrajectories.html">subsetTrajectories()</a></code>. This allows getting a better view of
particular trajectories, here that of forest plot ‘3’:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">avoca_x</span>, <span class="st">"3"</span><span class="op">)</span>,</span>
<span>               length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">2</span>, time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">plotTrajDiamDist</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/trajectory_3-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>In the right hand, we added a representation of the change in the
mountain beech tree diameter distribution through time for trajectory of
forest plot ‘3’. The dynamics of this plot include mostly growth, which
results in individuals moving from one diameter class to the other. The
whole trajectory looks mostly directional. Let’s now inspect the
trajectory of forest plot ‘4’:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">avoca_x</span>, <span class="st">"4"</span><span class="op">)</span>,</span>
<span>               length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">2</span>, time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">plotTrajDiamDist</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/trajectory_4-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>This second trajectory is less straight and seems to include a turn
by the end of the sampling period, corresponding to the recruitment of
new saplings.</p>
</div>
<div class="section level3">
<h3 id="trajectory-lengths-angles-and-overall-directionality">5.3 Trajectory lengths, angles and overall directionality<a class="anchor" aria-label="anchor" href="#trajectory-lengths-angles-and-overall-directionality"></a>
</h3>
<p>While trajectory lengths and angles can be inspected visually in
ordination diagrams, it is better to calculate them using the full
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
space (i.e., from matrix <code>avoca_D_man</code>). Using function
<code><a href="../reference/trajectoryMetrics.html">trajectoryLengths()</a></code> we can see that the trajectory of
forest plot ‘4’ is lengthier than that of plot ‘3’, mostly because
includes a lengthier last segment (i.e. the recruitment of new
individuals):</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths</a></span><span class="op">(</span><span class="va">avoca_x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          S1        S2        S3        S4        S5        S6        S7</span></span>
<span><span class="co">## 1 1.2173214 1.5911988 1.0976965 2.1173501 0.5238760 1.5863283 1.5750365</span></span>
<span><span class="co">## 2 0.5971165 1.7469687 0.9866591 0.9413060 1.3687614 0.6280231 1.4565581</span></span>
<span><span class="co">## 3 1.1480971 1.2404953 0.6508116 0.4371405 0.5098385 1.2078811 1.6241741</span></span>
<span><span class="co">## 4 0.7932307 1.8572629 0.7268623 0.8348635 3.0560437 1.9863939 0.9905892</span></span>
<span><span class="co">## 5 1.7769875 0.3367341 0.7283030 0.6515714 1.2660552 0.9544933 1.2605333</span></span>
<span><span class="co">## 6 2.1891568 0.5312711 1.0035212 0.4113220 2.1394743 1.0482871 1.4924056</span></span>
<span><span class="co">## 7 0.2919002 0.8857645 1.0908604 0.5601649 2.0600208 0.3712067 1.1014563</span></span>
<span><span class="co">## 8 0.1909713 1.2000266 2.3211891 0.6539882 2.7807668 0.8170202 1.2072425</span></span>
<span><span class="co">##          S8      Path</span></span>
<span><span class="co">## 1 0.6277940 10.336602</span></span>
<span><span class="co">## 2 1.1232798  8.848673</span></span>
<span><span class="co">## 3 1.4536390  8.272077</span></span>
<span><span class="co">## 4 3.8794520 14.124698</span></span>
<span><span class="co">## 5 0.5842314  7.558909</span></span>
<span><span class="co">## 6 1.9623777 10.777816</span></span>
<span><span class="co">## 7 1.7518489  8.113223</span></span>
<span><span class="co">## 8 1.5107357 10.681940</span></span></code></pre>
<p>If we calculate the angles between consecutive segments (using
function <code>trajectoryLengths</code>) we see that indeed the
trajectory of ‘3’ is rather directional, but the angles of trajectory of
‘4’ are larger, on aveerage:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoca_ang</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryAngles</a></span><span class="op">(</span><span class="va">avoca_x</span><span class="op">)</span></span>
<span><span class="va">avoca_ang</span></span></code></pre></div>
<pre><code><span><span class="co">##       S1-S2        S2-S3        S3-S4     S4-S5     S5-S6     S6-S7</span></span>
<span><span class="co">## 1  41.74809 8.669806e+01 7.401875e+01  26.94138 113.40657 100.67068</span></span>
<span><span class="co">## 2  68.14891 3.466506e+01 8.537736e-07   0.00000  25.97111   0.00000</span></span>
<span><span class="co">## 3  87.24519 3.088828e+01 1.207418e-06   0.00000  50.90743  48.12854</span></span>
<span><span class="co">## 4  37.65736 8.537736e-07 8.537736e-07  36.25240  55.53607  74.21065</span></span>
<span><span class="co">## 5  42.02156 7.166400e+01 1.207418e-06  49.95436  65.75897  65.82083</span></span>
<span><span class="co">## 6  41.69894 4.611675e+01 5.669641e+01 135.84929   0.00000   0.00000</span></span>
<span><span class="co">## 7  53.63254 1.152378e+02 6.519921e+01  60.71442   0.00000  56.25733</span></span>
<span><span class="co">## 8 180.00000 0.000000e+00 9.213121e+01 132.36445  71.33948  36.43189</span></span>
<span><span class="co">##          S7-S8     mean        sd       rho</span></span>
<span><span class="co">## 1 1.021996e+02 78.82477 0.5334615 0.8673692</span></span>
<span><span class="co">## 2 1.207418e-06 17.61550 0.4257423 0.9133572</span></span>
<span><span class="co">## 3 4.568199e+01 37.39925 0.5018798 0.8816663</span></span>
<span><span class="co">## 4 4.980332e+01 36.44717 0.4531030 0.9024417</span></span>
<span><span class="co">## 5 1.061250e+02 57.89321 0.5239476 0.8717431</span></span>
<span><span class="co">## 6 0.000000e+00 34.34150 0.7777287 0.7390195</span></span>
<span><span class="co">## 7 1.207418e-06 49.96352 0.6562139 0.8062928</span></span>
<span><span class="co">## 8 1.207418e-06 66.68343 1.1601974 0.5101610</span></span></code></pre>
<p>By calling function <code><a href="../reference/trajectoryMetrics.html">trajectoryDirectionality()</a></code> we can
confirm that the trajectory for forest plot ‘4’ is less straight than
that of plot ‘3’:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoca_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryDirectionality</a></span><span class="op">(</span><span class="va">avoca_x</span><span class="op">)</span></span>
<span><span class="va">avoca_dir</span></span></code></pre></div>
<pre><code><span><span class="co">##         1         2         3         4         5         6         7         8 </span></span>
<span><span class="co">## 0.6781369 0.6736490 0.8651467 0.5122482 0.6677116 0.7058465 0.7391775 0.5254225</span></span></code></pre>
<p>The following code displays the relationship between the statistic in
<code><a href="../reference/trajectoryMetrics.html">trajectoryDirectionality()</a></code> and the mean resultant vector
length that uses angular information only and assesses the constancy of
angle values:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoca_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryAngles</a></span><span class="op">(</span><span class="va">avoca_x</span>, all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">rho</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">avoca_rho</span>, <span class="va">avoca_dir</span>, xlab <span class="op">=</span> <span class="st">"rho(T)"</span>, ylab <span class="op">=</span> <span class="st">"dir(T)"</span>, type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">avoca_rho</span>, <span class="va">avoca_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/unnamed-chunk-48-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="convergence-between-trajectories">5.4 Convergence between trajectories<a class="anchor" aria-label="anchor" href="#convergence-between-trajectories"></a>
</h3>
<p>We may ask if structure in forest plots is becoming more similar with
time. This question can be addressed using an overall test of
convergence, which we can do because trajectories are synchronous:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryConvergence</a></span><span class="op">(</span><span class="va">avoca_x</span>, type<span class="op">=</span><span class="st">"multiple"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tau</span></span>
<span><span class="co">## [1] -0.8333333</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p.value</span></span>
<span><span class="co">## [1] 0.002499029</span></span></code></pre>
<p>In this case we obtain that tau is decreasing and the test is
significant, which indicates that forest structures are overall
converging. This general trend may not be true for specific pairs of
plots. Converge/divergence between pairs of plots would be assessed
using:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryConvergence</a></span><span class="op">(</span><span class="va">avoca_x</span>, type<span class="op">=</span><span class="st">"pairwise.symmetric"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tau</span></span>
<span><span class="co">##             1           2          3          4          5          6</span></span>
<span><span class="co">## 1          NA -0.05555556 -0.4444444 -0.4444444 -0.4444444 -0.4444444</span></span>
<span><span class="co">## 2 -0.05555556          NA -0.3888889  0.1111111 -0.3333333 -0.3888889</span></span>
<span><span class="co">## 3 -0.44444445 -0.38888890         NA  0.4444444 -0.1111111 -0.6666667</span></span>
<span><span class="co">## 4 -0.44444445  0.11111111  0.4444444         NA  0.6111111  0.2777778</span></span>
<span><span class="co">## 5 -0.44444445 -0.33333334 -0.1111111  0.6111111         NA  0.4444444</span></span>
<span><span class="co">## 6 -0.44444445 -0.38888890 -0.6666667  0.2777778  0.4444444         NA</span></span>
<span><span class="co">## 7 -0.05555556 -0.33333334 -0.3888889  0.4444444  0.1666667 -0.7777778</span></span>
<span><span class="co">## 8 -0.94444442 -0.83333331 -0.6666667 -0.4444444 -0.5555556 -0.5555556</span></span>
<span><span class="co">##             7          8</span></span>
<span><span class="co">## 1 -0.05555556 -0.9444444</span></span>
<span><span class="co">## 2 -0.33333334 -0.8333333</span></span>
<span><span class="co">## 3 -0.38888890 -0.6666667</span></span>
<span><span class="co">## 4  0.44444445 -0.4444444</span></span>
<span><span class="co">## 5  0.16666667 -0.5555556</span></span>
<span><span class="co">## 6 -0.77777779 -0.5555556</span></span>
<span><span class="co">## 7          NA -0.5000000</span></span>
<span><span class="co">## 8 -0.50000000         NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p.value</span></span>
<span><span class="co">##             1           2          3          4          5           6</span></span>
<span><span class="co">## 1          NA 0.916965246 0.11785091 0.11785091 0.11785091 0.117850907</span></span>
<span><span class="co">## 2 0.916965246          NA 0.17530808 0.75445414 0.25145215 0.175308079</span></span>
<span><span class="co">## 3 0.117850907 0.175308079         NA 0.11785090 0.75445420 0.016488666</span></span>
<span><span class="co">## 4 0.117850907 0.754454136 0.11785090         NA 0.02856767 0.348082542</span></span>
<span><span class="co">## 5 0.117850907 0.251452148 0.75445420 0.02856767         NA 0.117850900</span></span>
<span><span class="co">## 6 0.117850907 0.175308079 0.01648867 0.34808254 0.11785090          NA</span></span>
<span><span class="co">## 7 0.916965246 0.251452148 0.17530808 0.11785090 0.60216761 0.004878566</span></span>
<span><span class="co">## 8 0.000580667 0.002499029 0.01648867 0.11785091 0.04760397 0.047603969</span></span>
<span><span class="co">##             7           8</span></span>
<span><span class="co">## 1 0.916965246 0.000580667</span></span>
<span><span class="co">## 2 0.251452148 0.002499029</span></span>
<span><span class="co">## 3 0.175308079 0.016488666</span></span>
<span><span class="co">## 4 0.117850900 0.117850907</span></span>
<span><span class="co">## 5 0.602167606 0.047603969</span></span>
<span><span class="co">## 6 0.004878566 0.047603969</span></span>
<span><span class="co">## 7          NA 0.076332748</span></span>
<span><span class="co">## 8 0.076332748          NA</span></span></code></pre>
<p>Inspecting these results we can conclude that several pairs of plots
are significantly converging (notably with plot ‘8’), but there is also
a significant divergence between plots ‘4’ and ‘5’. We can display this
divergence graphically using:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">avoca_x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4"</span>, <span class="st">"5"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               traj.colors <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, </span>
<span>               axes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, bty<span class="op">=</span><span class="st">"n"</span>, legend <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">5</span>, col <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/trajectories_4_5_plot-1.png" width="480" style="display: block; margin: auto;"></p>
<p>To interpret this result we can compare the corresponding changes in
diameter distribution:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plotTrajDiamDist</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">plotTrajDiamDist</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/trajectories_4_5_diam-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>Apparently, the divergence would be explained by the fact that while
plot ‘4’ evolves towards a more regular structure of medium/large trees
(i.e. from more diverse tree size distribution towards less diverse
one), plot ‘5’ maintains an irregular structure (i.e. diverse tree size
distribution) throughout the years thanks to a greater sapling
ingrowth.</p>
</div>
<div class="section level3">
<h3 id="distances-between-trajectories-1">5.5 Distances between trajectories<a class="anchor" aria-label="anchor" href="#distances-between-trajectories-1"></a>
</h3>
<p>We can calculate the resemblance between forest plot trajectories
using <code><a href="../reference/trajectoryComparison.html">trajectoryDistances()</a></code>:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoca_D_traj_man</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">avoca_x</span>, distance.type<span class="op">=</span><span class="st">"DSPD"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">avoca_D_traj_man</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       1     2     3     4     5     6     7</span></span>
<span><span class="co">## 2 2.405                                    </span></span>
<span><span class="co">## 3 6.805 5.773                              </span></span>
<span><span class="co">## 4 6.123 6.646 5.225                        </span></span>
<span><span class="co">## 5 6.020 5.541 3.235 4.966                  </span></span>
<span><span class="co">## 6 9.490 8.866 3.436 6.043 4.505            </span></span>
<span><span class="co">## 7 4.024 3.291 4.365 4.993 4.389 6.205      </span></span>
<span><span class="co">## 8 9.797 9.747 5.591 4.611 6.383 5.043 6.949</span></span></code></pre>
<p>The closest trajectories are those of plots ‘1’ and ‘2’. They looked
rather close in <em>position</em> in the PCoA ordination of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
with all trajectories, so probably it is position, rather than
<em>shape</em> which has influenced this low value. The next pair of
similar trajectories are those of the ‘3’-‘5’ pair. We can again use
mMDS to produce an ordination of resemblances between trajectories:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mMDS</span><span class="op">&lt;-</span><span class="fu">smacof</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/smacof/man/smacofSym.html" class="external-link">mds</a></span><span class="op">(</span><span class="va">avoca_D_traj_man</span><span class="op">)</span></span>
<span><span class="va">mMDS</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## smacof::mds(delta = avoca_D_traj_man)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: Symmetric SMACOF </span></span>
<span><span class="co">## Number of objects: 8 </span></span>
<span><span class="co">## Stress-1 value: 0.091 </span></span>
<span><span class="co">## Number of iterations: 25</span></span></code></pre>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="va">mMDS</span><span class="op">$</span><span class="va">conf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">mMDS</span><span class="op">$</span><span class="va">conf</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, type<span class="op">=</span><span class="st">"p"</span>, asp<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Axis 1"</span><span class="op">)</span>, </span>
<span>     ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Axis 2"</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"black"</span>,</span>
<span>     bg<span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Accent"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, labels<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, pos<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/avoca_DT_PCoA-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="dynamic-variation-1">5.6 Dynamic variation<a class="anchor" aria-label="anchor" href="#dynamic-variation-1"></a>
</h3>
<p>To determine which forest plots have more unique structural dynamics,
we can use function <code><a href="../reference/dynamicVariation.html">dynamicVariation()</a></code>:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dynamicVariation.html">dynamicVariation</a></span><span class="op">(</span><span class="va">avoca_x</span>, distance.type<span class="op">=</span><span class="st">"DSPD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $dynamic_ss</span></span>
<span><span class="co">## [1] 127.5603</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dynamic_variance</span></span>
<span><span class="co">## [1] 18.2229</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $relative_contributions</span></span>
<span><span class="co">##          1          2          3          4          5          6          7 </span></span>
<span><span class="co">## 0.19647629 0.16743851 0.05093440 0.08698905 0.05371379 0.17015568 0.04851269 </span></span>
<span><span class="co">##          8 </span></span>
<span><span class="co">## 0.22577959</span></span></code></pre>
<p>We see that forest plots ‘3’, ‘4’, ‘5’ and ‘7’ contribute much less
to overall variation in dynamics than the others. These plots are the
same that were located closer to the center of the previous ordination
plot. The more unique plot is ‘8’, which we can isolate and inspect
using:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trajectoryPlot.html">trajectoryPCoA</a></span><span class="op">(</span><span class="fu"><a href="../reference/subsetTrajectories.html">subsetTrajectories</a></span><span class="op">(</span><span class="va">avoca_x</span>, <span class="st">"8"</span><span class="op">)</span>,</span>
<span>               length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">2</span>, time.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">plotTrajDiamDist</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductionETA_files/figure-html/trajectory_8-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>Apparently, the distinctiveness of plot ‘8’ from the remaining stems
from its very low number of trees at the beginning and the large amount
of regeneration. This structural dynamics would be rather different from
that of other plots that have more adults in the beginning and less
amount of regeneration.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">6. References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Besse, P., Guillouet, B., Loubes, J.-M. &amp; François, R. (2016).
Review and perspective for distance based trajectory clustering. IEEE
Trans. Intell. Transp. Syst., 17, 3306–3317.</p>
<p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ,
Condit R &amp; Hubbell S. (2019). Trajectory analysis in community
ecology. Ecological Monographs 89, e01350.</p>
<p>Sturbois, A., De Cáceres, M., Sánchez-Pinillos, M., Schaal, G.,
Gauthier, O., Le Mao, P., Ponsero, A., &amp; Desroy, N. (2021a).
Extending community trajectory analysis : New metrics and
representation. Ecological Modelling 440: 109400. <a href="https://doi.org/10.1016/j.ecolmodel.2020.109400" class="external-link uri">https://doi.org/10.1016/j.ecolmodel.2020.109400</a>.</p>
<p>Sturbois, A., Cucherousset, J., De Cáceres, M., Desroy, N., Riera,
P., Carpentier, A., Quillien, N., Grall, J., Espinasse, B., Cherel, Y.,
Schaal, G. (2021b). Stable Isotope Trajectory Analysis (SITA) : A new
approach to quantify and visualize dynamics in stable isotope studies.
Ecological Monographs, 92, e1501. <a href="https://doi.org/10.1002/ecm.1501" class="external-link uri">https://doi.org/10.1002/ecm.1501</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Djeghri, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
