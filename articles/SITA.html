<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Stable Isotope Trajectory Analysis (SITA) • ecotraj</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stable Isotope Trajectory Analysis (SITA)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/TransformingTrajectories.html">Transforming trajectories</a></li>
    <li><a class="dropdown-item" href="../articles/TrajectoryDistanceMetrics.html">Distance metrics for trajectory resemblance</a></li>
    <li><a class="dropdown-item" href="../articles/Dissimilarities.html">Dissimilarities in community data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Stable Isotope Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Introduction to Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cyclical Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionCETA.html">Introduction to Cyclical Ecological Trajectory Analysis (CETA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Stable Isotope Trajectory Analysis (SITA)</h1>
                        <h4 data-toc-skip class="author">Anthony
STURBOIS</h4>
            
            <h4 data-toc-skip class="date">2025-05-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/vignettes/SITA.Rmd" class="external-link"><code>vignettes/SITA.Rmd</code></a></small>
      <div class="d-none name"><code>SITA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-this-vignette">1. About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h2>
<p>This vignette present some ecological applications used by Sturbois
et al. (2021) in the new stable isotope trajectory analysis
framework:</p>
<ul>
<li>Sturbois, et al., Stable Isotope Trajectory Analysis (SITA): A new
approach to quantify and visualize dynamics in stable isotope studies.
Ecol. Monogr. (2021). <a href="https://doi.org/10.1002/ecm.1501" class="external-link uri">https://doi.org/10.1002/ecm.1501</a>
</li>
</ul>
<p>Example datasets have been included in the package for
reproducibility. After the calculation of the necessary distance- and
direction-based metrics, the vignette focuses, for each ecological
applications, on the creation of trajectory charts.</p>
</div>
<div class="section level2">
<h2 id="loading-libraries">2. Loading libraries<a class="anchor" aria-label="anchor" href="#loading-libraries"></a>
</h2>
<p>First of all, we load the required libraries, including
<code>ecotraj</code>:</p>
<pre><code><span><span class="co">## Loading required package: Rcpp</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: viridisLite</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'viridis'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:scales':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     viridis_pal</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="spatial-and-temporal-resource-partitioning-in-fur-seals">3. Spatial and temporal resource partitioning in fur seals<a class="anchor" aria-label="anchor" href="#spatial-and-temporal-resource-partitioning-in-fur-seals"></a>
</h2>
<div class="section level3">
<h3 id="fur-seal-stable-isotope-dataset">3.1 Fur seal stable isotope dataset<a class="anchor" aria-label="anchor" href="#fur-seal-stable-isotope-dataset"></a>
</h3>
<p>We begin by loading the package dataset <code>furseals</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"furseals"</span><span class="op">)</span></span></code></pre></div>
<p>This is a subset of the dataset provided in:</p>
<ul>
<li>Kernaléguen, L., Arnould, J.P.Y., Guinet, C., Cherel, Y., 2015.
Determinants of individual foraging specialization in large marine
vertebrates, the Antarctic and subantarctic fur seals. <em>Journal of
Animal Ecology</em> 1081–1091.</li>
</ul>
<p>Briefly, fur seals [the Antarctic fur seal <em>Arctocephalus
gazella</em> (AFS) and subantarctic fur seal <em>A. tropicalis</em>
(SAFS)] whisker SI values yield unique long-term information on
individual behaviour which integrates the spatial, trophic and temporal
dimensions of the ecological niche. The foraging strategies of this two
species of sympatric fur seals were examined in the winter 2001/2002 at
Crozet, Amsterdam and Kerguelen Islands (Southern Ocean) using the
stable isotope values of serially sampled whiskers. The method consists
in the analysis of consecutive whisker sections (3 mm long) starting
from the proximal (facial) end, with the most recently synthesized
tissue remaining under the skin. Only individuals (n = 47) with whiskers
totalizing at least 30 sections were selected in the initial data, and
only those 30 sections were considered herein, from t1 (more recent
values) to t30 (oldest values).</p>
</div>
<div class="section level3">
<h3 id="trajectory-metrics-on-stable-isotope-2d-space">3.2 Trajectory metrics on stable isotope 2D space<a class="anchor" aria-label="anchor" href="#trajectory-metrics-on-stable-isotope-2d-space"></a>
</h3>
<p>In this section, we illustrate how to calculate trajectory metrics to
characterize the foraging strategy of each fur seal. In the following
sections, we show how to use these metrics as data to create plots.</p>
<p>First, we calculate net changes relative to the initial state
(i.e. the distance between stable isotope compositions (i.e state) of
each whisker section and the initial stable isotope composition):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_changes</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths2D</a></span><span class="op">(</span><span class="va">furseals</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d13C"</span>,<span class="st">"d15N"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                 <span class="va">furseals</span><span class="op">$</span><span class="va">ID_SITA</span>,</span>
<span>                                 <span class="va">furseals</span><span class="op">$</span><span class="va">Time</span>, relativeToInitial<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Net_changes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       Lt1_t2    Lt1_t3    Lt1_t4    Lt1_t5     Lt1_t6    Lt1_t7    Lt1_t8</span></span>
<span><span class="co">## 1 0.08246211 1.0892314 2.0775851 2.3714985 2.20626585 1.7839633 1.6819920</span></span>
<span><span class="co">## 2 0.59304131 0.9583074 0.8218643 0.2677928 0.08105554 0.7460168 0.4970191</span></span>
<span><span class="co">## 3 0.23256182 1.4622975 3.0029069 2.8817373 2.55906428 1.6445066 1.6734124</span></span>
<span><span class="co">## 4 1.24068086 2.1744498 2.3520872 2.4028260 2.28455422 2.2679323 0.9493714</span></span>
<span><span class="co">## 5 1.80624915 3.0818595 3.8011940 4.4793800 4.50949775 4.3885128 2.9507619</span></span>
<span><span class="co">## 6 1.13903687 4.3444610 4.0299700 6.4151503 5.96779901 6.0314152 7.2216151</span></span>
<span><span class="co">##     Lt1_t9   Lt1_t10   Lt1_t11   Lt1_t12   Lt1_t13   Lt1_t14   Lt1_t15</span></span>
<span><span class="co">## 1 1.344206 1.2735702 1.0631895 0.7915611 0.8486489 1.0500638 1.1961910</span></span>
<span><span class="co">## 2 1.092157 0.6772156 0.7744366 0.2702240 0.6136685 1.0261861 0.7000864</span></span>
<span><span class="co">## 3 2.518128 2.0782324 1.7294097 1.1594387 1.7649975 2.7768920 2.4641059</span></span>
<span><span class="co">## 4 0.577084 0.6049504 0.5920490 1.5973206 1.1985112 0.8119858 0.6936173</span></span>
<span><span class="co">## 5 2.187465 0.9662236 2.6143697 2.7163971 2.7958673 2.6837384 2.2504011</span></span>
<span><span class="co">## 6 7.173525 6.2867554 0.2478810 0.9972668 0.9076795 0.5088025 0.6640821</span></span>
<span><span class="co">##     Lt1_t16   Lt1_t17   Lt1_t18   Lt1_t19  Lt1_t20  Lt1_t21   Lt1_t22   Lt1_t23</span></span>
<span><span class="co">## 1 1.5432880 1.6484832 1.6042908 1.6566572 1.108358 0.381577 0.3006742 1.4772136</span></span>
<span><span class="co">## 2 0.5592397 0.4460235 0.6495922 0.7966461 1.787011 1.591433 1.5776276 1.6305889</span></span>
<span><span class="co">## 3 0.2755014 0.4497755 0.6170292 0.2879392 1.103359 2.145421 2.1758332 2.1139858</span></span>
<span><span class="co">## 4 0.3626927 0.7276160 0.9288983 0.7955941 2.352899 1.851222 2.2158782 2.3341939</span></span>
<span><span class="co">## 5 1.8418754 1.8304906 1.8207087 1.5938494 1.553721 1.583789 1.5700115 0.6566011</span></span>
<span><span class="co">## 6 3.6309179 4.0313501 6.0026223 6.9996921 6.341455 7.297884 7.5324814 6.1068566</span></span>
<span><span class="co">##     Lt1_t24   Lt1_t25   Lt1_t26   Lt1_t27    Lt1_t28   Lt1_t29   Lt1_t30</span></span>
<span><span class="co">## 1 1.5890755 1.0783103 1.1172381 2.0638181 2.52046504 2.2934779 1.6320787</span></span>
<span><span class="co">## 2 0.2046069 0.3937309 0.3849480 0.7032112 0.89491061 0.3901513 0.7480241</span></span>
<span><span class="co">## 3 2.2036883 1.8413856 1.6354464 1.9473328 1.59052601 1.3147125 1.6315076</span></span>
<span><span class="co">## 4 2.1019596 0.2814321 0.4237924 0.7473988 0.05360037 0.3889730 0.7375269</span></span>
<span><span class="co">## 5 4.0823528 4.4187248 4.3025323 4.3520214 3.43035873 0.7908375 1.2435373</span></span>
<span><span class="co">## 6 1.7282780 2.1873694 1.2698965 0.5391030 0.40993902 0.4085156 0.7709643</span></span>
<span><span class="co">##        Path</span></span>
<span><span class="co">## 1  40.87543</span></span>
<span><span class="co">## 2  21.87682</span></span>
<span><span class="co">## 3  49.28114</span></span>
<span><span class="co">## 4  36.05110</span></span>
<span><span class="co">## 5  76.30333</span></span>
<span><span class="co">## 6 107.19276</span></span></code></pre>
<p>We then calculate trajectory segment lengths, i.e. the distance
between the stable isotope composition of consecutive whisker sections
in the stable isotope space:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Segment_lengths</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths2D</a></span><span class="op">(</span><span class="va">furseals</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d13C"</span>,<span class="st">"d15N"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                     <span class="va">furseals</span><span class="op">$</span><span class="va">ID_SITA</span>,</span>
<span>                                     <span class="va">furseals</span><span class="op">$</span><span class="va">Time</span>, relativeToInitial<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Segment_lengths</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           S1        S2       S3         S4         S5         S6        S7</span></span>
<span><span class="co">## 1 0.08246211 1.0799190 1.109759 0.39708060 0.16604819 0.69542793 0.1332817</span></span>
<span><span class="co">## 2 0.59304131 0.4019664 0.165463 0.62878295 0.24977790 0.81093588 0.4377728</span></span>
<span><span class="co">## 3 0.23256182 1.2719328 1.561554 0.13206059 0.81044432 1.21893232 0.3748826</span></span>
<span><span class="co">## 4 1.24068086 0.9337907 0.177792 0.08732125 0.11957006 0.06462971 1.3506817</span></span>
<span><span class="co">## 5 1.80624915 1.2835334 1.452408 1.22947021 0.05423099 0.33640006 1.4518034</span></span>
<span><span class="co">## 6 1.13903687 3.2697465 1.007842 2.40400083 1.02618176 0.80004000 1.4924584</span></span>
<span><span class="co">##           S8         S9       S10       S11        S12       S13       S14</span></span>
<span><span class="co">## 1 0.35206960 0.13800362 0.2119929 0.3940774 0.08004998 0.2026154 0.2040221</span></span>
<span><span class="co">## 2 0.94680304 0.44818858 0.6290191 0.5362695 0.52697249 0.4552637 0.3411231</span></span>
<span><span class="co">## 3 1.04072379 0.44107256 0.3592548 0.7240691 0.66598649 1.0131856 0.4798427</span></span>
<span><span class="co">## 4 1.44655867 0.09009439 1.1117198 2.1338287 0.39901128 1.4341130 0.3064376</span></span>
<span><span class="co">## 5 0.78147681 1.29231962 3.5747035 0.6261150 0.09265528 0.2502838 0.6440194</span></span>
<span><span class="co">## 6 0.05115662 0.88680381 6.3555849 0.9913889 0.09047099 0.4029814 1.1639300</span></span>
<span><span class="co">##         S15       S16       S17       S18       S19       S20        S21</span></span>
<span><span class="co">## 1 0.3703039 0.1632330 1.7046178 1.0355916 1.0132186 0.7423544 0.11970798</span></span>
<span><span class="co">## 2 0.1554670 0.2837781 0.2257632 0.6603492 0.9904383 0.5893293 0.03956008</span></span>
<span><span class="co">## 3 2.3198028 0.5979908 0.3078262 0.3993219 1.3487198 1.1301832 0.04002499</span></span>
<span><span class="co">## 4 0.8420291 0.4612776 1.5254799 0.1874727 1.5712829 0.5036268 0.41386471</span></span>
<span><span class="co">## 5 0.4404407 0.5163768 0.5204652 0.2380084 0.1802276 0.2205108 0.22402009</span></span>
<span><span class="co">## 6 2.9863858 0.7196339 1.9833855 1.0789699 0.7247068 0.9616637 0.24162988</span></span>
<span><span class="co">##          S22       S23       S24       S25       S26       S27       S28</span></span>
<span><span class="co">## 1 1.76281735 0.1147911 0.6148642 0.3162910 0.9585927 0.5338661 0.2521686</span></span>
<span><span class="co">## 2 0.27828942 1.4322639 0.5912495 0.7604426 0.3286716 0.2085977 0.5259743</span></span>
<span><span class="co">## 3 0.09244458 0.1509503 0.6998436 0.3191520 0.6441894 0.5047336 0.3805181</span></span>
<span><span class="co">## 4 0.25223997 0.2500180 1.8461901 0.6878982 0.3330540 0.7518151 0.3540353</span></span>
<span><span class="co">## 5 2.03381243 3.4923735 0.4153228 0.1254313 0.1696408 0.9698892 2.7246227</span></span>
<span><span class="co">## 6 1.48631692 7.3792361 0.6324634 0.9520021 0.9154939 0.1794937 0.3834071</span></span>
<span><span class="co">##         S29     Path</span></span>
<span><span class="co">## 1 0.6836988 15.63293</span></span>
<span><span class="co">## 2 0.3593800 14.60093</span></span>
<span><span class="co">## 3 0.3359345 19.59814</span></span>
<span><span class="co">## 4 0.5050881 21.38160</span></span>
<span><span class="co">## 5 1.8207584 28.96757</span></span>
<span><span class="co">## 6 0.9149454 42.62136</span></span></code></pre>
<p>Finally, we determine the angle
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
of consecutive trajectory segments with respect to the second axis of
the 2D stable isotope space:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Angles</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryAngles2D</a></span><span class="op">(</span><span class="va">furseals</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d13C"</span>,<span class="st">"d15N"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                           <span class="va">furseals</span><span class="op">$</span><span class="va">ID_SITA</span>,</span>
<span>                           <span class="va">furseals</span><span class="op">$</span><span class="va">Time</span>, betweenSegments<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Angles</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Axis2-t1  Axis2-t2  Axis2-t3   Axis2-t4   Axis2-t5  Axis2-t6  Axis2-t7</span></span>
<span><span class="co">## 1  75.96376 161.64894 195.57662 222.448400   9.008504  48.14751  25.79603</span></span>
<span><span class="co">## 2 179.32369 147.49601 315.00000 337.758643  47.109090 356.04023 139.72521</span></span>
<span><span class="co">## 3 243.98585 206.02112 198.13327   1.735705 326.780524  10.11145 151.99944</span></span>
<span><span class="co">## 4  64.19912  63.68191  66.46289 119.500725 237.639062 171.99527 255.90203</span></span>
<span><span class="co">## 5 263.32352 271.65188 195.28972 181.584670 174.709919 343.77386  61.26355</span></span>
<span><span class="co">## 6  65.68510  43.26505 163.63292  53.082435 298.712949 139.46085  99.02053</span></span>
<span><span class="co">##    Axis2-t8  Axis2-t9 Axis2-t10   Axis2-t11 Axis2-t12 Axis2-t13 Axis2-t14</span></span>
<span><span class="co">## 1 358.86075 283.83485 352.13745  22.5303928 192.99462 157.35838 199.76717</span></span>
<span><span class="co">## 2 307.01513 171.27328 215.35767  80.5552424  19.74159  26.62133 201.67665</span></span>
<span><span class="co">## 3 186.01189  37.90916  45.90222   0.7913279 198.10848 214.09786  81.85301</span></span>
<span><span class="co">## 4 250.78846 351.06043  81.67311 261.0762308  90.43079  53.84926 234.02761</span></span>
<span><span class="co">## 5  62.15609  60.16163  36.43393 125.7717105  83.18179 293.79978 270.44483</span></span>
<span><span class="co">## 6 265.51539 245.97847 247.59927 224.5913352  66.55194  64.26158  61.40918</span></span>
<span><span class="co">##   Axis2-t15 Axis2-t16 Axis2-t17 Axis2-t18 Axis2-t19 Axis2-t20 Axis2-t21</span></span>
<span><span class="co">## 1 182.32153 112.32286  37.13207  351.0561 280.57797 209.98421 149.36458</span></span>
<span><span class="co">## 2 203.10181 122.62605  56.38032  290.3834 341.27235 223.14352  73.85566</span></span>
<span><span class="co">## 3  34.05313  18.22286 331.68664  173.8183 198.63646 223.85280 167.00538</span></span>
<span><span class="co">## 4 180.47632 178.01222  48.64094  208.3422  64.39713 244.35079  38.91926</span></span>
<span><span class="co">## 5 236.67073 131.62432 147.71456  228.4064 173.30874 159.83930 179.23269</span></span>
<span><span class="co">## 6  52.20915 115.78169  71.69294   42.1451 219.40066  71.88535  52.22900</span></span>
<span><span class="co">##   Axis2-t22 Axis2-t23 Axis2-t24 Axis2-t25 Axis2-t26 Axis2-t27 Axis2-t28</span></span>
<span><span class="co">## 1 188.15309  198.2771  338.7350 109.58071 196.73359 224.92411 352.48043</span></span>
<span><span class="co">## 2  48.05870  155.7613  152.8282 351.45433  23.67929 346.69657 176.51200</span></span>
<span><span class="co">## 3  74.31001  150.2080  331.4941 353.34260 156.77805  68.62019 338.89763</span></span>
<span><span class="co">## 4 129.36932  270.6875  251.1332 240.37909 268.96776  74.65130 298.88170</span></span>
<span><span class="co">## 5 254.83630  245.0713  203.1080  35.59078 163.91542  71.91999  58.09492</span></span>
<span><span class="co">## 6 231.11744  239.4211  251.8515  22.74023  21.46438 118.99260 128.75316</span></span>
<span><span class="co">##   Axis2-t29</span></span>
<span><span class="co">## 1  31.96985</span></span>
<span><span class="co">## 2  28.77587</span></span>
<span><span class="co">## 3 186.15184</span></span>
<span><span class="co">## 4 235.64922</span></span>
<span><span class="co">## 5  61.49251</span></span>
<span><span class="co">## 6  67.77996</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="identification-and-characterization-of-trajectory-clusters">3.3 Identification and characterization of trajectory clusters<a class="anchor" aria-label="anchor" href="#identification-and-characterization-of-trajectory-clusters"></a>
</h3>
<p>Here we aim to define groups of fur seals depending on the similarity
of their foraging strategy. We need first to calculate distances between
pairs of complete trajectories in the stable isotope space:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">furseals</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d13C"</span>,<span class="st">"d15N"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">furseals_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">D</span>, <span class="va">furseals</span><span class="op">$</span><span class="va">ID_SITA</span><span class="op">)</span></span>
<span><span class="va">Ds</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">furseals_x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span>,</span>
<span>                        symmetrization <span class="op">=</span> <span class="st">"mean"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Then, we can use function <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code> to conduct a
hierarchiacl clustering on the symmetric matrix <code>D</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colstd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"yellow"</span>,<span class="st">"green"</span>,<span class="st">"blue"</span>,<span class="st">"grey"</span>,<span class="st">"red"</span><span class="op">)</span></span>
<span><span class="va">pt</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">16</span>,<span class="fl">16</span>,<span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">hsxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">Ds</span>, <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hsxy</span>,hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, main<span class="op">=</span><span class="st">"distance Fur Seals"</span>, cex<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></span>
<span><span class="va">Hst</span><span class="op">=</span><span class="fl">2</span> <span class="co"># Cutting height</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html" class="external-link">rect.hclust</a></span><span class="op">(</span><span class="va">hsxy</span>, h<span class="op">=</span><span class="va">Hst</span>,</span>
<span>               border <span class="op">=</span> <span class="va">colstd</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>We cut the dendrogram at height <code>Hst</code> to obtain a vector
of cluster membership and copy it in <code>furseals</code> as a
factor:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">hsxy</span>, h<span class="op">=</span><span class="va">Hst</span><span class="op">)</span></span>
<span><span class="va">furseals</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="individual-trophic-trajectories-for-males-and-females-of-a--gazella-and-a--tropicalis">3.3.1 Individual trophic trajectories for males and females of
<em>A. gazella</em> and <em>A. tropicalis</em><a class="anchor" aria-label="anchor" href="#individual-trophic-trajectories-for-males-and-females-of-a--gazella-and-a--tropicalis"></a>
</h4>
<p>Here we display trophic trajectories of all individuals, in plots
corresponding to combinations of species and gender. To facilitate such
plots, we create of a vector with the combination of species and
gender:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">furseals</span><span class="op">$</span><span class="va">sp_gender</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">furseals</span><span class="op">$</span><span class="va">Sexe</span>, <span class="va">furseals</span><span class="op">$</span><span class="va">Species</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<p>We now create a diagram to display fur seal trophic trajectories in
the stable isotope space. Panels correspond to the combination of
species and gender. In each panel, X-Y axes are defined by d13C and d15N
stable isotope values. Arrows connects all whiskers section SI states
from t1 to t30 (i.e. most recent to oldest SI state). Colors corresponds
to trajectory clusters and shape to breeding sites:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">furseals</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">d13C</span>,y<span class="op">=</span><span class="va">d15N</span>,color<span class="op">=</span><span class="va">cluster</span>,shape<span class="op">=</span><span class="va">Place</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">d13C</span>,y<span class="op">=</span><span class="va">d15N</span>,group<span class="op">=</span><span class="va">ID_SITA</span>,color<span class="op">=</span><span class="va">cluster</span><span class="op">)</span>,</span>
<span>            arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span><span class="op">*</span><span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">15</span><span class="op">*</span><span class="st">"N"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sp_gender</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="net-changes-time-series-for-males-and-females-of-both-fur-seal-species">3.3.2 Net changes time series for males and females of both fur seal
species<a class="anchor" aria-label="anchor" href="#net-changes-time-series-for-males-and-females-of-both-fur-seal-species"></a>
</h4>
<p>In this sub-section we display net changes time series for all
individuals, in plots corresponding to combinations of species and
gender We prepare a subset of the data called <code>NC</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NC</span><span class="op">&lt;-</span><span class="va">Net_changes</span><span class="op">[</span>,<span class="op">-</span><span class="fl">30</span><span class="op">]</span></span>
<span><span class="va">NC</span><span class="op">$</span><span class="va">cluster</span><span class="op">&lt;-</span><span class="va">furseals</span><span class="op">$</span><span class="va">cluster</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span><span class="op">]</span></span>
<span><span class="va">NC</span><span class="op">$</span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">NC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">NC</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">30</span>,<span class="st">"cluster"</span>,<span class="st">"ID"</span><span class="op">)</span></span></code></pre></div>
<p>We then prepare the subset. We notably transform NC to a longer
format, order the data set and add the vector sp_gender:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NCline</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">NC</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">29</span>, </span>
<span>                              names_to <span class="op">=</span><span class="st">"Time_from_present"</span>, </span>
<span>                              values_to<span class="op">=</span><span class="st">"Net_changes"</span>, </span>
<span>                              names_transform <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">NCline</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clusters"</span>, <span class="st">"ID"</span><span class="op">)</span></span>
<span><span class="va">NCline</span> <span class="op">&lt;-</span> <span class="va">NCline</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">NCline</span><span class="op">$</span><span class="va">Time_from_present</span>, decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">NCline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">NCline</span><span class="op">)</span></span>
<span><span class="va">NCline</span><span class="op">$</span><span class="va">sp_gender</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">furseals</span><span class="op">$</span><span class="va">sp_gender</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>We now create the plot to display net changes time series for all
individuals in panel corresponding Arrows connects all whiskers section
stable isotope values from t1 to t30 (i.e. most recent to oldest stable
isotope values). Colours corresponds to trajectory clusters:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">NCline</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Time_from_present</span>,y<span class="op">=</span><span class="va">Net_changes</span>,color<span class="op">=</span><span class="va">Clusters</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Time_from_present</span>,y<span class="op">=</span><span class="va">Net_changes</span>,group<span class="op">=</span><span class="va">ID</span>,color<span class="op">=</span><span class="va">Clusters</span><span class="op">)</span>,</span>
<span>            arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sp_gender</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="angle-alpha-trajectory-roses-of-fur-seals-trajectory-cluster-">3.3.3 Angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
trajectory roses of Fur seals trajectory cluster.<a class="anchor" aria-label="anchor" href="#angle-alpha-trajectory-roses-of-fur-seals-trajectory-cluster-"></a>
</h4>
<p>In this sub-section, we plot the distribution of Angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
values in a trajectory rose<br>
We prepare the data set to compute the trajectory rose and transform to
a long data structure. We create a vector of direction to class Angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
values by range of 15°:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Angl</span><span class="op">&lt;-</span><span class="va">Angles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Angl</span><span class="op">)</span><span class="op">&lt;-</span><span class="fl">2</span><span class="op">:</span><span class="fl">30</span></span>
<span><span class="va">Angl</span><span class="op">$</span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Angl</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Angl</span><span class="op">$</span><span class="va">cluster</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span>
<span><span class="va">Angl</span><span class="op">$</span><span class="va">sp_gender</span><span class="op">&lt;-</span><span class="va">furseals</span><span class="op">$</span><span class="va">sp_gender</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span><span class="op">]</span></span>
<span></span>
<span><span class="va">Angline</span><span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">Angl</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">29</span>, </span>
<span>                              names_to <span class="op">=</span><span class="st">"Time_from_present"</span>, </span>
<span>                              values_to<span class="op">=</span><span class="st">"Direction"</span>, </span>
<span>                              names_transform <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Angline</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clusters"</span>, <span class="st">"Group"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># range 15°</span></span>
<span><span class="va">deg</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="co"># vector for range of direction of different bars</span></span>
<span><span class="va">dir.breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span><span class="op">-</span><span class="op">(</span><span class="va">deg</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">360</span><span class="op">+</span><span class="op">(</span><span class="va">deg</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="va">deg</span><span class="op">)</span></span>
<span><span class="va">dir.binned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">Angline</span><span class="op">$</span><span class="va">Direction</span>,</span>
<span>                  breaks <span class="op">=</span> <span class="va">dir.breaks</span>,</span>
<span>                  ordered_result <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># direction labels</span></span>
<span><span class="va">dir.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">-</span><span class="va">deg</span>, by <span class="op">=</span> <span class="va">deg</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dir.binned</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dir.labels</span></span>
<span></span>
<span><span class="co"># angles distribution in each range of direction</span></span>
<span><span class="va">Angline</span><span class="op">$</span><span class="va">dir.binned</span> <span class="op">&lt;-</span> <span class="va">dir.binned</span></span>
<span></span>
<span><span class="co"># sort angles</span></span>
<span><span class="va">df_sorted</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Angline</span><span class="op">$</span><span class="va">dir.binned</span>, <span class="va">Angline</span><span class="op">$</span><span class="va">Clusters</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df_sorted</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dir.binned"</span>,<span class="st">"Clusters"</span>,<span class="st">"nb"</span><span class="op">)</span></span>
<span><span class="va">df_sorted</span> <span class="op">=</span> <span class="va">df_sorted</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">df_sorted</span><span class="op">$</span><span class="va">dir.binned</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>We now create the trajectory rose. Angles
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
were calculated in 2D
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ω</mi><mi>δ</mi></mrow><annotation encoding="application/x-tex">\Omega \delta</annotation></semantics></math>
space
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi><mi>/</mi><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta 13C/\delta 15N</annotation></semantics></math>)
and represented by range
(15<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∘</mi><annotation encoding="application/x-tex">\circ</annotation></semantics></math>)
of direction. Bars size represent the number of trajectory segments (all
individual within each trajectory clusters).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df_sorted</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dir.binned</span>, y<span class="op">=</span><span class="va">nb</span>, fill<span class="op">=</span><span class="va">Clusters</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">110</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span>,<span class="fl">50</span>,<span class="fl">75</span>,<span class="fl">110</span><span class="op">)</span>, </span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span>,<span class="fl">50</span>,<span class="fl">75</span>,<span class="fl">110</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Trajectory segment directions within fur seals clusters'</span>, y <span class="op">=</span> <span class="st">'number of trajectory segments'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span>start <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">deg</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="ontogenic-stable-isotope-trajectories-of-juvenile-fishes">4. Ontogenic stable isotope trajectories of juvenile fishes<a class="anchor" aria-label="anchor" href="#ontogenic-stable-isotope-trajectories-of-juvenile-fishes"></a>
</h2>
<p>In this section, we illustrate how to calculate trajectory metrics to
characterize the ontogenic stable isotope trajectories of juvenile
fishes. In the following sections, we show how to use these metrics as
data to create a trajectory diagram.</p>
<div class="section level3">
<h3 id="loading-data">4.1 Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h3>
<p>We begin by loading the package dataset <code>pike</code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pike"</span><span class="op">)</span></span></code></pre></div>
<p>This is a data set from :</p>
<ul>
<li>Cucherousset, J., Paillisson, J.-M., Roussel, J.-M., 2013. Natal
departure timing from spatially varying environments is dependent of
individual ontogenetic status. <em>Naturwissenschaften</em> 100,
761–768.</li>
</ul>
<p>Briefly, Cucherousset et al. (2013) released 192 individually tagged,
hatchery-raised, juvenile pike (<em>Esox lucius</em> L.) with variable
initial trophic position (fin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi><mi>/</mi><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta13C/\delta15N</annotation></semantics></math>
values). Based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
values, individuals were classified into zooplanktivorous
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
&lt; 10 ‰) and piscivorous
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
&gt; 10 ‰) as cannibalism is commonly observed in this species.
Individuals were released in a temporarily flooded grassland where pike
eggs usually hatch of the Brière marsh (France) to identify the
determinants of juvenile natal departure. The release site was connected
through a unique point to an adjacent pond used as a nursery habitat.
Fish were continuously recaptured when migrating from flooded grassland
to adjacent pond. Recaptured individuals (n = 29) were anaesthetized,
checked for tags, measured for fork length, fin-clipped to quantify
changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
values, and released.</p>
</div>
<div class="section level3">
<h3 id="calculating-trajectory-metrics-and-identification-of-trajectory-clusters">4.2 Calculating trajectory metrics and identification of trajectory
clusters<a class="anchor" aria-label="anchor" href="#calculating-trajectory-metrics-and-identification-of-trajectory-clusters"></a>
</h3>
<p>First, we calculate net changes relative to the initial state for
each individual (i.e. the distance between stable isotope compositions
at release and at recapture):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Net_changes</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths2D</a></span><span class="op">(</span><span class="va">pike</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>,<span class="va">pike</span><span class="op">$</span><span class="va">ID</span>,<span class="va">pike</span><span class="op">$</span><span class="va">Time</span>, relativeToInitial<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Net_changes</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Net_changes"</span>, <span class="st">"Trajectory"</span><span class="op">)</span></span>
<span><span class="va">pike</span><span class="op">$</span><span class="va">Net_Changes</span><span class="op">&lt;-</span><span class="va">Net_changes</span><span class="op">$</span><span class="va">Net_changes</span></span></code></pre></div>
<p>Then, we can use function <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code> to conduct a
hierarchical clustering on the symmetric matrix <code>D</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">pike</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pike_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">D</span>, <span class="va">pike</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span><span class="va">Ds</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryComparison.html">trajectoryDistances</a></span><span class="op">(</span><span class="va">pike_x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span>,</span>
<span>                        symmetrization <span class="op">=</span> <span class="st">"mean"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We cut the dendrogram at height <code>Hst</code> to obtain a vector
of cluster membership and copy it in <code>pike</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hst</span><span class="op">=</span><span class="fl">3</span></span>
<span><span class="va">colstd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"yellow"</span>,<span class="st">"green"</span>,<span class="st">"blue"</span>,<span class="st">"grey"</span>,<span class="st">"red"</span><span class="op">)</span></span>
<span><span class="va">hsxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">Ds</span>, <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hsxy</span>,hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, main<span class="op">=</span><span class="st">"distance Pike"</span>, cex<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html" class="external-link">rect.hclust</a></span> <span class="op">(</span><span class="va">hsxy</span>, h<span class="op">=</span><span class="va">Hst</span>,</span>
<span>                border <span class="op">=</span> <span class="va">colstd</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store clusters into a new data column</span></span>
<span><span class="va">pike</span><span class="op">$</span><span class="va">Cluster</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">hsxy</span>, h<span class="op">=</span><span class="va">Hst</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trajectory-diagram-of-pike-released-in-the-flooded-grassland-and-recaptured-when-emigrating-into-the-adjacent-pond">4.3 Trajectory diagram of pike released in the flooded grassland and
recaptured when emigrating into the adjacent pond<a class="anchor" aria-label="anchor" href="#trajectory-diagram-of-pike-released-in-the-flooded-grassland-and-recaptured-when-emigrating-into-the-adjacent-pond"></a>
</h3>
<p>We prepare the data set to compute trajectory diagrams and density
curves:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pike1</span><span class="op">&lt;-</span><span class="va">pike</span><span class="op">[</span><span class="va">pike</span><span class="op">$</span><span class="va">Time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">Pike1</span><span class="op">&lt;-</span><span class="va">Pike1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">Pike1</span><span class="op">$</span><span class="va">ID</span>, decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">Pike1</span><span class="op">$</span><span class="va">Net_changes</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="va">Pike2</span><span class="op">&lt;-</span><span class="va">pike</span><span class="op">[</span><span class="va">pike</span><span class="op">$</span><span class="va">Time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2</span>,<span class="op">]</span></span>
<span><span class="va">Pike2</span><span class="op">&lt;-</span><span class="va">Pike2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">Pike2</span><span class="op">$</span><span class="va">ID</span>, decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">Pike2</span><span class="op">$</span><span class="va">Net_changes</span><span class="op">&lt;-</span><span class="va">Net_changes</span><span class="op">$</span><span class="va">Net_changes</span></span>
<span><span class="va">data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">Pike1</span>,<span class="va">Pike2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We create the trajectory diagram. Arrows represent trajectory path
for each pit-tagged individual. Colors correspond to trajectory
clusters. The dashed line separates piscivorous from zooplanktivorous
individuals [zooplanktivorous
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
&lt; 10) vs piscivorous
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
&gt; 10)].</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">d13C</span>,y<span class="op">=</span><span class="va">d15N</span>,shape<span class="op">=</span><span class="va">Trophic_status_initial</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">Net_changes</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">d13C</span>,y<span class="op">=</span><span class="va">d15N</span>,group<span class="op">=</span><span class="va">ID</span>,color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Cluster</span><span class="op">)</span><span class="op">)</span>,arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">10</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span><span class="op">*</span><span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">15</span><span class="op">*</span><span class="st">"N"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
<p>Density curves X represents the distribution of all samples according
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
values, and capture (green=release; red=departure):</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_dist_d13C</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">d13C</span>, fill<span class="op">=</span><span class="va">TimeL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> </span>
<span><span class="va">gg_dist_d13C</span> <span class="op">=</span> <span class="va">gg_dist_d13C</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span><span class="op">*</span><span class="st">"C"</span><span class="op">*</span><span class="st">" density"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d13C</span> <span class="op">=</span> <span class="va">gg_dist_d13C</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                    axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                    axis.line<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                    axis.ticks<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                    panel.background <span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d13C</span> <span class="op">=</span> <span class="va">gg_dist_d13C</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d13C</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">33</span>, <span class="op">-</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-19-1.png" width="384"></p>
<p>Density curves Y represents the distribution of all samples according
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
values, and capture (green=release; red=departure):</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_dist_d15N</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">d15N</span>, fill<span class="op">=</span><span class="va">TimeL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> </span>
<span><span class="va">gg_dist_d15N</span> <span class="op">=</span> <span class="va">gg_dist_d15N</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">15</span><span class="op">*</span><span class="st">"N"</span><span class="op">*</span><span class="st">" density"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d15N</span> <span class="op">=</span><span class="va">gg_dist_d15N</span> </span>
<span><span class="va">gg_dist_d15N</span> <span class="op">=</span><span class="va">gg_dist_d15N</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d15N</span> <span class="op">=</span><span class="va">gg_dist_d15N</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   axis.line<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   axis.ticks<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   panel.background <span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d15N</span> <span class="op">=</span><span class="va">gg_dist_d15N</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">gg_dist_d15N</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-20-1.png" width="384"></p>
</div>
</div>
<div class="section level2">
<h2 id="spatio-temporal-variability-of-delta-13c-and-delta-15n-modelled-isoscapes-in-the-northeast-pacific">5. Spatio-temporal variability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta 13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta 15N</annotation></semantics></math>
modelled isoscapes in the Northeast Pacific<a class="anchor" aria-label="anchor" href="#spatio-temporal-variability-of-delta-13c-and-delta-15n-modelled-isoscapes-in-the-northeast-pacific"></a>
</h2>
<p>In this section, we illustrate how to use trajectory metrics to
characterize the spatio-temporal variability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta 13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta 15N</annotation></semantics></math>
modelled isoscapes in the Northeast Pacific in an isoscape trajectory
map and a trajectory heat map</p>
<p>The datasets used in this application come from:</p>
<ul>
<li>Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.A., 2020.
Defining isoscapes in the Northeast Pacific as an index of ocean
productivity. Global Ecol Biogeogr 29, 246–261.</li>
</ul>
<p>Briefly, Espinasse et al. (2020) tested the application of isoscapes
modelled from satellite data to the description of secondary production
in the Northeast pacific. The output model fits in a 0.25° x 0.25°
spatial grid covering the region spanning from 46 to 62°N and from 195
to 235°E and supporting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
isoscapes from 1998 to 2017. We subset modelled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
values of a 1° x 1° spatial grid from the original modelled dataset.
Isoscapes modelled for 2013, 2015 and 2017 were selected as they were
characterised by high stable isotope dynamics and consequently
constitutes relevant inputs to test our isoscape trajectory map concept.
Additionally, a long-term SITA analysis was performed from 1998 to 2017
using directions and net changes calculated for all pairs of dates
(1998-1999,… ,2016-2017) as input for a trajectory heat map.</p>
<div class="section level3">
<h3 id="isoscape-trajectory-maps">5.1 2013-2015 Isoscape trajectory maps<a class="anchor" aria-label="anchor" href="#isoscape-trajectory-maps"></a>
</h3>
<p>We begin by loading the package dataset <code>isoscape</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"isoscape"</span><span class="op">)</span></span></code></pre></div>
<p>We calculate Segment lengths and Angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
for each stations to assess, respectively, the magnitude and the nature
of change in the stable isotope space between 2013 and 2015. We then
prepare a data set to compute the isoscape trajectory map with notably:
Latitude, Longitude, Years, Angles and segment lenghts values:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span><span class="op">&lt;-</span><span class="va">isoscape</span><span class="op">$</span><span class="va">station</span></span>
<span><span class="va">surveys</span><span class="op">&lt;-</span><span class="va">isoscape</span><span class="op">$</span><span class="va">Year</span></span>
<span><span class="va">Angl</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryAngles2D</a></span><span class="op">(</span><span class="va">isoscape</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">sites</span>,<span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Length</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/trajectoryMetrics.html">trajectoryLengths2D</a></span><span class="op">(</span><span class="va">isoscape</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">sites</span>,<span class="va">surveys</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">isoscape</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">489</span>,<span class="op">]</span>,<span class="va">Angl</span>,<span class="va">Length</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Latitude"</span>,<span class="st">"Longitude"</span>,<span class="st">"d13C"</span>,<span class="st">"d15N"</span>,<span class="st">"Stations"</span>,<span class="st">"Years"</span>,<span class="st">"Angles"</span>,<span class="st">"Lengths"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Latitude Longitude      d13C     d15N Stations Years    Angles    Lengths</span></span>
<span><span class="co">## 1       46       195 -24.24369 5.267485        1  2013 210.45063 0.31556226</span></span>
<span><span class="co">## 2       48       195 -24.32212 4.973764        3  2013 279.70681 0.28077863</span></span>
<span><span class="co">## 3       49       195 -24.28151 5.113458        4  2013 188.55168 0.03490337</span></span>
<span><span class="co">## 4       50       195 -24.30105 5.261582        5  2013 147.84429 0.25570108</span></span>
<span><span class="co">## 5       51       195 -24.05084 5.302065        6  2013 126.14883 0.32439073</span></span>
<span><span class="co">## 6       52       195 -23.92968 5.407169        7  2013  60.21061 0.28423495</span></span></code></pre>
<p>Angles
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
need to be transformed for the use with <code>geom_spoke</code>. We then
add transformed values in a new column <code>Angles2</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">angle</span><span class="op">&lt;-</span><span class="va">data</span><span class="op">$</span><span class="va">Angles</span></span>
<span><span class="va">Angles2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">angle</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Angles2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span>,<span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">270</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">180</span>,<span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">270</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">90</span>,<span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">270</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                                       <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">270</span>,<span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">270</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                                              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">==</span><span class="fl">360</span>,<span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">270</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,  </span>
<span>                                                     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">90</span> ,<span class="op">(</span><span class="fl">90</span><span class="op">-</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                                                            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">90</span> <span class="op">&amp;</span> <span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">180</span> ,<span class="op">(</span><span class="fl">90</span><span class="op">-</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                                                                   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">180</span> <span class="op">&amp;</span> <span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">270</span>,<span class="op">(</span><span class="fl">180</span><span class="op">+</span><span class="op">(</span><span class="fl">270</span><span class="op">-</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,</span>
<span>                                                                          <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">270</span> <span class="op">&amp;</span> <span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">360</span>,<span class="op">(</span><span class="fl">90</span><span class="op">+</span><span class="op">(</span><span class="fl">360</span><span class="op">-</span><span class="va">angle</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span>,<span class="st">"ERROR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">Angles2</span><span class="op">&lt;-</span><span class="va">Angles2</span></span></code></pre></div>
<p>We now create the Isoscape trajectory map. In this kind of map,
Segment lengths and Angles
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
are mapped to illustrate stable isotope spatio-temporal dynamics.
Direction of arrows (angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
illustrate direction (i.e. the nature of change) in the modelled 2D
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ω</mi><mi>δ</mi></mrow><annotation encoding="application/x-tex">\Omega \delta</annotation></semantics></math>
space according to increase and/or decrease in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
values (0-90°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
90-180°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
90-180°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
180-270°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>).
Length of arrows and colored background rasters illustrate modelled
trajectory segment length at each station (i.e. the magnitude of
change).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Longitude</span>, </span>
<span>              y <span class="op">=</span> <span class="va">Latitude</span>, </span>
<span>              fill <span class="op">=</span> <span class="va">Lengths</span>, </span>
<span>              angle <span class="op">=</span> <span class="va">Angles2</span>, </span>
<span>              radius <span class="op">=</span> <span class="fu">rescale</span><span class="op">(</span><span class="va">Lengths</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>interpolate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_spoke.html" class="external-link">geom_spoke</a></span><span class="op">(</span>arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.07</span>, <span class="st">'inches'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlBu"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span>, </span>
<span>        legend.direction <span class="op">=</span> <span class="st">'horizontal'</span>,</span>
<span>        panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-23-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="trajectory-heatmap">5.2 1998-2017 trajectory heatmap<a class="anchor" aria-label="anchor" href="#trajectory-heatmap"></a>
</h3>
<p>We begin by loading the package dataset <code>heatmapdata</code>:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"heatmapdata"</span><span class="op">)</span></span></code></pre></div>
<p><code>heatmapdata</code> is composed of trajectory metrics for all
stations within all inter-annual consecutive periods between 1998 and
2017:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">heatmapdata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Latitude Longitude      d13C     d15N Stations     Years    Angles    Lengths</span></span>
<span><span class="co">## 1       46       195 -24.76366 5.451872        1 1998-1999 181.31874 0.30196921</span></span>
<span><span class="co">## 2       47       195 -24.75540 5.334980        2 1998-1999 213.76898 0.09285079</span></span>
<span><span class="co">## 3       48       195 -24.51122 5.382608        3 1998-1999 183.00600 0.24017740</span></span>
<span><span class="co">## 4       49       195 -24.46314 5.481623        4 1998-1999 169.30735 0.34248078</span></span>
<span><span class="co">## 5       50       195 -24.27419 5.893179        5 1998-1999 174.57293 0.81250282</span></span>
<span><span class="co">## 6       51       195 -24.19454 5.780701        6 1998-1999  13.28445 0.96866737</span></span>
<span><span class="co">##     Angles2</span></span>
<span><span class="co">## 1  4.689373</span></span>
<span><span class="co">## 2  4.123009</span></span>
<span><span class="co">## 3  4.659924</span></span>
<span><span class="co">## 4 -1.384174</span></span>
<span><span class="co">## 5 -1.476076</span></span>
<span><span class="co">## 6  1.338939</span></span></code></pre>
<p>We then prepare the data set to create the trajectory heat map. We
create a vector of direction, ranging by 15° between 0 and 360°, to
class Angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
values. We create the vector <code>ISPattern</code> to characterize the
pattern of direction according to changes in both stable isotope values
(0-90°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
90-180°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
90-180°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
180-270°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#direction range</span></span>
<span><span class="va">deg</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="va">dir.breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">30</span>,<span class="fl">45</span>,<span class="fl">60</span>,<span class="fl">75</span>,<span class="fl">90</span>,<span class="fl">105</span>,<span class="fl">120</span>,<span class="fl">135</span>,<span class="fl">150</span>,<span class="fl">165</span>,<span class="fl">180</span>,<span class="fl">195</span>,<span class="fl">210</span>,<span class="fl">225</span>,<span class="fl">240</span>,<span class="fl">255</span>,<span class="fl">270</span>,<span class="fl">285</span>,<span class="fl">300</span>,<span class="fl">315</span>,<span class="fl">330</span>,<span class="fl">345</span>,<span class="fl">360</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dir.binned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">heatmapdata</span><span class="op">$</span><span class="va">Angles</span>,</span>
<span>                  breaks <span class="op">=</span> <span class="va">dir.breaks</span>,</span>
<span>                  ordered_result <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bar labels</span></span>
<span><span class="va">dir.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">-</span><span class="va">deg</span>, by <span class="op">=</span> <span class="va">deg</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dir.binned</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dir.labels</span></span>
<span></span>
<span><span class="va">heatmapdata</span><span class="op">$</span><span class="va">dir.binned</span> <span class="op">&lt;-</span> <span class="va">dir.binned</span></span>
<span></span>
<span><span class="va">data</span><span class="op">&lt;-</span><span class="va">heatmapdata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#direction vs SI patterns</span></span>
<span><span class="va">data</span><span class="op">&lt;-</span><span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">dir.binned</span>, decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">:</span><span class="fl">9206</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">ISpattern</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"+d13C/+d15N"</span>,<span class="fl">2862</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"+d13C/-d15N"</span>,<span class="fl">1840</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"-d13C/-d15N"</span>,<span class="fl">2931</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"-d13C/+d15N"</span>,<span class="fl">1573</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">dir.binned</span>,<span class="va">data</span><span class="op">$</span><span class="va">Years</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">Lengths</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">dir.binned</span>, <span class="va">data</span><span class="op">$</span><span class="va">Years</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">sum</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">data2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> </span>
<span></span>
<span></span>
<span><span class="va">data1</span><span class="op">$</span><span class="va">Lengths</span><span class="op">&lt;-</span><span class="va">data2</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">dfa</span><span class="op">&lt;-</span><span class="va">data1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfa</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Directions"</span>,<span class="st">"Periods"</span>,<span class="st">"Nb_stations"</span>,<span class="st">"Lengths"</span><span class="op">)</span></span></code></pre></div>
<p>The final dataset used to create the trajectory heat map is composed
of four variables (“Directions”,“Periods”,“Nb_stations”,“Lengths”):</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dfa</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Directions   Periods Nb_stations   Lengths</span></span>
<span><span class="co">## 1          0 1998-1999          12  8.634497</span></span>
<span><span class="co">## 2         15 1998-1999           9 11.096406</span></span>
<span><span class="co">## 3         30 1998-1999           7  7.927697</span></span>
<span><span class="co">## 4         45 1998-1999           8 11.138909</span></span>
<span><span class="co">## 5         60 1998-1999           4  1.861980</span></span>
<span><span class="co">## 6         75 1998-1999           4  1.835733</span></span></code></pre>
<p>We plot trajectory metrics with respect to period and direction in a
trajectory heat map. Angles
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
in the modelled 2D
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ω</mi><mi>δ</mi></mrow><annotation encoding="application/x-tex">\Omega \delta</annotation></semantics></math>
space exhibited by all stations within all pairs of dates
(1998-1999,…,2016-2017) are represented by range of direction (15°)
according to period. Color gradient from dark blue to yellow indicate
the number of stations exhibited by a given range of direction within a
given period.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfa</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Periods</span>, <span class="va">Directions</span>, fill<span class="op">=</span> <span class="va">Nb_stations</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis</span><span class="op">(</span>discrete<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>, angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-27-1.png" width="576"></p>
<p>The X bar plot represents the sum of segment lengths across stations
and times, 1231 exhibiting the chosen angle. The blue gradient indicates
the net change magnitude.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df.Xbarplot</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">Lengths</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">Periods</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df.Xbarplot</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Periods"</span>,<span class="st">"Lengths"</span><span class="op">)</span></span>
<span><span class="va">bp.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df.Xbarplot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Periods</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>,angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span>, </span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Periods"</span><span class="op">)</span></span>
<span><span class="va">bp.x</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-28-1.png" width="480"></p>
<p>The Y bar plot represents the overall net changes according to range
of directions (angle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>).
Bars are colored according to increase and/or decrease in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
values (Pink: 0-90°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>
; Blue: 90-180°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
Red: 90-180°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>;
Green: 180-270°: +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>13</mn><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta13C</annotation></semantics></math>
and -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mn>15</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">\delta15N</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df.Ybarplot</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">Lengths</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">Directions</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df.Ybarplot</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Directions"</span>,<span class="st">"Lengths"</span><span class="op">)</span></span>
<span><span class="va">df.Ybarplot</span><span class="op">$</span><span class="va">ISpattern</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"+d13C/+d15N"</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"+d13C/-d15N"</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"-d13C/-d15N"</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"-d13C/+d15N"</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bp.y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df.Ybarplot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Directions</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Lengths</span>,fill <span class="op">=</span> <span class="va">ISpattern</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bp.y</span></span></code></pre></div>
<p><img src="SITA_files/figure-html/unnamed-chunk-29-1.png" width="384"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Djeghri, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
