[{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"about-this-vignette","dir":"Articles","previous_headings":"","what":"1. About this vignette","title":"Introduction to Ecological Quality Assessment (EQA)","text":"vignette present ecological applications used Sturbois et al. (review) presentation Ecological Quality Assessment (EQA) framework. vignette illustrates conduct Ecological Quality Assessement state-based trajectory-based variants, presentation results graphically. two data sets used vignette included ecotraj package reproducibility.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"loading-libraries","dir":"Articles","previous_headings":"","what":"2. Loading libraries","title":"Introduction to Ecological Quality Assessment (EQA)","text":"First , load libraries required examples, including ecotraj:","code":"#loading libraries library(ecotraj) ## Loading required package: Rcpp library(vegan) ## Loading required package: permute ## Loading required package: lattice ## This is vegan 2.6-6.1 library(vegclust) library(ape) library(ggplot2) library(reshape2)"},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"context","dir":"Articles","previous_headings":"3. Heathland conservation status in Landes et Marais de Glomel","what":"3.1 Context","title":"Introduction to Ecological Quality Assessment (EQA)","text":"nature reserve Landes et Marais de Glomel (Brittany, France) composed temperate Atlantic wet heaths whose reference state commonly considered dominated plant communities associated acid, nutrient poor soils least seasonally water logged dominated Erica tetralix E. ciliaris. habitat considered community interest part European directive conservation natural habitats wild fauna flora (97/62/CEE). definition reference envelope, surveys integrated variability reference states youngest early senescent stages, based expert assessment respect European Directive (97/62/CEE) requirements.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"loading-data","dir":"Articles","previous_headings":"3. Heathland conservation status in Landes et Marais de Glomel","what":"3.2 Loading data","title":"Introduction to Ecological Quality Assessment (EQA)","text":"data set consists 23 rows (stations) 46 columns (species). percent cover values derived Braun-Blanquet ordinal scale estimated 43 species vascular plants. first five stations (rows) used define reference envelope, next 18 stations (rows) conservation status assessed.","code":"data(glomel) #Showing a first lines /columns subset head(glomel[,1:8]) ##    ID   Ref Calluna vulgaris Erica ciliaris Erica tetralix Ulex gallii ## 2  1A  TRUE             17.5              1           37.5        17.5 ## 4  1B  TRUE              5.0              0           37.5         5.0 ## 6  1C  TRUE              0.0              0           17.5        37.5 ## 8  5A  TRUE             37.5              0           17.5         5.0 ## 10 13  TRUE             37.5              0           17.5         1.0 ## 12  2 FALSE              5.0              0           37.5         5.0 ##    Molinia caerulea Betula pubescens ## 2              37.5              1.0 ## 4              37.5              0.0 ## 6              37.5              0.0 ## 8              37.5              0.5 ## 10             37.5              5.0 ## 12             37.5              1.0"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"ecological-quality-assessment","dir":"Articles","previous_headings":"3. Heathland conservation status in Landes et Marais de Glomel","what":"3.3 Ecological Quality Assessment","title":"Introduction to Ecological Quality Assessment (EQA)","text":"first create compositional data matrix, extracting species data initial data table: Using compositional data, can use function vegdist() package vegan calculate Bray Curtis distances ecosystem states: distance matrix glomel_bc defines multivariate space represents ressemblance ecological states. conduct EQA, also need define conservation targets. Column Ref glomel identifies stations considered reference. define state reference envelope using reference station IDs follows: now ready compare assessed stations respect state reference envelope using function compareToStateEnvelope(): Function compareToStateEnvelope returns SquaredDist, squared distance envelope centroid, Q statistic, defines quality tested stations comprised 0 1. can transform values qualitative assessment using: assessment 18 tested stations :","code":"glomel_comp <- as.matrix(glomel[,!(names(glomel) %in% c(\"ID\", \"Ref\"))]) rownames(glomel_comp) <- glomel$ID  dim(glomel_comp) ## [1] 23 43 glomel_bc <- vegan::vegdist(glomel_comp, method = \"bray\") glomel_env <- glomel$ID[glomel$Ref] glomel_assess <- compareToStateEnvelope(glomel_bc, glomel_env, m=1.7, distances_to_envelope = TRUE) head(glomel_assess) ##   Observation Envelope SquaredDist         Q ## 1          1A     TRUE  0.03790333 1.0000000 ## 2          1B     TRUE  0.07132734 0.8314306 ## 3          1C     TRUE  0.08877350 0.6846406 ## 4          5A     TRUE  0.04364347 1.0000000 ## 5          13     TRUE  0.06748066 0.8701426 ## 6           2    FALSE  0.08788512 0.6911247 glomel_assess$Status<-c(ifelse(glomel_assess$Q>=0.5,\"Inside\", \"Oustside\")) glomel_assess[!glomel_assess$Envelope,] ##    Observation Envelope SquaredDist          Q   Status ## 6            2    FALSE  0.08788512 0.69112475   Inside ## 7           3A    FALSE  0.10690364 0.57054500   Inside ## 8           3B    FALSE  0.03193706 1.00000000   Inside ## 9           3C    FALSE  0.10365540 0.58868886   Inside ## 10          5B    FALSE  0.12638739 0.47819512 Oustside ## 11          6A    FALSE  0.32161421 0.15285304 Oustside ## 12          6C    FALSE  0.11525495 0.52775487   Inside ## 13          6D    FALSE  0.39062446 0.11797552 Oustside ## 14          7A    FALSE  0.30326686 0.16512832 Oustside ## 15          8A    FALSE  0.17386576 0.33227568 Oustside ## 16          8B    FALSE  0.20163739 0.27768273 Oustside ## 17          8C    FALSE  0.45790315 0.09515562 Oustside ## 18           9    FALSE  0.21340883 0.25886134 Oustside ## 19          10    FALSE  0.07104764 0.83415862   Inside ## 20          11    FALSE  0.08829721 0.68810525   Inside ## 21          12    FALSE  0.03390049 1.00000000   Inside ## 22         14A    FALSE  0.08051443 0.74876145   Inside ## 23         14B    FALSE  0.21297195 0.25952180 Oustside"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"representing-eqa-results-graphically","dir":"Articles","previous_headings":"3. Heathland conservation status in Landes et Marais de Glomel","what":"3.4 Representing EQA results graphically","title":"Introduction to Ecological Quality Assessment (EQA)","text":"represent results graphical way, start conducting Principal Coordinates Analysis (PCoA) using package ape: can use function biplot() package ape show ordination stations species projected arrows:  generate different representation, first get coordinates stations two first dimensions PCoA copy assessment data frame: use package ggplot achieve nicer representation assessment. Symbol colors used illustrate stations achieve conservation objectives (green) achieve (red). size dots represents squared distance centroid state reference envelope:","code":"pcoa_glom<-ape::pcoa(glomel_bc) biplot(pcoa_glom, glomel_comp) PCOA_DIM1_2 <- pcoa_glom[[\"vectors\"]][,1:2] glomel_assess$Dim1<-PCOA_DIM1_2[,1] glomel_assess$Dim2<-PCOA_DIM1_2[,2]  head(glomel_assess) ##   Observation Envelope SquaredDist         Q Status       Dim1        Dim2 ## 1          1A     TRUE  0.03790333 1.0000000 Inside -0.2185262  0.05500827 ## 2          1B     TRUE  0.07132734 0.8314306 Inside -0.1897143  0.19276850 ## 3          1C     TRUE  0.08877350 0.6846406 Inside -0.1123913  0.02290741 ## 4          5A     TRUE  0.04364347 1.0000000 Inside -0.1842064 -0.14315651 ## 5          13     TRUE  0.06748066 0.8701426 Inside -0.1594965 -0.17397305 ## 6           2    FALSE  0.08788512 0.6911247 Inside -0.1840068  0.20520893 p<-ggplot(glomel_assess,           mapping=aes(x=Dim1,y=Dim2,size=SquaredDist, color=Status, shape=Status))+   geom_point()+   scale_colour_manual(values=c(\"#00BFC4\", \"#F8766D\"))+   geom_text(glomel_assess,              mapping=aes(x=Dim1,y=Dim2,label=Observation),             hjust=-0.3, vjust=-0.3,size=2.5, color=\"Black\")+   xlab(expression(\"PCoA1 (27.7%)\"))+   ylab(expression(\"PCoA2 (13.7%)\"))  p<-p + theme_minimal()+   theme(     # Hide some graphical elements     panel.border = element_blank(),     panel.grid.major = element_blank(),     panel.grid.minor = element_blank(),     axis.line = element_line(colour = \"black\"))  p"},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"context-1","dir":"Articles","previous_headings":"4. Impact of fishing activities on marine habitats","what":"4.1 Context","title":"Introduction to Ecological Quality Assessment (EQA)","text":"used experimental data set built Tauran et al. (2020) study impact fishing dredges varying fishing pressures maerl beds, bay Brest (Brittany, France). study follows --Control-Impact design (Stewart-Oaten et al., 1986). Briefly, three control stations surveyed compared five treatment stations characterized different fishing dredges pressure levels (Tauran et al., 2020). Three fishing dredges compared: (1) clam dredge (CD), 70 90 kg, 1.5 m wide, 40 teeth 11 cm ; (2) queen scallop dredge (QSD), 120 kg,1.8 m wide, blade; (3) king scallop dredge (KSD), 190 kg, 1.8 m wide, 18 teeth 10 cm every 9 cm. Pressure levels measured number dredge tows performed zone experimental dredging session: 0 (.e. control), 10, 30 dredge tows. Samples collected April 2016 April2017. Session 1 sampled just experimental dredging (t0); session 2 t0 + 1 week; session 3 t0 + 1 month session 4 t0 + 12 months. Nine replicates sampled treatments sessions Smith-McIntyre grab (0.1m2). Abundance data pooled treatment levels (.e. CTRL1, CTRL2, CTRL3, KSD_10, CD_10, CD_30, QSD_10 QSD_30; Appendix_D).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"loading-data-1","dir":"Articles","previous_headings":"4. Impact of fishing activities on marine habitats","what":"4.2 Loading data","title":"Introduction to Ecological Quality Assessment (EQA)","text":"data set 32 observations (.e. treatments*surveys) 250 species. begin loading data:","code":"data(glenan) #Showing a first lines /columns subset head(glenan[,1:6]) ##          Abundance.Abludomelita gladiosa Abundance.Abra alba ## CD_10-S1                              60                  15 ## CD_10-S2                              54                  14 ## CD_10-S3                              42                  15 ## CD_10-S4                              45                   8 ## CD_30-S1                              58                  18 ## CD_30-S2                              39                  19 ##          Abundance.Acanthochitona fascicularis Abundance.Achelia hispida ## CD_10-S1                                     2                         0 ## CD_10-S2                                     1                         0 ## CD_10-S3                                     0                         0 ## CD_10-S4                                     0                         0 ## CD_30-S1                                     4                         0 ## CD_30-S2                                     3                         0 ##          Abundance.Alcyonidium diaphanum Abundance.Alentia gelatinosa ## CD_10-S1                               0                            1 ## CD_10-S2                               0                            0 ## CD_10-S3                               0                            0 ## CD_10-S4                               0                            0 ## CD_30-S1                               0                            0 ## CD_30-S2                               0                            0"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"definition-of-the-ressemblance-space","dir":"Articles","previous_headings":"4. Impact of fishing activities on marine habitats","what":"4.3 Definition of the ressemblance space","title":"Introduction to Ecological Quality Assessment (EQA)","text":"separate columns identify treatment surveys. also extract compositional data log-transform initially performed Tauran et al. (2020). Using compositional data, can use function vegdist() package vegan calculate Bray Curtis distances ecosystem states: Like first example, distance matrix grab_bc defines multivariate space represents ressemblance ecological states maerl beds.","code":"#vector Treatment Treatment<-glenan$Treatment  #vector Surveys Surveys<-glenan$Surveys #log transformation grab_comp<-log1p(glenan[,-c(251:252)]) grab_bc <- vegan::vegdist(grab_comp, method = \"bray\")"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"state-based-eqa","dir":"Articles","previous_headings":"4. Impact of fishing activities on marine habitats","what":"4.4 State-based EQA","title":"Introduction to Ecological Quality Assessment (EQA)","text":"addition resemblance space, conduct EQA need define conservation targets. case, define states conforming state reference envelope manually among observation IDs: now ready compare assessed stations respect state reference envelope using function compareToStateEnvelope(): derive qualitative assessment: , can represent results state-based EQA two first dimensions Principal Coordinates Analysis:  Since dealing temporal data, can create bar plot showing evolution squared distance centroid state reference envelope study period treatment:  addition, can create heatmap showing evolution distance control dredged stations experimentation:","code":"#Definition of the state reference envelope ID<-rownames(grab_comp) grab_env <- ID[c(1,9:20,21,25,29)] #Comparing assessed stations with respect to the state reference envelope grab_assess <- compareToStateEnvelope(grab_bc, grab_env, m=1.5,                                        distances_to_envelope = TRUE) grab_assess$Status<-c(ifelse(grab_assess$Q>=0.5,\"Inside\", \"Outside\"))  grab_assess$Status[c(1,9:20,21,25,29)]<-\"Reference\"  grab_assess$Status<- factor(grab_assess$Status, levels = c(\"Reference\",\"Inside\",\"Outside\"))  head(grab_assess) ##   Observation Envelope SquaredDist         Q    Status ## 1    CD_10-S1     TRUE  0.03374086 0.5587631 Reference ## 2    CD_10-S2    FALSE  0.02316547 0.9025909    Inside ## 3    CD_10-S3    FALSE  0.04174879 0.4041249   Outside ## 4    CD_10-S4    FALSE  0.03802341 0.4677650   Outside ## 5    CD_30-S1    FALSE  0.02940983 0.6757536    Inside ## 6    CD_30-S2    FALSE  0.04151217 0.4078031   Outside #Get coordinates of stations in the two first dimensions of the PCoA pcoa<-pcoa(grab_bc) PCOA_DIM1_2<-pcoa[[\"vectors\"]][,1:2] grab_assess$Dim1<-PCOA_DIM1_2[,1] grab_assess$Dim2<-PCOA_DIM1_2[,2]  #Information about Treatment and Surveys  grab_assess$Treatment<-Treatment grab_assess$Surveys<-Surveys   p<-ggplot(grab_assess, aes(x=Dim1, y=Dim2, group=Status)) +   geom_point(aes(shape=Status, color=Status, size=SquaredDist))+   scale_shape_manual(values=c(1, 16, 17))+   scale_color_manual(values=c(\"#00BFC4\", \"#00BFC4\", \"#F8766D\"))+   geom_path(aes(x=Dim1,y=Dim2,group=Treatment),color=\"grey\", arrow = arrow(length = unit(0.03, \"cm\")))+   geom_text(grab_assess,mapping=aes(x=Dim1,y=Dim2,label=ID),hjust=-0.3, vjust=-0.3,size=2.5, color=\"Black\")+   xlab(expression(\"PCoA1 (13.3%)\"))+   ylab(expression(\"PCoA2 (9.9%)\"))  p<-p+ theme_minimal()+   theme(     # Hide some graphical elements     panel.border = element_blank(),     panel.grid.major = element_blank(),     panel.grid.minor = element_blank(),     axis.line = element_line(colour = \"black\"))  p grab_assess$Treatment<-factor(grab_assess$Treatment,c(\"CTRL1\",\"CTRL2\",\"CTRL3\",                                                       \"CD_10\",\"CD_30\",                                                        \"QSD_10\",\"QSD_30\",                                                       \"KSD_10\")) grab_assess$Status<-c(ifelse(grab_assess$Q>=0.5,\"Inside\", \"Outside\")) grab_assess$Status<- factor(grab_assess$Status, levels = c(\"Inside\",\"Outside\"))  ggplot(grab_assess, aes(x=Surveys, y=SquaredDist, color=Status, fill=Status)) +    geom_bar(stat = \"identity\",width=0.5)+   scale_colour_manual(values=c(\"#00BFC4\", \"#F8766D\"))+   scale_fill_manual(values=c(\"#00BFC4\", \"#F8766D\"))+   scale_y_continuous(\"Squared distance to the reference envelope\")+   theme_minimal()+   facet_wrap(~Treatment)+   theme(axis.text.x = element_text(angle=90)) grabbc_sel <- melt(as.matrix(grab_bc),rnames = c(\"row\", \"col\"))  #selection of the observation of interest (i.e. control stations for heat map row, and dredged stations for heat map column) grabbc_sel<-grabbc_sel[!grabbc_sel$Var2 %in% c(\"CTRL1-S1\",\"CTRL2-S1\",\"CTRL3-S1\",\"CTRL4-S1\",                                                 \"CTRL1-S2\",\"CTRL2-S2\",\"CTRL3-S2\",\"CTRL4-S2\",                                                 \"CTRL1-S3\",\"CTRL2-S3\",\"CTRL3-S3\",\"CTRL4-S3\",                                                 \"CTRL1-S4\",\"CTRL2-S4\",\"CTRL3-S4\",\"CTRL4-S4\"),]     grabbc_sel<-grabbc_sel[grabbc_sel$Var1 %in% c(\"CTRL1-S1\",\"CTRL2-S1\",\"CTRL3-S1\",\"CTRL4-S1\",                                                \"CTRL1-S2\",\"CTRL2-S2\",\"CTRL3-S2\",\"CTRL4-S2\",                                                \"CTRL1-S3\",\"CTRL2-S3\",\"CTRL3-S3\",\"CTRL4-S3\",                                                \"CTRL1-S4\",\"CTRL2-S4\",\"CTRL3-S4\",\"CTRL4-S4\"),]  grabbc_sel$Var1<-factor(grabbc_sel$Var1,                         c(\"CTRL1-S1\",\"CTRL2-S1\",\"CTRL3-S1\",\"CTRL4-S1\",                           \"CTRL1-S2\",\"CTRL2-S2\",\"CTRL3-S2\",\"CTRL4-S2\",                           \"CTRL1-S3\",\"CTRL2-S3\",\"CTRL3-S3\",\"CTRL4-S3\",                           \"CTRL1-S4\",\"CTRL2-S4\",\"CTRL3-S4\",\"CTRL4-S4\"))  grabbc_sel$Var2<-factor(grabbc_sel$Var2,                         c(\"KSD_10-S1\",\"CD_10-S1\",\"CD_30-S1\",\"QSD_10-S1\",\"QSD_30-S1\",                           \"KSD_10-S2\",\"CD_10-S2\",\"CD_30-S2\",\"QSD_10-S2\",\"QSD_30-S2\",                           \"KSD_10-S3\",\"CD_10-S3\",\"CD_30-S3\",\"QSD_10-S3\",\"QSD_30-S3\",                           \"KSD_10-S4\",\"CD_10-S4\",\"CD_30-S4\",\"QSD_10-S4\",\"QSD_30-S4\"))  ggplot(grabbc_sel, aes(x=Var2, y=Var1, fill=value)) +    geom_raster() +    scale_fill_viridis_c()+   theme(axis.text.x=element_text(angle = 90, hjust = 0))"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"trajectory-based-eqa","dir":"Articles","previous_headings":"4. Impact of fishing activities on marine habitats","what":"4.5 Trajectory-based EQA","title":"Introduction to Ecological Quality Assessment (EQA)","text":"One nice features EQA possibility conduct quality assessment taking account ecosystem dynamics. case, conservation target defined set trajectories conforming trajectory reference envelope, case three control stations: now ready compare assessed trajectories (subject treatment) respect trajectory reference envelope using function compareToTrajectoryEnvelope(): , can create bar plot showing squared distance centroid trajectory reference envelope study period treatment:","code":"#Definition of the trajectory reference envelope  grab_dynenv<-c(\"CTRL1\",\"CTRL2\",\"CTRL3\") ##Comparing assessed trajectories with respect to the trajectory reference envelope grab_dynassess <- compareToTrajectoryEnvelope(grab_bc,Treatment, grab_dynenv,                                                m=1.5, distances_to_envelope = TRUE) grab_dynassess$Treatment<-factor(grab_dynassess$Site,c(\"CTRL1\",\"CTRL2\",\"CTRL3\",                                                       \"CD_10\",\"CD_30\",                                                        \"QSD_10\",\"QSD_30\",                                                       \"KSD_10\")) grab_dynassess$Status<-c(ifelse(grab_dynassess$Q>=0.5,\"Inside\", \"Outside\")) grab_dynassess$Status<- factor(grab_dynassess$Status, levels = c(\"Inside\",\"Outside\"))  ggplot(grab_dynassess, aes(x=reorder(Treatment, SquaredDist),                             y=SquaredDist, color=Status, fill=Status)) +    geom_bar(stat = \"identity\",width=0.5)+   scale_colour_manual(values=c(\"#00BFC4\", \"#F8766D\"))+   scale_fill_manual(values=c(\"#00BFC4\", \"#F8766D\"))+   scale_y_continuous(\"Squared distance to the reference envelope\")+   theme_minimal()+   theme(axis.text.x = element_text(angle=90))"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.html","id":"references","dir":"Articles","previous_headings":"","what":"5. References","title":"Introduction to Ecological Quality Assessment (EQA)","text":"Sturbois, ., De Cáceres, M., Bifolchi, ., Bioret, F., Boyé, ., Gauthier, O., Grall, J., Grémare, ., Labrune, C., Robert, ., Schaal, G., Desroy, N. (2023). Ecological Quality Assessment: general multivariate framework report quality ecosystems dynamics respect reference conditions. Ecosphere. Tauran, ., Dubreuil, J., Guyonnet, B., Grall, J., 2020. Impact fishing gears fishing intensities maerl beds: experimental approach. Journal Experimental Marine Biology Ecology 533, 151472. https://doi.org/10.1016/j.jembe.2020.151472","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"what-is-ecological-trajectory-analysis","dir":"Articles","previous_headings":"1. Introduction","what":"1.1 What is Ecological Trajectory Analysis?","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"Ecological Trajectory Analysis (ETA) framework analyze ecosystem dynamics described trajectories chosen space ecosystem resemblance. ETA takes trajectories objects analyzed compared geometrically. framework presented community ecology : De Cáceres M, Coll L, Legendre P, et al (2019) Trajectory analysis community ecology. Ecol Monographs 89:e01350. https://doi.org/10.1002/ecm.1350. framework extended new metrics visualisation modes : Sturbois, ., De Cáceres, M., Sánchez-Pinillos, M., Schaal, G., Gauthier, O., Le Mao, P., Ponsero, ., & Desroy, N. (2021). Extending community trajectory analysis : New metrics representation. Ecological Modelling 440: 109400. https://doi.org/10.1016/j.ecolmodel.2020.109400. Procedures trajectory analysis can applied data beyond community data tables. reason now call framework ‘Ecological Trajectory Analysis’ provide package ecotraj offers set functions calculate metrics produce plots.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"about-this-vignette","dir":"Articles","previous_headings":"1. Introduction","what":"1.2 About this vignette","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"vignette learn conduct ETA using different package functions. First , load ecotraj:","code":"library(ecotraj) ## Loading required package: Rcpp"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"simple-example","dir":"Articles","previous_headings":"","what":"2. Simple example","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"section describe study trajectories three sites surveyed four times . use small dataset trajectories occur space two dimensions, geometric calculations can followed easily.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"trajectory-data","dir":"Articles","previous_headings":"2. Simple example","what":"2.1 Trajectory data","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"specify ecosystem dynamics, need three data items: set ecosystem states (.e. coordinates space Ω\\Omega), described using distance matrix dd; vector specifying site (.e. sampling unit) corresponding ecosystem state; vector specifying survey (.e. time point) corresponding sampling ecosystem state. CTA, sampling units need surveyed synchronously number times. However, example assume three sites surveyed synchronously four times. Let us first define vectors describe site survey ecosystem state: define matrix whose coordinates correspond set ecosystem states observed. number rows matrix equal length vectors sites surveys. assume ecosystem space Ω\\Omega two dimensions: matrix Euclidean distances dd ecosystem states Ω\\Omega : CTA based analysis information distance matrix Δ=[d]\\Delta = [d]. Therefore, require explicit coordinates. advantage allows analysis conducted arbitrary metric (semi-metric) spaces. choice dd left user depend problem hand.","code":"#Description of sites and surveys sites = c(1,1,1,1,2,2,2,2,3,3,3,3) surveys=c(1,2,3,4,1,2,3,4,1,2,3,4) #Raw data table xy<-matrix(0, nrow=12, ncol=2) xy[2,2]<-1 xy[3,2]<-2 xy[4,2]<-3 xy[5:6,2] <- xy[1:2,2] xy[7,2]<-1.5 xy[8,2]<-2.0 xy[5:6,1] <- 0.25 xy[7,1]<-0.5 xy[8,1]<-1.0 xy[9:10,1] <- xy[5:6,1]+0.25 xy[11,1] <- 1.0 xy[12,1] <-1.5 xy[9:10,2] <- xy[5:6,2] xy[11:12,2]<-c(1.25,1.0) cbind(sites,surveys,xy) ##       sites surveys           ##  [1,]     1       1 0.00 0.00 ##  [2,]     1       2 0.00 1.00 ##  [3,]     1       3 0.00 2.00 ##  [4,]     1       4 0.00 3.00 ##  [5,]     2       1 0.25 0.00 ##  [6,]     2       2 0.25 1.00 ##  [7,]     2       3 0.50 1.50 ##  [8,]     2       4 1.00 2.00 ##  [9,]     3       1 0.50 0.00 ## [10,]     3       2 0.50 1.00 ## [11,]     3       3 1.00 1.25 ## [12,]     3       4 1.50 1.00 #Distance matrix D = dist(xy) D ##            1         2         3         4         5         6         7 ## 2  1.0000000                                                             ## 3  2.0000000 1.0000000                                                   ## 4  3.0000000 2.0000000 1.0000000                                         ## 5  0.2500000 1.0307764 2.0155644 3.0103986                               ## 6  1.0307764 0.2500000 1.0307764 2.0155644 1.0000000                     ## 7  1.5811388 0.7071068 0.7071068 1.5811388 1.5206906 0.5590170           ## 8  2.2360680 1.4142136 1.0000000 1.4142136 2.1360009 1.2500000 0.7071068 ## 9  0.5000000 1.1180340 2.0615528 3.0413813 0.2500000 1.0307764 1.5000000 ## 10 1.1180340 0.5000000 1.1180340 2.0615528 1.0307764 0.2500000 0.5000000 ## 11 1.6007811 1.0307764 1.2500000 2.0155644 1.4577380 0.7905694 0.5590170 ## 12 1.8027756 1.5000000 1.8027756 2.5000000 1.6007811 1.2500000 1.1180340 ##            8         9        10        11 ## 2                                          ## 3                                          ## 4                                          ## 5                                          ## 6                                          ## 7                                          ## 8                                          ## 9  2.0615528                               ## 10 1.1180340 1.0000000                     ## 11 0.7500000 1.3462912 0.5590170           ## 12 1.1180340 1.4142136 1.0000000 0.5590170"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"displaying-trajectories","dir":"Articles","previous_headings":"2. Simple example","what":"2.2 Displaying trajectories","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"begin analysis three trajectories, display ordination space, using function trajectoryPCoA. Since Ω\\Omega two dimensions example, Principal Coordinates Analysis (PCoA) dd displays complete space:  trajectory site ‘1’ (black arrows) made three segments length direction, trajectory site ‘2’ (red arrows) second third segments bend shorter segond segment site ‘1’. Trajectory site ‘3’ includes stronger change direction shorter segments. example two dimensions used Euclidean distance, plot (albeit rotated) can straightforwardly obtained using matrix xy function trajectoryPlot:  trajectoryPCoA uses PCoA (also known classical Multidimensional Scaling) display trajectories, users can display ecosystem trajectories using ordination techniques metric Multidimensional Scaling (mMDS; see function mds package smacof) non-metric MDS (nMDS; see function metaMDS package vegan function isoMDS package MASS). Function trajectoryPlot help drawing arrows segments represent trajectories ordination space given methods. Functions trajectoryPCoAand trajectoryPlot allow selecting subset trajectories displayed, representation can focus particular pathways (see also function trajectorySelection).","code":"oldpar <- par(mar=c(4,4,1,1)) trajectoryPCoA(D, sites, surveys, traj.colors = c(\"black\",\"red\", \"blue\"), lwd = 2,                survey.labels = T) legend(\"topleft\", col=c(\"black\",\"red\", \"blue\"),         legend=c(\"Trajectory 1\", \"Trajectory 2\", \"Trajectory 3\"), bty=\"n\", lty=1, lwd = 2) par(oldpar) oldpar<-par(mar=c(4,4,1,1)) trajectoryPlot(xy, sites, surveys, traj.colors = c(\"black\",\"red\", \"blue\"), lwd = 2,                survey.labels = T) legend(\"topright\", col=c(\"black\",\"red\", \"blue\"),         legend=c(\"Trajectory 1\", \"Trajectory 2\", \"Trajectory 3\"), bty=\"n\", lty=1, lwd = 2) par(oldpar)"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"trajectory-lengths-angles-and-overall-directionality","dir":"Articles","previous_headings":"2. Simple example","what":"2.3 Trajectory lengths, angles and overall directionality","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"One may interested studying geometric properties particular trajectories. example, one can obtain length trajectory segments total pathway length using function trajectoryLengths: CTA, angles measured using triplets time-ordered ecosystem states (pair consecutive segments example triplets). matrix Δ\\Delta may represent space multiple dimensions, angles calculated respect single plane. Instead, angle measured plane defined triplet. Zero angles indicate three points (e.g. two consecutive segments) straight line. larger angle value, trajectory changing direction. Mean standard deviation statistics angles calculated according circular statistics. Function trajectoryAngles allows calculating angles consecutive segments: site ‘1’ follows straight pathway, angles > 0 trajectories site ‘2’ ‘3’, denoting change direction. case, information obtained inspecting previous plots, case Ω\\Omega many dimensions, representation correspond reduced (ordination) space hence, angles lengths plot correspond exactly functions trajectoryLengths trajectoryAngles, take account complete Ω\\Omega space. Angles can calculated consecutive segments four triplets ordered ecosystem states, whether consecutive segments (.e., points 1-2-3, 1-2-4, 1-3-4 2-3-4). done specifying =TRUE trajectoryAngles: mean resultant length circular statistics (column rho previous result), takes values 0 1, can used assess degree homogeneity angle values take value 1 angles . approach, however, uses angular information take account length segments. measure overall directionality ecosystem trajectory (.e. pathway consistently follows direction Ω\\Omega ), recommend using another statistic sensitive angles segment lengths implemented function trajectoryDirectionality: known previous plots, trajectory site ‘2’ less straight trajectory site ‘1’ site ‘3’ lowest directionality value. Note function computes descriptive statistic, .e. perform statistical test directionality.","code":"trajectoryLengths(D, sites, surveys) ##   S1       S2        S3 Trajectory ## 1  1 1.000000 1.0000000   3.000000 ## 2  1 0.559017 0.7071068   2.266124 ## 3  1 0.559017 0.5590170   2.118034 trajectoryAngles(D, sites, surveys) ##      S1-S2    S2-S3     mean         sd       rho ## 1  0.00000  0.00000  0.00000 0.00000000 1.0000000 ## 2 26.56505 18.43495 22.50000 0.07097832 0.9974842 ## 3 63.43495 53.13010 58.28253 0.08998746 0.9959593 trajectoryAngles(D, sites, surveys, all=TRUE) ##         A1      A2       A3       A4     mean        sd       rho ## 1  0.00000  0.0000  0.00000  0.00000  0.00000 0.0000000 1.0000000 ## 2 26.56505 36.8699 35.53768 18.43495 29.36033 0.1300790 0.9915754 ## 3 63.43495 90.0000 94.76364 53.13010 75.36015 0.3078934 0.9537066 trajectoryDirectionality(D, sites, surveys) ##         1         2         3  ## 1.0000000 0.8274026 0.5620859"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"relative-positions-within-trajectories","dir":"Articles","previous_headings":"2. Simple example","what":"2.4 Relative positions within trajectories","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"Ecosystem states occupy position within trajectory depends total pathway length trajectory (see Fig. 2 De Cáceres et al. 2019). adding length segments prior given state dividing sum total length trajectory obtain relative position ecosystem state. Function trajectoryProjection allows obtaining relative position point trajectory. use purpose one use parameters distance matrix states indices conform trajectory, entered twice. example two example trajectories : inspect relative positions points trajectory site ‘2’, find second third segments relative positions larger 1/3 2/3, respectively, second third segments shorter: Function trajectoryProjection can also used project arbitrary ecosystem states onto given reference trajectory. example can study projection third state trajectory site ‘2’ (.e. state 7) onto trajectory site ‘1’ (.e. states 1 4), happens half trajectory: project points trajectory site ‘3’ onto trajectory site ‘1’ see curved pathway site ‘3’ projects fourth point relative position second point.","code":"trajectoryProjection(D, 1:4, 1:4) ##   distanceToTrajectory segment relativePosition ## 1                    0       1        0.0000000 ## 2                    0       1        0.3333333 ## 3                    0       2        0.6666667 ## 4                    0       3        1.0000000 trajectoryProjection(D, 5:8, 5:8) ##   distanceToTrajectory segment relativePosition ## 5                    0       1        0.0000000 ## 6                    0       1        0.4412822 ## 7                    0       2        0.6879664 ## 8                   NA      NA               NA trajectoryProjection(D, 7, 1:4) ##   distanceToTrajectory segment relativePosition ## 7                  0.5       2              0.5 trajectoryProjection(D, 9:12, 1:4) ##    distanceToTrajectory segment relativePosition ## 9                   0.5       1    -3.700743e-17 ## 10                  0.5       2     3.333333e-01 ## 11                  1.0       2     4.166667e-01 ## 12                  1.5       1     3.333333e-01"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"trajectory-convergence","dir":"Articles","previous_headings":"2. Simple example","what":"2.5 Trajectory convergence","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"trajectories sampled number times, one can study symmetric convergence divergence (see Fig. 3a De Cáceres et al. 2019). Function trajectoryConvergence allows performing tests convergence based trend analysis sequences distances points two trajectories (.e. first-first, second-second, …): function performs Mann-Whitney trend test. Values statistic (‘tau’) larger 0 correspond trajectories diverging, whereas values lower 0 correspond trajectories converging. setting symmetric = FALSE convergence test becomes asymmetric (see Figs. 3b 3c De Cáceres et al. 2019). case sequence distances every point one trajectory : asymmetric test useful determine one trajectory becoming closer departing .","code":"trajectoryConvergence(D, sites, surveys, symmetric = TRUE) ## $tau ##           1         2         3 ## 1        NA 0.9128709 0.9128709 ## 2 0.9128709        NA 0.9128709 ## 3 0.9128709 0.9128709        NA ##  ## $p.value ##           1         2         3 ## 1        NA 0.1485617 0.1485617 ## 2 0.1485617        NA 0.1485617 ## 3 0.1485617 0.1485617        NA trajectoryConvergence(D, sites, surveys, symmetric = FALSE) ## WARNING: Error exit, tauk2. IFAULT =  12 ## $tau ##           1         2         3 ## 1        NA 0.9128709 0.9128709 ## 2 0.9128709        NA 0.8164966 ## 3 0.9128709 0.6666666        NA ##  ## $p.value ##           1         2         3 ## 1        NA 0.1485617 0.1485617 ## 2 0.1485617        NA 1.0000000 ## 3 0.1485617 0.3081795        NA"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"distances-between-segments-and-trajectories","dir":"Articles","previous_headings":"2. Simple example","what":"2.6 Distances between segments and trajectories","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"start comparing trajectories sites (.e. sampling units), one important step calculation distances directed segments (see Fig. 4 De Cáceres et al. 2019), can obtained calling function segmentDistances: Distances segments affected differences position, size direction. Hence, among six segments example, distance maximum last segment trajectory ‘1’ (named 1[3-4]) first segment trajectory ‘3’ (named 3[1-2]). One can display distances segments two dimensions using mMDS.  Distances segments internally calculated comparing whole trajectories using function trajectoryDistances. show dissimilarity two trajectories assessed using either Hausdorff distance (equal maximum distance directed segments; see eq. 8 De Cáceres et al. 2019) directed segment path distance (average distances segments; see eq. 13 De Cáceres et al. 2019): DSPD symmetrized distance. calculate non-symmetric distances one uses (see eq. 11 De Cáceres et al. 2019):","code":"Ds = segmentDistances(D, sites, surveys)$Dseg Ds ##           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2] ## 1[2-3] 1.0000000                                                             ## 1[3-4] 2.0000000 1.0000000                                                   ## 2[1-2] 0.2500000 1.0307764 2.0155644                                         ## 2[2-3] 1.0307764 0.7071068 1.5811388 1.0000000                               ## 2[3-4] 1.5811388 1.0000000 1.4142136 1.5206906 0.7071068                     ## 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 1.0307764 1.5000000           ## 3[2-3] 1.1180340 1.1180340 2.0124612 1.0307764 0.5590170 0.7500000 1.0000000 ## 3[3-4] 1.6007811 1.5590170 2.0155644 1.4577380 1.1180340 1.0606602 1.5590170 ##           3[2-3] ## 1[2-3]           ## 1[3-4]           ## 2[1-2]           ## 2[2-3]           ## 2[3-4]           ## 3[1-2]           ## 3[2-3]           ## 3[3-4] 0.5590170 mMDS = smacof::mds(Ds) mMDS ##  ## Call: ## smacof::mds(delta = Ds) ##  ## Model: Symmetric SMACOF  ## Number of objects: 9  ## Stress-1 value: 0.062  ## Number of iterations: 15 xret = mMDS$conf oldpar<-par(mar=c(4,4,1,1)) plot(xret, xlab=\"axis 1\", ylab = \"axis 2\", asp=1, pch=21,      bg=c(rep(\"black\",3), rep(\"red\",3), rep(\"blue\",3)),       xlim=c(-1.5,1), ylim=c(-1,1.5)) text(xret, labels=rep(paste0(\"s\",1:3),3), pos=1) legend(\"topleft\", pt.bg=c(\"black\",\"red\",\"blue\"), pch=21, bty=\"n\", legend=c(\"Trajectory 1\", \"Trajectory 2\", \"Trajectory 3\")) par(oldpar) trajectoryDistances(D, sites, surveys, distance.type = \"Hausdorff\") ##          1        2 ## 2 2.015564          ## 3 2.061553 1.500000 trajectoryDistances(D, sites, surveys, distance.type = \"DSPD\") ##           1         2 ## 2 0.7214045           ## 3 1.1345910 0.5714490 trajectoryDistances(D, sites, surveys, distance.type = \"DSPD\", symmetrization = NULL) ##           1         2         3 ## 1 0.0000000 0.7904401 1.2101651 ## 2 0.6523689 0.0000000 0.5196723 ## 3 1.0590170 0.6232257 0.0000000"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"structural-dynamics-in-permanent-plots","dir":"Articles","previous_headings":"","what":"3. Structural dynamics in permanent plots","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"example analyze dynamics 8 permanent forest plots located slopes valley New Zealand Alps. study area mountainous centered Craigieburn Range (Southern Alps), South Island, New Zealand (see map Fig. 8 De Cáceres et al. 2019). Forests plots almost monospecific, mountain beech (Fuscospora cliffortioides) main dominant tree species. Previously forests consisted largely mature stands, affected different disturbances sampling period (1972-2009) includes 9 surveys. begin example loading data set, includes 72 plot observations: Community data form object stratifiedvegdata. account differences tree diameter, emphasizing regeneration, data contains individual counts represent tree abundance trees classified 19 quadratic diameter bins (cm): {(2.25, 4], (4, 6.25], (6.25, 9], … (110.25, 121]}. data set also includes vectors avoca_surveys avoca_sites indicate survey forest plot corresponding forest state. starting community trajectory analysis, use function vegdiststruct package vegclust calculate distances forest plot states terms structure composition (see De Cáceres M, Legendre P, F (2013) Dissimilarity measurements size structure ecological communities. Methods Ecol Evol 4:1167–1177. https://doi.org/10.1111/2041-210X.12116): Distances avoca_D_man calculated using Manhattan metric.","code":"data(\"avoca\") avoca_D_man = vegclust::vegdiststruct(avoca_strat, method=\"manhattan\", transform = function(x){log(x+1)})"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"display-trajectories-in-pcoa","dir":"Articles","previous_headings":"3. Structural dynamics in permanent plots","what":"3.1 Display trajectories in PCoA","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"distance matrix avoca_D_man conforms definition Ω\\Omega. use trajectoryPCoA display relations forest plot states space draw trajectory plot:  Note case, full Ω\\Omega includes two dimensions, PCoA representing 43% total variance (correction negative eigenvalues included call cmdscale trajectoryPCoA), one careful interpreting trajectories visually. Another option use mMDS represent trajectories, case produces similar result:  One can inspect specific trajectories using argument selection function trajectoryPCoA. allows getting better view particular trajectories, forest plot ‘3’:  right hand, added representation change mountain beech tree diameter distribution time trajectory forest plot ‘3’. dynamics plot include mostly growth, results individuals moving one diameter class . whole trajectory looks mostly directional. Let’s now inspect trajectory forest plot ‘4’:  second trajectory less straight seems include turn end sampling period, corresponding recruitment new saplings.","code":"oldpar <- par(mar=c(4,4,1,1)) trajectoryPCoA(avoca_D_man,  avoca_sites, avoca_surveys,                traj.colors = RColorBrewer::brewer.pal(8,\"Accent\"),                 axes=c(1,2), length=0.1, lwd=2) ## Warning in cmdscale(D2, eig = TRUE, add = TRUE, k = nrow(as.matrix(D2)) - : ## only 70 of the first 71 eigenvalues are > 0 legend(\"topright\", bty=\"n\", legend = 1:8, col = RColorBrewer::brewer.pal(8,\"Accent\"), lwd=2) par(oldpar) mMDS = smacof::mds(avoca_D_man) mMDS ##  ## Call: ## smacof::mds(delta = avoca_D_man) ##  ## Model: Symmetric SMACOF  ## Number of objects: 72  ## Stress-1 value: 0.114  ## Number of iterations: 49 oldpar  <- par(mar=c(4,4,1,1)) trajectoryPlot(mMDS$conf,  avoca_sites, avoca_surveys,                traj.colors = RColorBrewer::brewer.pal(8,\"Accent\"),                 axes=c(1,2), length=0.1, lwd=2) legend(\"topright\", bty=\"n\", legend = 1:8, col = RColorBrewer::brewer.pal(8,\"Accent\"), lwd=2) par(oldpar) oldpar <- par(mfrow=c(1,2)) trajectoryPCoA(avoca_D_man,  avoca_sites, avoca_surveys,                selection= 3,                length=0.1, lwd=2, survey.labels = T) plotTrajDiamDist(3) par(oldpar) oldpar <- par(mfrow=c(1,2)) trajectoryPCoA(avoca_D_man,  avoca_sites, avoca_surveys,                selection= 4,                length=0.1, lwd=2, survey.labels = T) plotTrajDiamDist(4) par(oldpar)"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"trajectory-lengths-angles-and-overall-directionality-1","dir":"Articles","previous_headings":"3. Structural dynamics in permanent plots","what":"3.2 Trajectory lengths, angles and overall directionality","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"trajectory lengths angles can inspected visually ordination diagrams, better calculate using full Ω\\Omega space (.e., matrix avoca_D_man). Using function trajectoryLengths can see trajectory forest plot ‘4’ lengthier plot ‘3’, mostly includes lengthier last segment (.e. recruitment new individuals): calculate angles consecutive segments (using function trajectoryLengths) see indeed trajectory ‘3’ rather directional, angles trajectory ‘4’ larger, aveerage: calling function trajectoryDirectionality can confirm trajectory site ‘4’ less straight site ‘3’: following code displays relationship statistic trajectoryDirectionality mean resultant vector length uses angular information assesses constancy angle values:","code":"trajectoryLengths(avoca_D_man, avoca_sites, avoca_surveys) ##          S1        S2        S3        S4        S5        S6        S7 ## 1 1.2173214 1.5911988 1.0976965 2.1173501 0.5238760 1.5863283 1.5750365 ## 2 0.5971165 1.7469687 0.9866591 0.9413060 1.3687614 0.6280231 1.4565581 ## 3 1.1480971 1.2404953 0.6508116 0.4371405 0.5098385 1.2078811 1.6241741 ## 4 0.7932307 1.8572629 0.7268623 0.8348635 3.0560437 1.9863939 0.9905892 ## 5 1.7769875 0.3367341 0.7283030 0.6515714 1.2660552 0.9544933 1.2605333 ## 6 2.1891568 0.5312711 1.0035212 0.4113220 2.1394743 1.0482871 1.4924056 ## 7 0.2919002 0.8857645 1.0908604 0.5601649 2.0600208 0.3712067 1.1014563 ## 8 0.1909713 1.2000266 2.3211891 0.6539882 2.7807668 0.8170202 1.2072425 ##          S8 Trajectory ## 1 0.6277940  10.336602 ## 2 1.1232798   8.848673 ## 3 1.4536390   8.272077 ## 4 3.8794520  14.124698 ## 5 0.5842314   7.558909 ## 6 1.9623777  10.777816 ## 7 1.7518489   8.113223 ## 8 1.5107357  10.681940 avoca_ang <- trajectoryAngles(avoca_D_man, avoca_sites, avoca_surveys) avoca_ang ##       S1-S2        S2-S3        S3-S4     S4-S5     S5-S6     S6-S7 ## 1  41.74809 8.669806e+01 7.401875e+01  26.94138 113.40657 100.67068 ## 2  68.14891 3.466506e+01 8.537736e-07   0.00000  25.97111   0.00000 ## 3  87.24519 3.088828e+01 1.207418e-06   0.00000  50.90743  48.12854 ## 4  37.65736 8.537736e-07 8.537736e-07  36.25240  55.53607  74.21065 ## 5  42.02156 7.166400e+01 1.207418e-06  49.95436  65.75897  65.82083 ## 6  41.69894 4.611675e+01 5.669641e+01 135.84929   0.00000   0.00000 ## 7  53.63254 1.152378e+02 6.519921e+01  60.71442   0.00000  56.25733 ## 8 180.00000 0.000000e+00 9.213121e+01 132.36445  71.33948  36.43189 ##          S7-S8     mean        sd       rho ## 1 1.021996e+02 78.82477 0.5334615 0.8673692 ## 2 1.207418e-06 17.61550 0.4257423 0.9133572 ## 3 4.568199e+01 37.39925 0.5018798 0.8816663 ## 4 4.980332e+01 36.44717 0.4531030 0.9024417 ## 5 1.061250e+02 57.89321 0.5239476 0.8717431 ## 6 0.000000e+00 34.34150 0.7777287 0.7390195 ## 7 1.207418e-06 49.96352 0.6562139 0.8062928 ## 8 1.207418e-06 66.68343 1.1601974 0.5101610 avoca_dir <- trajectoryDirectionality(avoca_D_man, avoca_sites, avoca_surveys) avoca_dir ##         1         2         3         4         5         6         7         8  ## 0.6781369 0.6736490 0.8651467 0.5122482 0.6677116 0.7058465 0.7391775 0.5254225 avoca_rho = trajectoryAngles(avoca_D_man, avoca_sites, avoca_surveys, all=TRUE)$rho oldpar <- par(mar=c(4,4,1,1)) plot(avoca_rho, avoca_dir, xlab = \"rho(T)\", ylab = \"dir(T)\", type=\"n\") text(avoca_rho, avoca_dir, as.character(1:8)) par(oldpar)"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"distances-between-trajectories","dir":"Articles","previous_headings":"3. Structural dynamics in permanent plots","what":"3.3 Distances between trajectories","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"can calculate resemblance forest plot trajectories using trajectoryDistances: closest trajectories plots ‘1’ ‘2’. looked rather close position PCoA ordination Ω\\Omega trajectories, probably position, rather shape influenced low value. next pair similar trajectories ‘3’-‘5’ pair. can use mMDS produce ordination resemblances trajectories:  Distances trajectories can calculated centering (.e. bringing trajectories center Ω\\Omega space). done using function centerTrajectories, returns new dissimilarity matrix. Centering removes differences position trajectories, useful cases one wants focus spatio-temporal interaction discarding spatial patterns constant time. illustrate centering , interesting particular example.","code":"##       1     2     3     4     5     6     7 ## 2 2.405                                     ## 3 6.805 5.773                               ## 4 6.123 6.646 5.225                         ## 5 6.020 5.541 3.235 4.966                   ## 6 9.490 8.866 3.436 6.043 4.505             ## 7 4.024 3.291 4.365 4.993 4.389 6.205       ## 8 9.797 9.747 5.591 4.611 6.383 5.043 6.949 mMDS<-smacof::mds(avoca_D_traj_man) mMDS ##  ## Call: ## smacof::mds(delta = avoca_D_traj_man) ##  ## Model: Symmetric SMACOF  ## Number of objects: 8  ## Stress-1 value: 0.091  ## Number of iterations: 25 x<-mMDS$conf[,1] y<-mMDS$conf[,2] oldpar <- par(mar=c(4,4,1,1)) plot(x,y, type=\"p\", asp=1, xlab=paste0(\"Axis 1\"),       ylab=paste0(\"Axis 2\"), col=\"black\",      bg= RColorBrewer::brewer.pal(8,\"Accent\"), pch=21) text(x,y, labels=1:8, pos=1) par(oldpar)"},{"path":"https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.html","id":"smoothing-noisy-trajectories","dir":"Articles","previous_headings":"3. Structural dynamics in permanent plots","what":"3.4 Smoothing noisy trajectories","title":"Introduction to Ecological Trajectory Analysis (ETA)","text":"Although trajectories data set particularly noisy, package ecotraj includes function trajectorySmoothing() smooth noise trajectories. done applying Gaussian kernel trajectory: K(x,xr)=exp(−(x−xr)22⋅b2)\\begin{equation} K(x, x_r) = exp\\left( - \\frac{(x - x_r)^2}{2\\cdot b^2} \\right) \\end{equation} xx survey time target location, xrx_r survey time one original points bb kernel scale. Kernel values normalized one used determine (implicitly) new coordinates ecosystem observations. kernel application turns consecutive ecosystem states similar. Function trajectorySmoothing() performs smoothing operation returns modified distance matrix describing distances ecosystem states: following figure illustrates effect smoothing:  Trajectory smoothing logically alters several trajectory metrics. particular, overall trajectory length reduced: trajectory directionality increased: Whether effects desirable , depend application.","code":"avoca_D_man_smooth <- trajectorySmoothing(avoca_D_man, avoca_sites, avoca_surveys) trajectoryLengths(avoca_D_man, avoca_sites, avoca_surveys)$Trajectory ## [1] 10.336602  8.848673  8.272077 14.124698  7.558909 10.777816  8.113223 ## [8] 10.681940 trajectoryLengths(avoca_D_man_smooth, avoca_sites, avoca_surveys)$Trajectory ## [1]  6.776356  7.601166  6.792566 11.049763  5.741160  8.884752  6.351899 ## [8]  7.884819 trajectoryDirectionality(avoca_D_man, avoca_sites, avoca_surveys) ##         1         2         3         4         5         6         7         8  ## 0.6781369 0.6736490 0.8651467 0.5122482 0.6677116 0.7058465 0.7391775 0.5254225 trajectoryDirectionality(avoca_D_man_smooth, avoca_sites, avoca_surveys) ##         1         2         3         4         5         6         7         8  ## 0.8043023 0.7034985 0.9107370 0.5753210 0.7545522 0.7586568 0.8084251 0.6322645"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"about-this-vignette","dir":"Articles","previous_headings":"","what":"1. About this vignette","title":"Stable Isotope Trajectory Analysis (SITA)","text":"vignette present ecological applications used Sturbois et al. (2021) new stable isotope trajectory analysis framework: Sturbois, et al., Stable Isotope Trajectory Analysis (SITA): new approach quantify visualize dynamics stable isotope studies. Ecol. Monogr. (2021). https://doi.org/10.1002/ecm.1501 Example datasets included package reproducibility. calculation necessary distance- direction-based metrics, vignette focuses, ecological applications, creation trajectory charts.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"loading-libraries","dir":"Articles","previous_headings":"","what":"2. Loading libraries","title":"Stable Isotope Trajectory Analysis (SITA)","text":"First , load required libraries, including ecotraj:","code":"## Loading required package: Rcpp ## Loading required package: viridisLite ##  ## Attaching package: 'viridis' ## The following object is masked from 'package:scales': ##  ##     viridis_pal"},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"fur-seal-stable-isotope-dataset","dir":"Articles","previous_headings":"3. Spatial and temporal resource partitioning in fur seals","what":"3.1 Fur seal stable isotope dataset","title":"Stable Isotope Trajectory Analysis (SITA)","text":"begin loading package dataset furseals: subset dataset provided : Kernaléguen, L., Arnould, J.P.Y., Guinet, C., Cherel, Y., 2015. Determinants individual foraging specialization large marine vertebrates, Antarctic subantarctic fur seals. Journal Animal Ecology 1081–1091. Briefly, fur seals [Antarctic fur seal Arctocephalus gazella (AFS) subantarctic fur seal . tropicalis (SAFS)] whisker SI values yield unique long-term information individual behaviour integrates spatial, trophic temporal dimensions ecological niche. foraging strategies two species sympatric fur seals examined winter 2001/2002 Crozet, Amsterdam Kerguelen Islands (Southern Ocean) using stable isotope values serially sampled whiskers. method consists analysis consecutive whisker sections (3 mm long) starting proximal (facial) end, recently synthesized tissue remaining skin. individuals (n = 47) whiskers totalizing least 30 sections selected initial data, 30 sections considered herein, t1 (recent values) t30 (oldest values).","code":"data(\"furseals\")"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"trajectory-metrics","dir":"Articles","previous_headings":"3. Spatial and temporal resource partitioning in fur seals","what":"3.2 Trajectory metrics","title":"Stable Isotope Trajectory Analysis (SITA)","text":"section, illustrate calculate trajectory metrics characterize foraging strategy fur seal. following sections, show use metrics data create plots. First, calculate net changes relative initial state (.e. distance stable isotope compositions (.e state) whisker section initial stable isotope composition): calculate trajectory segment lengths, .e. distance stable isotope composition consecutive whisker sections stable isotope space: Finally, determine angle (α\\alpha) consecutive trajectory segments respect second axis 2D stable isotope space:","code":"Net_changes<-trajectoryLengths2D(furseals[,c(\"d13C\",\"d15N\")],                                  furseals$ID_SITA,                                  furseals$Time, relativeToInitial=TRUE)  head(Net_changes) ##       Lt1_t2    Lt1_t3    Lt1_t4    Lt1_t5     Lt1_t6    Lt1_t7    Lt1_t8 ## 1 0.08246211 1.0892314 2.0775851 2.3714985 2.20626585 1.7839633 1.6819920 ## 2 0.59304131 0.9583074 0.8218643 0.2677928 0.08105554 0.7460168 0.4970191 ## 3 0.23256182 1.4622975 3.0029069 2.8817373 2.55906428 1.6445066 1.6734124 ## 4 1.24068086 2.1744498 2.3520872 2.4028260 2.28455422 2.2679323 0.9493714 ## 5 1.80624915 3.0818595 3.8011940 4.4793800 4.50949775 4.3885128 2.9507619 ## 6 1.13903687 4.3444610 4.0299700 6.4151503 5.96779901 6.0314152 7.2216151 ##     Lt1_t9   Lt1_t10   Lt1_t11   Lt1_t12   Lt1_t13   Lt1_t14   Lt1_t15 ## 1 1.344206 1.2735702 1.0631895 0.7915611 0.8486489 1.0500638 1.1961910 ## 2 1.092157 0.6772156 0.7744366 0.2702240 0.6136685 1.0261861 0.7000864 ## 3 2.518128 2.0782324 1.7294097 1.1594387 1.7649975 2.7768920 2.4641059 ## 4 0.577084 0.6049504 0.5920490 1.5973206 1.1985112 0.8119858 0.6936173 ## 5 2.187465 0.9662236 2.6143697 2.7163971 2.7958673 2.6837384 2.2504011 ## 6 7.173525 6.2867554 0.2478810 0.9972668 0.9076795 0.5088025 0.6640821 ##     Lt1_t16   Lt1_t17   Lt1_t18   Lt1_t19  Lt1_t20  Lt1_t21   Lt1_t22   Lt1_t23 ## 1 1.5432880 1.6484832 1.6042908 1.6566572 1.108358 0.381577 0.3006742 1.4772136 ## 2 0.5592397 0.4460235 0.6495922 0.7966461 1.787011 1.591433 1.5776276 1.6305889 ## 3 0.2755014 0.4497755 0.6170292 0.2879392 1.103359 2.145421 2.1758332 2.1139858 ## 4 0.3626927 0.7276160 0.9288983 0.7955941 2.352899 1.851222 2.2158782 2.3341939 ## 5 1.8418754 1.8304906 1.8207087 1.5938494 1.553721 1.583789 1.5700115 0.6566011 ## 6 3.6309179 4.0313501 6.0026223 6.9996921 6.341455 7.297884 7.5324814 6.1068566 ##     Lt1_t24   Lt1_t25   Lt1_t26   Lt1_t27    Lt1_t28   Lt1_t29   Lt1_t30 ## 1 1.5890755 1.0783103 1.1172381 2.0638181 2.52046504 2.2934779 1.6320787 ## 2 0.2046069 0.3937309 0.3849480 0.7032112 0.89491061 0.3901513 0.7480241 ## 3 2.2036883 1.8413856 1.6354464 1.9473328 1.59052601 1.3147125 1.6315076 ## 4 2.1019596 0.2814321 0.4237924 0.7473988 0.05360037 0.3889730 0.7375269 ## 5 4.0823528 4.4187248 4.3025323 4.3520214 3.43035873 0.7908375 1.2435373 ## 6 1.7282780 2.1873694 1.2698965 0.5391030 0.40993902 0.4085156 0.7709643 ##   Trajectory ## 1   40.87543 ## 2   21.87682 ## 3   49.28114 ## 4   36.05110 ## 5   76.30333 ## 6  107.19276 Segment_lengths<-trajectoryLengths2D(furseals[,c(\"d13C\",\"d15N\")],                                      furseals$ID_SITA,                                      furseals$Time, relativeToInitial=FALSE)  head(Segment_lengths) ##           S1        S2       S3         S4         S5         S6        S7 ## 1 0.08246211 1.0799190 1.109759 0.39708060 0.16604819 0.69542793 0.1332817 ## 2 0.59304131 0.4019664 0.165463 0.62878295 0.24977790 0.81093588 0.4377728 ## 3 0.23256182 1.2719328 1.561554 0.13206059 0.81044432 1.21893232 0.3748826 ## 4 1.24068086 0.9337907 0.177792 0.08732125 0.11957006 0.06462971 1.3506817 ## 5 1.80624915 1.2835334 1.452408 1.22947021 0.05423099 0.33640006 1.4518034 ## 6 1.13903687 3.2697465 1.007842 2.40400083 1.02618176 0.80004000 1.4924584 ##           S8         S9       S10       S11        S12       S13       S14 ## 1 0.35206960 0.13800362 0.2119929 0.3940774 0.08004998 0.2026154 0.2040221 ## 2 0.94680304 0.44818858 0.6290191 0.5362695 0.52697249 0.4552637 0.3411231 ## 3 1.04072379 0.44107256 0.3592548 0.7240691 0.66598649 1.0131856 0.4798427 ## 4 1.44655867 0.09009439 1.1117198 2.1338287 0.39901128 1.4341130 0.3064376 ## 5 0.78147681 1.29231962 3.5747035 0.6261150 0.09265528 0.2502838 0.6440194 ## 6 0.05115662 0.88680381 6.3555849 0.9913889 0.09047099 0.4029814 1.1639300 ##         S15       S16       S17       S18       S19       S20        S21 ## 1 0.3703039 0.1632330 1.7046178 1.0355916 1.0132186 0.7423544 0.11970798 ## 2 0.1554670 0.2837781 0.2257632 0.6603492 0.9904383 0.5893293 0.03956008 ## 3 2.3198028 0.5979908 0.3078262 0.3993219 1.3487198 1.1301832 0.04002499 ## 4 0.8420291 0.4612776 1.5254799 0.1874727 1.5712829 0.5036268 0.41386471 ## 5 0.4404407 0.5163768 0.5204652 0.2380084 0.1802276 0.2205108 0.22402009 ## 6 2.9863858 0.7196339 1.9833855 1.0789699 0.7247068 0.9616637 0.24162988 ##          S22       S23       S24       S25       S26       S27       S28 ## 1 1.76281735 0.1147911 0.6148642 0.3162910 0.9585927 0.5338661 0.2521686 ## 2 0.27828942 1.4322639 0.5912495 0.7604426 0.3286716 0.2085977 0.5259743 ## 3 0.09244458 0.1509503 0.6998436 0.3191520 0.6441894 0.5047336 0.3805181 ## 4 0.25223997 0.2500180 1.8461901 0.6878982 0.3330540 0.7518151 0.3540353 ## 5 2.03381243 3.4923735 0.4153228 0.1254313 0.1696408 0.9698892 2.7246227 ## 6 1.48631692 7.3792361 0.6324634 0.9520021 0.9154939 0.1794937 0.3834071 ##         S29 Trajectory ## 1 0.6836988   15.63293 ## 2 0.3593800   14.60093 ## 3 0.3359345   19.59814 ## 4 0.5050881   21.38160 ## 5 1.8207584   28.96757 ## 6 0.9149454   42.62136 Angles<-trajectoryAngles2D(furseals[,c(\"d13C\",\"d15N\")],                            furseals$ID_SITA,                            furseals$Time, betweenSegments=FALSE) head(Angles) ##    Axis2-t1  Axis2-t2  Axis2-t3   Axis2-t4   Axis2-t5  Axis2-t6  Axis2-t7 ## 1  75.96376 161.64894 195.57662 222.448400   9.008504  48.14751  25.79603 ## 2 179.32369 147.49601 315.00000 337.758643  47.109090 356.04023 139.72521 ## 3 243.98585 206.02112 198.13327   1.735705 326.780524  10.11145 151.99944 ## 4  64.19912  63.68191  66.46289 119.500725 237.639062 171.99527 255.90203 ## 5 263.32352 271.65188 195.28972 181.584670 174.709919 343.77386  61.26355 ## 6  65.68510  43.26505 163.63292  53.082435 298.712949 139.46085  99.02053 ##    Axis2-t8  Axis2-t9 Axis2-t10   Axis2-t11 Axis2-t12 Axis2-t13 Axis2-t14 ## 1 358.86075 283.83485 352.13745  22.5303928 192.99462 157.35838 199.76717 ## 2 307.01513 171.27328 215.35767  80.5552424  19.74159  26.62133 201.67665 ## 3 186.01189  37.90916  45.90222   0.7913279 198.10848 214.09786  81.85301 ## 4 250.78846 351.06043  81.67311 261.0762308  90.43079  53.84926 234.02761 ## 5  62.15609  60.16163  36.43393 125.7717105  83.18179 293.79978 270.44483 ## 6 265.51539 245.97847 247.59927 224.5913352  66.55194  64.26158  61.40918 ##   Axis2-t15 Axis2-t16 Axis2-t17 Axis2-t18 Axis2-t19 Axis2-t20 Axis2-t21 ## 1 182.32153 112.32286  37.13207  351.0561 280.57797 209.98421 149.36458 ## 2 203.10181 122.62605  56.38032  290.3834 341.27235 223.14352  73.85566 ## 3  34.05313  18.22286 331.68664  173.8183 198.63646 223.85280 167.00538 ## 4 180.47632 178.01222  48.64094  208.3422  64.39713 244.35079  38.91926 ## 5 236.67073 131.62432 147.71456  228.4064 173.30874 159.83930 179.23269 ## 6  52.20915 115.78169  71.69294   42.1451 219.40066  71.88535  52.22900 ##   Axis2-t22 Axis2-t23 Axis2-t24 Axis2-t25 Axis2-t26 Axis2-t27 Axis2-t28 ## 1 188.15309  198.2771  338.7350 109.58071 196.73359 224.92411 352.48043 ## 2  48.05870  155.7613  152.8282 351.45433  23.67929 346.69657 176.51200 ## 3  74.31001  150.2080  331.4941 353.34260 156.77805  68.62019 338.89763 ## 4 129.36932  270.6875  251.1332 240.37909 268.96776  74.65130 298.88170 ## 5 254.83630  245.0713  203.1080  35.59078 163.91542  71.91999  58.09492 ## 6 231.11744  239.4211  251.8515  22.74023  21.46438 118.99260 128.75316 ##   Axis2-t29 ## 1  31.96985 ## 2  28.77587 ## 3 186.15184 ## 4 235.64922 ## 5  61.49251 ## 6  67.77996"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"identification-and-characterization-of-trajectory-clusters","dir":"Articles","previous_headings":"3. Spatial and temporal resource partitioning in fur seals","what":"3.3 Identification and characterization of trajectory clusters","title":"Stable Isotope Trajectory Analysis (SITA)","text":"aim define groups fur seals depending similarity foraging strategy. need first calculate distances pairs complete trajectories stable isotope space: , can use function hclust() conduct hierarchiacl clustering symmetric matrix D:  cut dendrogram height Hst obtain vector cluster membership copy furseals factor:","code":"D <- dist(furseals[,c(\"d13C\",\"d15N\")]) Ds<-trajectoryDistances(D, furseals$ID_SITA, surveys = NULL, distance.type = \"DSPD\",                         symmetrization = \"mean\", add = TRUE, verbose = FALSE) colstd<-c(\"black\",\"yellow\",\"green\",\"blue\",\"grey\",\"red\") pt<-c(16,16,16,16) hsxy <- hclust(Ds, \"ward.D2\") plot(hsxy,hang = -1, main=\"distance Fur Seals\", cex=.6) Hst=2 # Cutting height x<-rect.hclust(hsxy, h=Hst,                border = colstd) groups <- cutree(hsxy, h=Hst) furseals$cluster <- as.factor(groups)"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"individual-trophic-trajectories-for-males-and-females-of-a--gazella-and-a--tropicalis","dir":"Articles","previous_headings":"3. Spatial and temporal resource partitioning in fur seals > 3.3 Identification and characterization of trajectory clusters","what":"3.3.1 Individual trophic trajectories for males and females of A. gazella and A. tropicalis","title":"Stable Isotope Trajectory Analysis (SITA)","text":"display trophic trajectories individuals, plots corresponding combinations species gender. facilitate plots, create vector combination species gender: now create diagram display fur seal trophic trajectories stable isotope space. Panels correspond combination species gender. panel, X-Y axes defined d13C d15N stable isotope values. Arrows connects whiskers section SI states t1 t30 (.e. recent oldest SI state). Colors corresponds trajectory clusters shape breeding sites:","code":"furseals$sp_gender<-paste(furseals$Sexe, furseals$Species, sep=\" \") ggplot(data=furseals,aes(x=d13C,y=d15N,color=cluster,shape=Place))+   geom_point()+   geom_path(aes(x=d13C,y=d15N,group=ID_SITA,color=cluster),             arrow = arrow(length = unit(0.10, \"cm\")))+   xlab(expression(delta^13*\"C\"))+   ylab(expression(delta^15*\"N\"))+   facet_wrap(~sp_gender) +   theme_classic()"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"net-changes-time-series-for-males-and-females-of-both-fur-seal-species","dir":"Articles","previous_headings":"3. Spatial and temporal resource partitioning in fur seals > 3.3 Identification and characterization of trajectory clusters","what":"3.3.2 Net changes time series for males and females of both fur seal species","title":"Stable Isotope Trajectory Analysis (SITA)","text":"sub-section display net changes time series individuals, plots corresponding combinations species gender prepare subset data called NC: prepare subset. notably transform NC longer format, order data set add vector sp_gender: now create plot display net changes time series individuals panel corresponding Arrows connects whiskers section stable isotope values t1 t30 (.e. recent oldest stable isotope values). Colours corresponds trajectory clusters:","code":"NC<-Net_changes[,-30] NC$cluster<-furseals$cluster[1:47] NC$ID<-as.numeric(rownames(NC)) colnames(NC)<-c(2:30,\"cluster\",\"ID\") NCline <- tidyr::pivot_longer(NC, 1:29,                                names_to =\"Time_from_present\",                                values_to=\"Net_changes\",                                names_transform = function(x) {as.numeric(x)-1})  colnames(NCline)[1:2]<-c(\"Clusters\", \"ID\") NCline <- NCline[order(NCline$Time_from_present, decreasing=FALSE),] NCline <- as.data.frame(NCline) NCline$sp_gender<-c(furseals$sp_gender[1:47]) ggplot(data=NCline,aes(x=Time_from_present,y=Net_changes,color=Clusters))+   geom_path(aes(x=Time_from_present,y=Net_changes,group=ID,color=Clusters),             arrow = arrow(length = unit(0.10, \"cm\")))+   facet_wrap(~sp_gender)+   theme_classic()"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"angle-alpha-trajectory-roses-of-fur-seals-trajectory-cluster-","dir":"Articles","previous_headings":"3. Spatial and temporal resource partitioning in fur seals > 3.3 Identification and characterization of trajectory clusters","what":"3.3.3 Angle α\\alpha trajectory roses of Fur seals trajectory cluster.","title":"Stable Isotope Trajectory Analysis (SITA)","text":"sub-section, plot distribution Angle α\\alpha values trajectory rose prepare data set compute trajectory rose transform long data structure. create vector direction class Angle α\\alpha values range 15°: now create trajectory rose. Angles α\\alpha calculated 2D Ωδ\\Omega \\delta space (δ13C/δ15N\\delta 13C/\\delta 15N) represented range (15∘\\circ) direction. Bars size represent number trajectory segments (individual within trajectory clusters).","code":"Angl<-Angles colnames(Angl)<-2:30 Angl$ID<-as.numeric(rownames(Angl)) Angl$cluster<-as.factor(groups) Angl$sp_gender<-furseals$sp_gender[1:47]  Angline<- tidyr::pivot_longer(Angl, 1:29,                                names_to =\"Time_from_present\",                                values_to=\"Direction\",                                names_transform = function(x) {as.numeric(x)-1})  colnames(Angline)[c(2,3)] = c(\"Clusters\", \"Group\")  # range 15° deg <- 15 # vector for range of direction of different bars dir.breaks <- seq(0-(deg/2), 360+(deg/2), deg) dir.binned <- cut(Angline$Direction,                   breaks = dir.breaks,                   ordered_result = TRUE) # direction labels dir.labels <- as.character(c(seq(0, 360-deg, by = deg), 0)) levels(dir.binned) <- dir.labels  # angles distribution in each range of direction Angline$dir.binned <- dir.binned  # sort angles df_sorted<-as.data.frame(table(Angline$dir.binned, Angline$Clusters)) colnames(df_sorted)<-c(\"dir.binned\",\"Clusters\",\"nb\") df_sorted = df_sorted[order(df_sorted$dir.binned),] ggplot(data=df_sorted, aes(x=dir.binned, y=nb, fill=Clusters)) +   geom_bar(stat=\"identity\")+   scale_y_continuous(limits = c(0,110), expand = c(0, 0),                       breaks = c(0,25,50,75,110),                       labels = c(0,25,50,75,110)) +   labs(x = 'Trajectory segment directions within fur seals clusters', y = 'number of trajectory segments') +   coord_polar(start = -(deg/2)*(pi/180)) +   theme_minimal()"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"ontogenic-stable-isotope-trajectories-of-juvenile-fishes","dir":"Articles","previous_headings":"","what":"4. Ontogenic stable isotope trajectories of juvenile fishes","title":"Stable Isotope Trajectory Analysis (SITA)","text":"section, illustrate calculate trajectory metrics characterize ontogenic stable isotope trajectories juvenile fishes. following sections, show use metrics data create trajectory diagram.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"loading-data","dir":"Articles","previous_headings":"4. Ontogenic stable isotope trajectories of juvenile fishes","what":"4.1 Loading data","title":"Stable Isotope Trajectory Analysis (SITA)","text":"begin loading package dataset pike: data set : Cucherousset, J., Paillisson, J.-M., Roussel, J.-M., 2013. Natal departure timing spatially varying environments dependent individual ontogenetic status. Naturwissenschaften 100, 761–768. Briefly, Cucherousset et al. (2013) released 192 individually tagged, hatchery-raised, juvenile pike (Esox lucius L.) variable initial trophic position (fin δ13C/δ15N\\delta13C/\\delta15N values). Based δ15N\\delta15N values, individuals classified zooplanktivorous (δ15N\\delta15N < 10 ‰) piscivorous (δ15N\\delta15N > 10 ‰) cannibalism commonly observed species. Individuals released temporarily flooded grassland pike eggs usually hatch Brière marsh (France) identify determinants juvenile natal departure. release site connected unique point adjacent pond used nursery habitat. Fish continuously recaptured migrating flooded grassland adjacent pond. Recaptured individuals (n = 29) anaesthetized, checked tags, measured fork length, fin-clipped quantify changes δ13C\\delta13C δ15N\\delta15N values, released.","code":"data(\"pike\")"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"calculating-trajectory-metrics-and-identification-of-trajectory-clusters","dir":"Articles","previous_headings":"4. Ontogenic stable isotope trajectories of juvenile fishes","what":"4.2 Calculating trajectory metrics and identification of trajectory clusters","title":"Stable Isotope Trajectory Analysis (SITA)","text":"First, calculate net changes relative initial state individual (.e. distance stable isotope compositions release recapture): , can use function hclust() conduct hierarchiacl clustering symmetric matrix D: cut dendrogram height Hst obtain vector cluster membership copy pike:","code":"Net_changes<-trajectoryLengths2D(pike[,7:8],pike$ID,pike$Time, relativeToInitial=TRUE)  colnames(Net_changes)<-c(\"Net_changes\", \"Trajectory\") pike$Net_Changes<-Net_changes$Net_changes D=dist(pike[,7:8]) Ds<-trajectoryDistances(D,pike$ID, surveys = NULL, distance.type = \"DSPD\",                         symmetrization = \"mean\", add = TRUE, verbose = FALSE) Hst=3 colstd<-c(\"black\",\"yellow\",\"green\",\"blue\",\"grey\",\"red\") hsxy <- hclust(Ds, \"ward.D2\") plot(hsxy,hang = -1, main=\"distance Pike\", cex=.6) x<-rect.hclust (hsxy, h=Hst,                 border = colstd) # Store clusters into a new data column pike$Cluster<-cutree(hsxy, h=Hst)"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"trajectory-diagram-of-pike-released-in-the-flooded-grassland-and-recaptured-when-emigrating-into-the-adjacent-pond","dir":"Articles","previous_headings":"4. Ontogenic stable isotope trajectories of juvenile fishes","what":"4.3 Trajectory diagram of pike released in the flooded grassland and recaptured when emigrating into the adjacent pond","title":"Stable Isotope Trajectory Analysis (SITA)","text":"prepare data set compute trajectory diagrams density curves: create trajectory diagram. Arrows represent trajectory path pit-tagged individual. Colors correspond trajectory clusters. dashed line separates piscivorous zooplanktivorous individuals [zooplanktivorous (δ15N\\delta15N < 10) vs piscivorous (δ15N\\delta15N > 10)].  Density curves X represents distribution samples according δ13C\\delta13C values, capture (green=release; red=departure):  Density curves Y represents distribution samples according δ15N\\delta15N values, capture (green=release; red=departure):","code":"Pike1<-pike[pike$Time %in% 1,] Pike1<-Pike1[order(Pike1$ID, decreasing=FALSE),] Pike1$Net_changes<-0 Pike2<-pike[pike$Time %in% 2,] Pike2<-Pike2[order(Pike2$ID, decreasing=FALSE),] Pike2$Net_changes<-Net_changes$Net_changes data<-as.data.frame(rbind(Pike1,Pike2)) ggplot(data=data,aes(x=d13C,y=d15N,shape=Trophic_status_initial))+   geom_point(aes(size=Net_changes))+   geom_path(aes(x=d13C,y=d15N,group=ID,color=factor(Cluster)),arrow = arrow(length = unit(0.30, \"cm\")))+   geom_hline(yintercept=10, linetype=\"dashed\", color = \"black\")+   xlab(expression(delta^13*\"C\")) +   ylab(expression(delta^15*\"N\"))+   theme_minimal() gg_dist_d13C = ggplot(data, aes(d13C, fill=TimeL)) + geom_density(alpha=.5)  gg_dist_d13C = gg_dist_d13C + ylab(expression(delta^13*\"C\"*\" density\")) gg_dist_d13C = gg_dist_d13C + theme(axis.title.y=element_blank(),                                     axis.text=element_blank(),                                     axis.line=element_blank(),                                     axis.ticks=element_blank(),                                     panel.grid.major = element_blank(),                                     panel.grid.minor = element_blank(),                                     panel.background =element_blank()) gg_dist_d13C = gg_dist_d13C + theme(legend.position = \"none\") gg_dist_d13C + scale_x_continuous(limits = c(-33, -25))+scale_y_continuous(limits = c(0, 1)) gg_dist_d15N = ggplot(data, aes(d15N, fill=TimeL)) + geom_density(alpha=.5)  gg_dist_d15N = gg_dist_d15N + ylab(expression(delta^15*\"N\"*\" density\")) gg_dist_d15N =gg_dist_d15N  gg_dist_d15N =gg_dist_d15N + coord_flip() gg_dist_d15N =gg_dist_d15N + theme(axis.title.y=element_blank(),                                    axis.text=element_blank(),                                    axis.line=element_blank(),                                    axis.ticks=element_blank(),                                    panel.grid.major = element_blank(),                                    panel.grid.minor = element_blank(),                                    panel.background =element_blank()) gg_dist_d15N =gg_dist_d15N +theme(legend.position = \"none\") gg_dist_d15N + scale_x_continuous(limits = c(7, 14))+scale_y_continuous(limits = c(0, 1))"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"spatio-temporal-variability-of-delta-13c-and-delta-15n-modelled-isoscapes-in-the-northeast-pacific","dir":"Articles","previous_headings":"","what":"5. Spatio-temporal variability of δ13C\\delta 13C and δ15N\\delta 15N modelled isoscapes in the Northeast Pacific","title":"Stable Isotope Trajectory Analysis (SITA)","text":"section, illustrate use trajectory metrics characterize spatio-temporal variability δ13C\\delta 13C δ15N\\delta 15N modelled isoscapes Northeast Pacific isoscape trajectory map trajectory heat map datasets used application come : Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.., 2020. Defining isoscapes Northeast Pacific index ocean productivity. Global Ecol Biogeogr 29, 246–261. Briefly, Espinasse et al. (2020) tested application isoscapes modelled satellite data description secondary production Northeast pacific. output model fits 0.25° x 0.25° spatial grid covering region spanning 46 62°N 195 235°E supporting δ13C\\delta13C δ15N\\delta15N isoscapes 1998 2017. subset modelled δ13C\\delta13C δ15N\\delta15N values 1° x 1° spatial grid original modelled dataset. Isoscapes modelled 2013, 2015 2017 selected characterised high stable isotope dynamics consequently constitutes relevant inputs test isoscape trajectory map concept. Additionally, long-term SITA analysis performed 1998 2017 using directions net changes calculated pairs dates (1998-1999,… ,2016-2017) input trajectory heat map.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"isoscape-trajectory-maps","dir":"Articles","previous_headings":"5. Spatio-temporal variability of δ13C\\delta 13C and δ15N\\delta 15N modelled isoscapes in the Northeast Pacific","what":"5.1 2013-2015 Isoscape trajectory maps","title":"Stable Isotope Trajectory Analysis (SITA)","text":"begin loading package dataset isoscape: calculate Segment lengths Angle α\\alpha stations assess, respectively, magnitude nature change stable isotope space 2013 2015. prepare data set compute isoscape trajectory map notably: Latitude, Longitude, Years, Angles segment lenghts values: Angles α\\alpha need transformed use geom_spoke. add transformed values new column Angles2. now create Isoscape trajectory map. kind map, Segment lengths Angles α\\alpha mapped illustrate stable isotope spatio-temporal dynamics. Direction arrows (angle α\\alpha) illustrate direction (.e. nature change) modelled 2D Ωδ\\Omega \\delta space according increase /decrease δ13C\\delta13C δ15N\\delta15N values (0-90°: + δ13C\\delta13C + δ15N\\delta15N; 90-180°: + δ13C\\delta13C - δ15N\\delta15N; 90-180°: + δ13C\\delta13C - δ15N\\delta15N; 180-270°: + δ13C\\delta13C - δ15N\\delta15N). Length arrows colored background rasters illustrate modelled trajectory segment length station (.e. magnitude change).","code":"data(\"isoscape\") sites<-isoscape$station surveys<-isoscape$Year Angl<-trajectoryAngles2D(isoscape[,3:4],sites,surveys, betweenSegments = FALSE) Length<-trajectoryLengths2D(isoscape[,3:4],sites,surveys) data<-as.data.frame(cbind(isoscape[1:489,],Angl,Length[,1])) colnames(data)<-c(\"Latitude\",\"Longitude\",\"d13C\",\"d15N\",\"Stations\",\"Years\",\"Angles\",\"Lengths\") head(data) ##   Latitude Longitude      d13C     d15N Stations Years    Angles    Lengths ## 1       46       195 -24.24369 5.267485        1  2013 210.45063 0.31556226 ## 2       48       195 -24.32212 4.973764        3  2013 279.70681 0.28077863 ## 3       49       195 -24.28151 5.113458        4  2013 188.55168 0.03490337 ## 4       50       195 -24.30105 5.261582        5  2013 147.84429 0.25570108 ## 5       51       195 -24.05084 5.302065        6  2013 126.14883 0.32439073 ## 6       52       195 -23.92968 5.407169        7  2013  60.21061 0.28423495 angle<-data$Angles Angles2<-c() for (i in 1:length(angle)) {   Angles2[i] <- c(ifelse(angle[i]==0,(angle[i]-270)*pi/180,                          ifelse(angle[i]==180,(angle[i]-270)*pi/180,                                 ifelse(angle[i]==90,(angle[i]+270)*pi/180,                                        ifelse(angle[i]==270,(angle[i]+270)*pi/180,                                               ifelse(angle[i]==360,(angle[i]-270)*pi/180,                                                        ifelse(angle[i]>0 & angle[i]<90 ,(90-angle[i])*pi/180,                                                             ifelse(angle[i]>90 & angle[i]<180 ,(90-angle[i])*pi/180,                                                                    ifelse(angle[i]>180 & angle[i]<270,(180+(270-angle[i]))*pi/180,                                                                           ifelse(angle[i]>270 & angle[i]<360,(90+(360-angle[i]))*pi/180,\"ERROR\")))))))))) }  data$Angles2<-Angles2 ggplot(data,            aes(x = Longitude,                y = Latitude,                fill = Lengths,                angle = Angles2,                radius = rescale(Lengths, c(0.3, 1)))) +   geom_raster(interpolate = TRUE) +   geom_spoke(arrow = arrow(length = unit(.07, 'inches'))) +    scale_fill_distiller(palette = \"RdYlBu\") +    coord_equal(expand = 0) +    theme(legend.position = 'bottom',          legend.direction = 'horizontal',         panel.background = element_rect(fill = \"white\"))"},{"path":"https://emf-creaf.github.io/ecotraj/articles/SITA.html","id":"trajectory-heatmap","dir":"Articles","previous_headings":"5. Spatio-temporal variability of δ13C\\delta 13C and δ15N\\delta 15N modelled isoscapes in the Northeast Pacific","what":"5.2 1998-2017 trajectory heatmap","title":"Stable Isotope Trajectory Analysis (SITA)","text":"begin loading package dataset heatmapdata: heatmapdata composed trajectory metrics stations within inter-annual consecutive periods 1998 2017: prepare data set create trajectory heat map. create vector direction, ranging 15° 0 360°, class Angle α\\alpha values. create vector ISPattern characterize pattern direction according changes stable isotope values (0-90°: + δ13C\\delta13C + δ15N\\delta15N; 90-180°: + δ13C\\delta13C - δ15N\\delta15N; 90-180°: + δ13C\\delta13C - δ15N\\delta15N; 180-270°: + δ13C\\delta13C - δ15N\\delta15N): final dataset used create trajectory heat map composed four variables (“Directions”,“Periods”,“Nb_stations”,“Lengths”): plot trajectory metrics respect period direction trajectory heat map. Angles α\\alpha modelled 2D Ωδ\\Omega \\delta space exhibited stations within pairs dates (1998-1999,…,2016-2017) represented range direction (15°) according period. Color gradient dark blue yellow indicate number stations exhibited given range direction within given period.  X bar plot represents sum segment lengths across stations times, 1231 exhibiting chosen angle. blue gradient indicates net change magnitude.  Y bar plot represents overall net changes according range directions (angle α\\alpha). Bars colored according increase /decrease δ13C\\delta13C δ15N\\delta15N values (Pink: 0-90°: + δ13C\\delta13C + δ15N\\delta15N ; Blue: 90-180°: + δ13C\\delta13C - δ15N\\delta15N; Red: 90-180°: + δ13C\\delta13C - δ15N\\delta15N; Green: 180-270°: + δ13C\\delta13C - δ15N\\delta15N).","code":"data(\"heatmapdata\") head(heatmapdata) ##   Latitude Longitude      d13C     d15N Stations     Years    Angles    Lengths ## 1       46       195 -24.76366 5.451872        1 1998-1999 181.31874 0.30196921 ## 2       47       195 -24.75540 5.334980        2 1998-1999 213.76898 0.09285079 ## 3       48       195 -24.51122 5.382608        3 1998-1999 183.00600 0.24017740 ## 4       49       195 -24.46314 5.481623        4 1998-1999 169.30735 0.34248078 ## 5       50       195 -24.27419 5.893179        5 1998-1999 174.57293 0.81250282 ## 6       51       195 -24.19454 5.780701        6 1998-1999  13.28445 0.96866737 ##     Angles2 ## 1  4.689373 ## 2  4.123009 ## 3  4.659924 ## 4 -1.384174 ## 5 -1.476076 ## 6  1.338939 #direction range deg <- 15  dir.breaks <- c(0,15,30,45,60,75,90,105,120,135,150,165,180,195,210,225,240,255,270,285,300,315,330,345,360)   dir.binned <- cut(heatmapdata$Angles,                   breaks = dir.breaks,                   ordered_result = TRUE)  # bar labels dir.labels <- as.character(c(seq(0, 360-deg, by = deg),0))  levels(dir.binned) <- dir.labels  heatmapdata$dir.binned <- dir.binned  data<-heatmapdata[,c(6,7,8,10)]  #direction vs SI patterns data<-data[order(data$dir.binned, decreasing=FALSE),] rownames(data)<-1:9206 data$ISpattern<- c(rep(\"+d13C/+d15N\",2862),rep(\"+d13C/-d15N\",1840),rep(\"-d13C/-d15N\",2931), rep(\"-d13C/+d15N\",1573))  data1<-as.data.frame(table(data$dir.binned,data$Years))  data2<-aggregate(x = data$Lengths, by = list(data$dir.binned, data$Years), FUN=sum, drop=FALSE) data2[is.na(data2)] <- 0    data1$Lengths<-data2$x dfa<-data1 colnames(dfa)<-c(\"Directions\",\"Periods\",\"Nb_stations\",\"Lengths\") head(dfa) ##   Directions   Periods Nb_stations   Lengths ## 1          0 1998-1999          12  8.634497 ## 2         15 1998-1999           9 11.096406 ## 3         30 1998-1999           7  7.927697 ## 4         45 1998-1999           8 11.138909 ## 5         60 1998-1999           4  1.861980 ## 6         75 1998-1999           4  1.835733 ggplot(dfa, aes(Periods, Directions, fill= Nb_stations)) +    geom_tile() +   scale_fill_viridis(discrete=FALSE) +   theme_minimal()+   theme(axis.text.x = element_text(size=10, angle=90)) df.Xbarplot<-aggregate(dfa$Lengths, by = list(dfa$Periods), FUN = sum) colnames(df.Xbarplot)<-c(\"Periods\",\"Lengths\") bp.x <- ggplot(data = df.Xbarplot, aes(x = factor(Periods), y = Lengths)) +    geom_bar(stat = \"identity\", aes(fill = Lengths)) + theme_minimal() +   theme(axis.text.x = element_text(size = 10,angle=90),          axis.title.x = element_text(size = 20, margin = margin(10,0,0,0))) +   labs(x = \"Periods\") bp.x df.Ybarplot<-aggregate(dfa$Lengths, by = list(dfa$Directions), FUN = sum) colnames(df.Ybarplot)<-c(\"Directions\",\"Lengths\") df.Ybarplot$ISpattern<- c(rep(\"+d13C/+d15N\",6),rep(\"+d13C/-d15N\",6),rep(\"-d13C/-d15N\",6), rep(\"-d13C/+d15N\",6))   bp.y <- ggplot(data = df.Ybarplot, aes(x = factor(Directions), y = Lengths,fill = ISpattern)) +    geom_bar(stat=\"identity\") + theme_minimal() + coord_flip() bp.y"},{"path":"https://emf-creaf.github.io/ecotraj/articles/Transformation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"1. Introduction","title":"Transformation of dissimilarities in community data","text":"dissimilarity coefficients popular community ecology, percentage difference (alias Bray-Curtis), drawback non-Euclidean (dissimilarity matrices allow representation Cartesian space), even semi-metric (.e. triangle inequality ensured). order use coefficients multivariate analyses require properties transformation original space normally order. section, compare different alternatives provide recommendations issue.","code":"library(ecotraj) ## Loading required package: Rcpp"},{"path":"https://emf-creaf.github.io/ecotraj/articles/Transformation.html","id":"effect-of-square-root-on-a-simple-directional-trajectory","dir":"Articles","previous_headings":"","what":"2. Effect of square root on a simple directional trajectory","title":"Transformation of dissimilarities in community data","text":", use example single synthetic community illustrate effect square root transformation community trajectory. begin defining species data trajectory . dataset consists four rows (.e. surveys) four columns (species). dynamics example consist constant increase number individuals first species corresponding decrease others, keeping total abundance 100 individuals: now use function vegdist package vegan calculate Bray-Curtis coefficient: dissimilarity matrix metric, one need transformation CTA. However, good example illustrate effect square root transformation. draw resemblance space corresponding dissimilarity matrix see straight trajectory: see Bray-Curtis dissimilarity responds linearly proposed sequence community dynamics. confirm geometry, can calculate geometric properties trajectory (.e. length, angle consecutive segments overall directionality): Angles 0 degrees overall directionality maximum (.e. 1), accordance plot data. now proceed take square root dissimilarity values, necessary achieve metric (Euclidean) space complex data set: transformation increases dissimilarity values (original values smaller 1), increase larger smaller values, ratio large dissimilarities small dissimilarities decreases. effect overall shape trajectory, surprisingly now looks like:  addition distortion observed, number dimensions data increased (.e sum variance explained two axes 88% < 100%), sure angles well represented. re-calculate properties trajectory taking account dimensions obtain: length segments trajectory increased, segments length, agreement original trajectory. contrast, angles now 90 degrees overall directionality decreased substantially.","code":"sites = rep(1,4) surveys=1:4 spdata = rbind(c(35,30,20,15),                c(50,25,15,10),                c(65,20,10,5),                c(80,15,5,0)) D = vegan::vegdist(spdata, \"bray\") is.metric(D) ## [1] TRUE D ##      1    2    3 ## 2 0.15           ## 3 0.30 0.15      ## 4 0.45 0.30 0.15 trajectoryPCoA(D,sites,surveys, survey.labels = T) trajectoryLengths(D,sites,surveys) ##     S1   S2   S3 Trajectory ## 1 0.15 0.15 0.15       0.45 trajectoryAngles(D,sites,surveys) ##   S1-S2 S2-S3 mean sd rho ## 1     0     0    0  0   1 trajectoryDirectionality(D,sites,surveys) ## 1  ## 1 sqrtD = sqrt(D) sqrtD ##           1         2         3 ## 2 0.3872983                     ## 3 0.5477226 0.3872983           ## 4 0.6708204 0.5477226 0.3872983 trajectoryPCoA(sqrtD,sites,surveys, survey.labels = T) trajectoryLengths(sqrtD,sites,surveys) ##          S1        S2        S3 Trajectory ## 1 0.3872983 0.3872983 0.3872983   1.161895 trajectoryAngles(sqrtD,sites,surveys) ##   S1-S2 S2-S3 mean sd rho ## 1    90    90   90  0   1 trajectoryAngles(sqrtD,sites,surveys, all=TRUE) ##   A1 A2 A3 A4 mean sd rho ## 1 90 90 90 90   90  0   1 trajectoryDirectionality(sqrtD,sites,surveys) ##   1  ## 0.5"},{"path":"https://emf-creaf.github.io/ecotraj/articles/Transformation.html","id":"effect-of-different-transformations-on-more-complex-trajectories","dir":"Articles","previous_headings":"","what":"3. Effect of different transformations on more complex trajectories","title":"Transformation of dissimilarities in community data","text":"use simulated data compare four transformation approaches: Local transformation semi-metric dissimilarities (percentage difference) every triplet triangle inequality required. done default CTA functions package vegclust. Global transformation dissimilarities, using square root. Global transformation dissimilarities using Principal Coordinates Analysis (classical multidimensional scaling) eigenvalue correction. Global transformation dissimilarities using metric multidimensional scaling (metric MDS). use simulated dynamics build another trajectory species (20) time steps. begin setting number time steps (50) size community (50 individuals): Nreplace number individuals replaced time step (5%). Now define initial community vector vector probabilities offspring species according ecological conditions: can now simulate dynamics sequentially applying stochastic deaths recruitment: decide frequently (respect simulated step) sample community taken, every four steps: Now ready calculate Bray-Curtis dissimilarity: complex trajectory, triangles may obey triangle inequality (depending simulation). can inspected using function .metric: Deviations metric space, exist, small, local transformation triangles small. Local transformations possible display trajectories. plot trajectory using function trajectoryPCoA global transformation principal coordinates analysis (PCoA) negative eigenvalue correction performed. fine display trajectories, problems measuring angular properties, see.  trajectory twists derived stochasticity death recruitment. Let’s now look square root Bray-Curtis dissimilarity:  Finally, also transform dissimilarities using metric multidimensional scaling (mMDS), provided package smacof:  three plots look different, differences striking (besides rotation issues). can compare stress global solutions: see square root leads strongest alteration original dissimilarities. calculate geometric properties limited ordination plots can take account dimensions. first call trajectoryAngles matrix D represents default strategy transforming triangles locally, involves weakest transformation can taken reference. square root PCoA negative eigenvalue correction induce strong transformation trajectory angles. global solution metric MDS leads angles similar local transformation strategy. inspect overall directionality, global solution metric MDS provides value closer local transformation, compared PCoA square root:","code":"Nsteps = 50 CC = 50 Nreplace <- CC*0.05 x <- c(0, 1, 0, 67, 1, 3, 0, 2, 2, 2, 1, 6, 2, 0, 0, 2, 5, 1, 6, 0) poffspring <- c(0, 0, 0.002, 0.661 ,0 ,0, 0.037, 0.281, 0, 0, 0, 0.008, 0, 0, 0.005, 0.003, 0, 0, 0, 0) m <- matrix(0, nrow=Nsteps+1, ncol=length(x)) m[1, ] = x for(k in 1:Nsteps) {   pdeath <-x/sum(x) #Equal probability of dying   deaths<-rmultinom(1,Nreplace, pdeath)   x <- pmax(x - deaths,0)   offspring = rmultinom(1,Nreplace, as.vector(poffspring))   x <- x + offspring   m[k+1, ]<-x } Sj <- seq(1,Nsteps+1, by=4) #Sample every four steps mj <- m[Sj,] surveys = 1:length(Sj) sites = rep(1,length(Sj)) D <- vegan::vegdist(mj,\"bray\") is.metric(D, tol=0.0000001) ## [1] TRUE pcoa<-trajectoryPCoA(D, sites, surveys, selection=1,length=0.1, axes=c(1,2), survey.labels = T) ## Warning in cmdscale(D2, eig = TRUE, add = TRUE, k = nrow(as.matrix(D2)) - : ## only 11 of the first 12 eigenvalues are > 0 ## Warning in arrows(x[niini], y[niini], x[nifin], y[nifin], ...): zero-length ## arrow is of indeterminate angle and so skipped pcoaD = dist(pcoa$points) sqrtD = sqrt(D) pcoaSqrt = trajectoryPCoA(sqrtD, sites, surveys, selection=1,length=0.1, axes=c(1,2), survey.labels = T) ## Warning in arrows(x[niini], y[niini], x[nifin], y[nifin], ...): zero-length ## arrow is of indeterminate angle and so skipped res <- smacof::mds(D, ndim = length(Sj)-1, type = \"interval\") mmdsD <- dist(res$conf) trajectoryPlot(res$conf, sites, surveys, selection=1,length=0.1, axes=c(1,2), survey.labels = T) ## Warning in arrows(xp[niini], yp[niini], xp[nifin], yp[nifin], ...): zero-length ## arrow is of indeterminate angle and so skipped smacof::stress0(D,pcoaSqrt$points, type=\"interval\") ##  ## Call: ## smacof::stress0(delta = D, init = pcoaSqrt$points, type = \"interval\") ##  ## Model: Symmetric SMACOF  ## Number of objects: 13  ## Stress-1 value: 0.077  ## Number of iterations: 0 smacof::stress0(D,pcoa$points, type=\"interval\") ##  ## Call: ## smacof::stress0(delta = D, init = pcoa$points, type = \"interval\") ##  ## Model: Symmetric SMACOF  ## Number of objects: 13  ## Stress-1 value: 0.007  ## Number of iterations: 0 smacof::stress0(D,res$conf, type=\"interval\") ##  ## Call: ## smacof::stress0(delta = D, init = res$conf, type = \"interval\") ##  ## Model: Symmetric SMACOF  ## Number of objects: 13  ## Stress-1 value: 0.013  ## Number of iterations: 0 anglesD = trajectoryAngles(D,sites,surveys) anglesSqrtD = trajectoryAngles(sqrtD,sites,surveys) anglesPcoaD = trajectoryAngles(pcoaD,sites,surveys) anglesmmdsD = trajectoryAngles(mmdsD,sites,surveys)  df<-as.data.frame(rbind(anglesD, anglesSqrtD, anglesPcoaD, anglesmmdsD)) row.names(df)<-c(\"local\", \"global.sqrt\", \"global.pcoa\", \"global.mmds\") round(df,2) ##             S1-S2  S2-S3  S3-S4 S4-S5  S5-S6  S6-S7 S7-S8 S8-S9 S9-S10 S10-S11 ## local        0.00  75.52  82.82  0.00  97.18 104.48  0.00  0.00    NaN     NaN ## global.sqrt 90.00 101.78 104.48 90.00 104.48 110.70 90.00 90.00    NaN     NaN ## global.pcoa 80.72  98.29 103.57 77.78 104.99 112.42 91.92 91.92 105.24  102.26 ## global.mmds 54.83  95.78  95.60 44.20  97.89 119.23 72.23 49.85  93.77   92.68 ##             S11-S12  mean   sd  rho ## local          0.00 38.10 0.83 0.71 ## global.sqrt   90.00 96.81 0.14 0.99 ## global.pcoa   80.72 95.46 0.19 0.98 ## global.mmds   21.88 76.70 0.50 0.88 trajectoryDirectionality(D,sites,surveys) ##         1  ## 0.8770056 trajectoryDirectionality(sqrtD,sites,surveys) ##         1  ## 0.4810576 trajectoryDirectionality(pcoaD,sites,surveys) ##         1  ## 0.5927582 trajectoryDirectionality(mmdsD,sites,surveys) ##         1  ## 0.7532264"},{"path":"https://emf-creaf.github.io/ecotraj/articles/Transformation.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"4. Conclusions","title":"Transformation of dissimilarities in community data","text":"small study compared effect different solutions violation triangle inequality. function .metric returns TRUE given data set one worry violations triangle inequality. Local solutions imply smallest number changes, consistent across triplets, users may desire apply global transformation produces euclidean spaces. done care. shown square root transformation distorts angles overall directionality trajectories space defined percentage difference (alias Bray-Curtis) dissimilarity index. suspect negative effect square root transformation angles happens matter coefficient used derive initial distance matrix. Therefore, advocate avoiding use conducting community trajectory analysis (particular angles). global transformation consisting application PCoA negative eigenvalue correction less strong square root, still strongly change angles segments. Perhaps, less harmful global transformation provided metric Multidimensional Scaling, need embed distances Euclidean space three transformations implies stronger requirement metric, results distortions.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Miquel De Cáceres. Author, maintainer. Anthony Sturbois. Author.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"De Cáceres M, Coll L, Legendre P, Allen R, Wiser S, Fortin M, Condit R, Hubbell S (2019). “Trajectory analysis community ecology.” Ecological Monographs, 89, e01350. doi:10.1002/ecm.1350. Sturbois , De Cáceres M, Sánchez-Pinillos M, Schaal G, Gauthier O, Le Mao P, Ponsero , Desroy N (2021). “Extending community trajectory analysis : New metrics representation.” Ecological Modelling, 440, 109400. doi:10.1016/j.ecolmodel.2020.109400. Sturbois , De Cáceres M, Bifolchi , Bioret F, Grall J, Grémare , Labrune C, Robert , Schaal G, Desroy N (2023). “Ecological Quality Assessment: general multivariate framework report quality ecosystems dynamics respect reference conditions.” Ecosphere.","code":"@Article{,   title = {Trajectory analysis in community ecology},   author = {Miquel {De Cáceres} and Lluís Coll and Pierre Legendre and Robert B. Allen and Susan K. Wiser and M.J. Fortin and Richard Condit and Stephen Hubbell},   journal = {Ecological Monographs},   year = {2019},   volume = {89},   pages = {e01350},   doi = {10.1002/ecm.1350}, } @Article{,   title = {Extending community trajectory analysis : New metrics and representation},   author = {Anthony Sturbois and Miquel {De Cáceres} and Martina Sánchez-Pinillos and Gauthier Schaal and Olivier Gauthier and P. {Le Mao} and A. Ponsero and Nicholas Desroy},   journal = {Ecological Modelling},   year = {2021},   volume = {440},   pages = {109400},   doi = {10.1016/j.ecolmodel.2020.109400}, } @Article{,   title = {Ecological Quality Assessment: a general multivariate framework to report the quality of ecosystems and their dynamics with respect to reference conditions},   author = {Anthony Sturbois and Miquel {De Cáceres} and A. Bifolchi and F. Bioret and J. Grall and A. Grémare and C. Labrune and A. Robert and Gauthier Schaal and Nicholas Desroy},   journal = {Ecosphere},   year = {2023}, }"},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Ecological Trajectory Analysis","text":"Package ecotraj package providing Ecological Trajectory Analysis (ETA), framework assist ecologists analysis temporal changes ecosystems defined chosen multivariate space. ETA related following publications: First presentation community trajectory analysis framework (De Cáceres et al. 2019). Extension community trajectory analysis (Sturbois et al. 2021a). Generalization stable isotope data (Sturbois et al. 2021b). Application ETA framework assessment ecological quality (Sturbois et al. 2023).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/index.html","id":"package-installation-and-documentation","dir":"","previous_headings":"","what":"Package installation and documentation","title":"Ecological Trajectory Analysis","text":"Package ecotraj can found CRAN. addition, latest stable ecotraj R package can also installed GitHub follows: Although package comes function documentation, articles explaining use package can found https://emf-creaf.github.io/ecotraj/.","code":"remotes::install_github(\"emf-creaf/ecotraj\")"},{"path":"https://emf-creaf.github.io/ecotraj/index.html","id":"related-package","dir":"","previous_headings":"","what":"Related package","title":"Ecological Trajectory Analysis","text":"R package ecoregime, Martina Sánchez-Pinillos, implements Ecological Dynamic Regimes (EDR) framework characterize compare groups ecological trajectories multidimensional spaces defined ecosystem state variables.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Ecological Trajectory Analysis","text":"De Cáceres, M., Coll, L., Legendre, P., Allen, R.B., Wiser, S.K., Fortin, M.J., Condit, R. & Hubbell, S. (2019). Trajectory analysis community ecology. Ecological Monographs 89, e01350 (https://doi.org/10.1002/ecm.1350). Sturbois, ., De Cáceres, M., Sánchez-Pinillos, M., Schaal, G., Gauthier, O., Le Mao, P., Ponsero, ., & Desroy, N. (2021a). Extending community trajectory analysis : New metrics representation. Ecological Modelling, 440, 109400 (https://doi.org/10.1016/j.ecolmodel.2020.109400). Sturbois, ., Cucherousset, J., De Cáceres, M., Desroy, N., Riera, P., Carpentier, ., Quillien, N., Grall, J., Espinasse, B., Cherel, Y., Schaal, G. (2021). Stable Isotope Trajectory Analysis (SITA) : new approach quantify visualize dynamics stable isotope studies. Ecological Monographs, 92, e1501 (https://doi.org/10.1002/ecm.1501). Sturbois, ., De Cáceres, M., Bifolchi, ., Bioret, F., Boyé, ., Gauthier, O., Grall, J., Grémare, ., Labrune, C., Robert, ., Schaal, G., Desroy, N. (2023). Ecological Quality Assessment: general multivariate framework report quality ecosystems dynamics respect reference conditions. Ecosphere 14, e4726 (https://doi.org/10.1002/ecs2.4726).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/avoca.html","id":null,"dir":"Reference","previous_headings":"","what":"Avoca permanent plot dataset — avoca","title":"Avoca permanent plot dataset — avoca","text":"Example dataset data 8 permanent forest plots located slopes valley New Zealand Alps. study area mountainous centered Craigieburn Range (Southern Alps), South Island, New Zealand. Forests plots almost monospecific, mountain beech (Fuscospora cliffortioides) main dominant tree species. Previously forests consisted largely mature stands, affected different disturbances sampling period (1972-2009) includes 9 surveys.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/avoca.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Avoca permanent plot dataset — avoca","text":"Three data items included: avoca_strat object class stratifiedvegdata (see function stratifyvegdata package 'vegclust') structural compositional data. avoca_sites vector identifying sampled sites element avoca_strat. avoca_surveys vector identifying surveys element avoca_strat.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/avoca.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Avoca permanent plot dataset — avoca","text":"New Zealand National Vegetation Survey (NVS) Databank (https://nvs.landcareresearch.co.nz/).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/avoca.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Avoca permanent plot dataset — avoca","text":"Allen, R. B., P. J. Bellingham, S. K. Wiser. 1999. Immediate damage earthquake temperate montane forest. Ecology 80:708–714. Harcombe, P. ., R. B. Allen, J. . Wardle, K. H. Platt. 1998. Spatial temporal patterns stand structure, biomass, growth mortality monospecific Nothofagus solandri var. cliffortioides (Hook. f.) Poole forest New Zealand. Journal Sustainable Forestry 6:313–343. Hurst, J. M., R. B. Allen, D. . Coomes, R. P. Duncan. 2011. Size-specific tree mortality varies neighbourhood crowding disturbance montane Nothofagus forest. PLoS ONE 6.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/ecotraj-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ecotraj: Ecological Trajectory Analysis — ecotraj-package","title":"ecotraj: Ecological Trajectory Analysis — ecotraj-package","text":"Assists ecologists analysis temporal changes ecosystems, defined trajectories chosen multivariate space","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/ecotraj-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ecotraj: Ecological Trajectory Analysis — ecotraj-package","text":"De Caceres et al., 2019 (doi:10.1002/ecm.1350 ), Sturbois et al., 2021 (doi:10.1016/j.ecolmodel.2020.109400 )","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/ecotraj-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ecotraj: Ecological Trajectory Analysis — ecotraj-package","text":"Maintainer: Miquel De Cáceres miquelcaceres@gmail.com ORCID Authors: Anthony Sturbois","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/furseals.html","id":null,"dir":"Reference","previous_headings":"","what":"furseals dataset — furseals","title":"furseals dataset — furseals","text":"subset data sets Kernaléguen et al. (2015).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/furseals.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"furseals dataset — furseals","text":"furseals object class data.frame composed 1414 observations 8 variables. ID_SITA Fur seal ID used Sturbois et al. (review), 1 47 ID Fur seal ID used Kernaléguen et al. (2015) initial data set. Species Fur seal species: Antarctic fur seal Arctocephalus gazella subantarctic fur seal . tropicalis. Sexe Fur seal gender, either 'Male' 'Female'. Time Number whisker sections 1 30. Place Breeding place: Crozet, Amsterdam Kerguelen d13C delta 13C value d15N delta 15N value","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/furseals.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"furseals dataset — furseals","text":"Briefly, fur seals Antarctic fur seal Arctocephalus gazella subantarctic fur seal . tropicalis whisker SI values yield unique long-term information individual behaviour integrates spatial, trophic temporal dimensions ecological niche. foraging strategies two species sympatric fur seals examined winter 2001/2002 Crozet, Amsterdam Kerguelen Islands (Southern Ocean) using stable isotope values serially sampled whiskers. subset initial data set composed consecutive whisker sections (3 mm-long) starting proximal (facial) end, recently synthesized tissue remaining skin. individuals (n = 47) whiskers totalizing least 30 sections selected initail data, 30 sections selected.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/furseals.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"furseals dataset — furseals","text":"Kernaléguen, L., Arnould, J.P.Y., Guinet, C., Cherel, Y., 2015. Determinants individual foraging specialization inlarge marine vertebrates, Antarctic subantarctic fur seals. Journal Animal Ecology 1081–1091.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/furseals.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"furseals dataset — furseals","text":"Kernaléguen, L., Arnould, J.P.Y., Guinet, C., Cherel, Y.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/glenan.html","id":null,"dir":"Reference","previous_headings":"","what":"Glenan dataset — glenan","title":"Glenan dataset — glenan","text":"Maerl bed data set illustrate Ecological Quality Assessment (EQA)","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/glenan.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Glenan dataset — glenan","text":"Glenan object class data.frame composed 32 observations 252 variables. Abundance.x Abundance (number individuals) taxon x Surveys Indicates different Maerl bed surveys. Treatment Combinations fishing dredges pressure levels. 'CTRL' stands control. Fishing dredges : (1) clam dredge (CD), 70 90 kg, 1.5 m wide, 40 teeth 11 cm ; (2) queen scallop dredge (QSD), 120 kg,1.8 m wide, blade; (3) king scallop dredge (KSD), 190 kg, 1.8 m wide, 18 teeth 10 cm every 9 cm.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/glenan.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Glenan dataset — glenan","text":"Experimental data set built Tauran et al. (2020) study impact fishing dredges varying fishing pressures maerl beds, bay Brest (Brittany, France).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/glenan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Glenan dataset — glenan","text":"Tauran, ., Dubreuil, J., Guyonnet, B., Grall, J., 2020. Impact fishing gears fishing intensities maerl beds: experimental approach. Journal Experimental Marine Biology Ecology 533, 151472. https://doi.org/10.1016/j.jembe.2020.151472","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/glomel.html","id":null,"dir":"Reference","previous_headings":"","what":"Glomel vegetation dataset — glomel","title":"Glomel vegetation dataset — glomel","text":"Vegetation data set illustrate Ecological Quality Assessment (EQA)","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/glomel.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Glomel vegetation dataset — glomel","text":"Glomel object class data.frame composed 23 observations 46 variables. ID Station ID. Ref Logical flag indicate stations used define reference envelope. Complementary Comments regarding quality ecosystem. ... Percent cover values (derived Braun-Blanquet ordinal scale) 43 species vascular plants.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/glomel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Glomel vegetation dataset — glomel","text":"nature reserve Landes et Marais de Glomel (Brittany, France) composed temperate Atlantic wet heaths whose reference state commonly considered dominated plant communities associated acid, nutrient poor soils least seasonally water logged dominated Erica tetralix E. ciliaris. data set consists 23 rows 46 columns. first five stations (rows) used define reference envelope, next 18 stations (rows) conservation status assessed.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/glomel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Glomel vegetation dataset — glomel","text":"Aline Bifolchi, Réserve Naturelle des landes et marais de Glomel","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/heatmapdata.html","id":null,"dir":"Reference","previous_headings":"","what":"heatmapdata dataset — heatmapdata","title":"heatmapdata dataset — heatmapdata","text":"Espinasse et al. (2020) tested application isoscapes modelled satellite data description secondary production Northeast pacific. output model fits 0.25° x 0.25° spatial grid covering region spanning 46 62°N 195 235°E supporting delta 13C delta 15N isoscapes 1998 2017.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/heatmapdata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"heatmapdata dataset — heatmapdata","text":"heatmapdata object class dataframe composed 9206 observations 9 variables. Latitude Latitude coordinate station, degrees Longitude Longitude coordinate station, degrees d13C delta 13C modelled value d15N delta 15N modelled value station Station ID Years Period corresponding calculation trajectory metrics Angles Angle alpha (.e direction) stable isotope space Lengths Net change values (.e direction) stable isotope space Angles2 Angle alpha values (.e direction) stable isotope space transformed potential use function geom_spoke","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/heatmapdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"heatmapdata dataset — heatmapdata","text":"data sets composed trajectory metrics calculated Sturbois et al. (2021) stations within inter-annual consecutive periods 1998 2017 calculated whole data set Espinasse et al. (2020) 1° x 1° spatial grid.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/heatmapdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"heatmapdata dataset — heatmapdata","text":"Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.., 2020. Defining isoscapes Northeast Pacific index ocean productivity. Global Ecol Biogeogr 29, 246–261.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/heatmapdata.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"heatmapdata dataset — heatmapdata","text":"Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E..","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/isoscape.html","id":null,"dir":"Reference","previous_headings":"","what":"isoscape dataset — isoscape","title":"isoscape dataset — isoscape","text":"data sets subset Espinasse et al. (2020).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/isoscape.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"isoscape dataset — isoscape","text":"isoscape object class dataframe composed 978 observations 6 variables. Latitude Latitude coordinate station, degrees Longitude Longitude coordinate station, degrees d13C delta 13C modelled value d15N delta 15N modelled value station station ID Year Year corresponding modelled stable isotope values","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/isoscape.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"isoscape dataset — isoscape","text":"Briefly, Espinasse et al. (2020) tested application isoscapes modelled satellite data description secondary production Northeast pacific. output model fits 0.25° x 0.25° spatial grid covering region spanning 46 62°N 195 235°E supporting delta 13C delta 15N isoscapes 1998 2017. subset composed modelled  delta 13C delta 15N values 1° x 1° spatial grid original modelled dataset 2013 2015.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/isoscape.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"isoscape dataset — isoscape","text":"Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.., 2020. Defining isoscapes Northeast Pacific index ocean productivity. Global Ecol Biogeogr 29, 246–261.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/isoscape.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"isoscape dataset — isoscape","text":"Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E..","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/pike.html","id":null,"dir":"Reference","previous_headings":"","what":"pike dataset — pike","title":"pike dataset — pike","text":"data sets comes Cucherousset et al. (2013).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/pike.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"pike dataset — pike","text":"pike object class dataframe composed 58 observations 10 variables. trophic_status_initial Initial trophic status release ID ID used individual Cucherousset et al. (2013) Time Time stable isotope measurement: 1 (Release) 2 (Departure) Time_L Time stable isotope measurement string, either 'Release' 'Departure' Date Date release (common individuals) recapture (variable dependind date departure) Size_mm Size (length) juvenile pike, mm d13C delta 13C values d15N delta 15N values Residence_time Number days release recapture Trophic_status_final Trophic status end study","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/pike.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"pike dataset — pike","text":"Briefly, Cucherousset et al. (2013) released 192 individually tagged, hatchery-raised, juvenile pike (Esox lucius L.) variable initial trophic position (fin delta 13C/delta 15N values). Based delta values, individuals classified zooplanktivorous (delta 15N < 10 ‰) piscivorous (delta 15N > 10 ‰) cannibalism commonly observed species. Individuals released temporarily flooded grassland pike eggs usually hatch Brière marsh (France) identify determinants juvenile natal departure. release site connected unique point adjacent pond used nursery habitat. Fish continuously recaptured migrating flooded grassland adjacent pond. Recaptured individuals (n = 29) anaesthetized, checked tags, measured fork length, fin-clipped quantify changes delta 13C delta 15N values, released.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/pike.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"pike dataset — pike","text":"Cucherousset, J., Paillisson, J.-M., Roussel, J.-M., 2013. Natal departure timing spatially varying environments dependent individual ontogenetic status. Naturwissenschaften 100, 761–768.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/pike.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"pike dataset — pike","text":"Cucherousset, J., Paillisson, J.-M., Roussel, J.-M.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":null,"dir":"Reference","previous_headings":"","what":"Ecological quality assessment — referenceEnvelopes","title":"Ecological quality assessment — referenceEnvelopes","text":"Functions assess variability ecological reference envelopes assess ecological quality target stations/observations respect reference envelopes (Sturbois et al., review).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ecological quality assessment — referenceEnvelopes","text":"","code":"trajectoryEnvelopeVariability(   d,   sites,   surveys = NULL,   nboot.ci = NULL,   alpha.ci = 0.05,   ... )  stateEnvelopeVariability(d, nboot.ci = NULL, alpha.ci = 0.05)  compareToTrajectoryEnvelope(   d,   sites,   envelope,   surveys = NULL,   m = 1.5,   nboot.ci = NULL,   alpha.ci = 0.05,   distances_to_envelope = FALSE,   distance_percentiles = FALSE,   ... )  compareToStateEnvelope(   d,   envelope,   m = 1.5,   nboot.ci = NULL,   alpha.ci = 0.05,   distances_to_envelope = FALSE,   distance_percentiles = FALSE,   ... )"},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ecological quality assessment — referenceEnvelopes","text":"d symmetric matrix object class dist containing distance values pairs ecosystem states (see details). sites vector indicating site corresponding ecosystem state. surveys vector indicating survey corresponding ecosystem state (necessary surveys order). nboot.ci Number bootstrap samples confidence intervals. nboot.ci = NULL confidence intervals estimated. alpha.ci Error confidence intervals. ... Additional parameters function trajectoryDistances envelope vector indicating set sites conform reference envelope (sites compared envelope) m Fuzziness exponent quality value assessment distances_to_envelope Flag indicate distances envelope included result distance_percentiles Flag include percentage distances envelope (among sites corresponding reference) smaller site.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ecological quality assessment — referenceEnvelopes","text":"Functions stateEnvelopeVariability trajectoryEnvelopeVariability used assess Functions compareToStateEnvelope compareToTrajectoryEnvelope return data frame columns identifying envelope Q statistic ecological quality respect envelope. nboot.ci != NULL extra columns added indicate boundaries confidence interval Q, built using bootstrap samples reference envelope.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ecological quality assessment — referenceEnvelopes","text":"Functions stateEnvelopeVariability trajectoryEnvelopeVariability used assess variability reference envelopes. Functions compareToStateEnvelope compareToTrajectoryEnvelope used evaluate ecological quality stations/observations respect predefined reference envelope.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Ecological quality assessment — referenceEnvelopes","text":"Sturbois, ., De Cáceres, M., Bifolchi, ., Bioret, F., Boyé, ., Gauthier, O., Grall, J., Grémare, ., Labrune, C., Robert, ., Schaal, G., Desroy, N. (2023). Ecological Quality Assessment: general multivariate framework report quality ecosystems dynamics respect reference conditions. Ecosphere.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ecological quality assessment — referenceEnvelopes","text":"Miquel De Cáceres, CREAF Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ecological quality assessment — referenceEnvelopes","text":"","code":"data(glomel)   # Extract compositional data matrix glomel_comp <- as.matrix(glomel[,!(names(glomel) %in% c(\"ID\", \"Ref\", \"Complementary\"))]) rownames(glomel_comp) <- glomel$ID   # Calculate Bray-Curtis distance matrix  glomel_bc <- vegan::vegdist(glomel_comp, method = \"bray\")   # Define reference envelope (5 stations) by observation ID glomel_env <- glomel$ID[glomel$Ref]   # Assess quality with respect to reference envelope compareToStateEnvelope(glomel_bc, glomel_env) #>    Observation Envelope          Q #> 1           1A     TRUE 1.00000000 #> 2           1B     TRUE 0.76613763 #> 3           1C     TRUE 0.57229876 #> 4           5A     TRUE 1.00000000 #> 5           13     TRUE 0.81917760 #> 6            2    FALSE 0.58055183 #> 7           3A    FALSE 0.43311585 #> 8           3B    FALSE 1.00000000 #> 9           3C    FALSE 0.45442188 #> 10          5B    FALSE 0.33022033 #> 11          6A    FALSE 0.05927157 #> 12          6C    FALSE 0.38424518 #> 13          6D    FALSE 0.04056616 #> 14          7A    FALSE 0.06641490 #> 15          8A    FALSE 0.18922894 #> 16          8B    FALSE 0.14419258 #> 17          8C    FALSE 0.02968524 #> 18           9    FALSE 0.12972756 #> 19          10    FALSE 0.76985523 #> 20          11    FALSE 0.57670446 #> 21          12    FALSE 1.00000000 #> 22         14A    FALSE 0.65528979 #> 23         14B    FALSE 0.13022565"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorySmoothing.html","id":null,"dir":"Reference","previous_headings":"","what":"Trajectory smoothing — trajectorySmoothing","title":"Trajectory smoothing — trajectorySmoothing","text":"Trajectory smoothing using Gaussian kernel","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorySmoothing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trajectory smoothing — trajectorySmoothing","text":"","code":"trajectorySmoothing(   d,   sites,   surveys = NULL,   survey_times = NULL,   kernel_scale = 1,   fixed_endpoints = TRUE )"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorySmoothing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trajectory smoothing — trajectorySmoothing","text":"d symmetric matrix object class dist containing distance values pairs ecosystem states. sites vector indicating site corresponding ecosystem state. surveys vector indicating survey corresponding ecosystem state (necessary surveys order). survey_times vector indicating survey time surveys (NULL, time consecutive surveys considered one) kernel_scale Scale Gaussian kernel, related survey times fixed_endpoints logical flag force keeping location trajectory endpoints unmodified","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorySmoothing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trajectory smoothing — trajectorySmoothing","text":"object class dist","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"Ecological Trajectory Analysis (ETA) framework analyze dynamics ecosystems described trajectories chosen space multivariate resemblance (De Cáceres et al. 2019). ETA takes trajectories objects analyzed compared geometrically.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"","code":"segmentDistances(   d,   sites,   surveys = NULL,   distance.type = \"directed-segment\",   add = TRUE,   verbose = FALSE )  trajectoryDistances(   d,   sites,   surveys = NULL,   distance.type = \"DSPD\",   symmetrization = \"mean\",   add = TRUE,   verbose = FALSE )  trajectoryLengths(   d,   sites,   surveys = NULL,   relativeToInitial = FALSE,   all = FALSE,   verbose = FALSE )  trajectoryLengths2D(   xy,   sites,   surveys,   relativeToInitial = FALSE,   all = FALSE,   verbose = FALSE )  trajectoryAngles(   d,   sites,   surveys = NULL,   all = FALSE,   relativeToInitial = FALSE,   stats = TRUE,   add = TRUE,   verbose = FALSE )  trajectoryAngles2D(   xy,   sites,   surveys,   relativeToInitial = FALSE,   betweenSegments = TRUE )  trajectoryProjection(d, target, trajectory, tol = 1e-06, add = TRUE)  trajectoryConvergence(   d,   sites,   surveys = NULL,   symmetric = FALSE,   add = TRUE,   verbose = FALSE )  trajectoryDirectionality(d, sites, surveys = NULL, add = TRUE, verbose = FALSE)"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"d symmetric matrix object class dist containing distance values pairs ecosystem states (see details). sites vector indicating site corresponding ecosystem state. surveys vector indicating survey corresponding ecosystem state (necessary surveys order). distance.type type distance index calculated (Besse et al. 2016; De Cáceres et al. submitted). segmentDistances available indices : Hausdorff: Hausdorff distance two segments. directed-segment: Directed segment distance (default). PPA: Perpendicular-parallel-angle distance. whereas trajectoryDistances available indices : Hausdorff: Hausdorff distance two trajectories. SPD: Segment path distance. DSPD: Directed segment path distance (default). add Flag indicate constant values added (local transformation) correct triplets distance values fulfill triangle inequality. verbose Provides console output informing process (useful large dataset). symmetrization Function used obtain symmetric distance, DSPD(T1,T2) = DSPD(T2,T1) (e.g., mean min). symmetrization = NULL symmetrization conducted output dissimilarity matrix symmetric. relativeToInitial Flag indicate lengths angles calculated respect initial survey. flag indicate angles desired triangles (.e. pairs segments) trajectory. FALSE, angles calculated consecutive segments . xy Matrix 2D coordinates Cartesian space (typically ordination ecosystem states). stats flag indicate circular statistics desired (mean, standard deviation mean resultant length, .e. rho) betweenSegments Flag indicate angles calculated trajectory segments respect X axis. target integer vector ecosystem states projected. trajectory integer vector trajectory onto target states projected. tol Numerical tolerance value determine projection point lies within trajectory. symmetric logical flag indicate symmetric convergence comparison trajectories.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"Function trajectoryDistances returns object class dist containing distances trajectories (symmetrization = NULL object returned class matrix). Function trajectorySegments returns list following elements: Dseg: Distance matrix segments. Dini: Distance matrix initial points segments. Dfin: Distance matrix final points segments. Dinifin: Distance matrix initial points one segment final point . Dfinini: Distance matrix final points one segment initial point . Function trajectoryLengths returns data frame length segment trajectory total length trajectories. relativeToInitial = TRUE lengths calculated initial survey surveys. = TRUE lengths calculated segments. Function trajectoryLengths2D returns data frame length segment trajectory total length trajectories. relativeToInitial = TRUE lengths calculated initial survey surveys. = TRUE lengths calculated segments. Function trajectoryAngles returns data frame angle values trajectory. stats=TRUE, mean, standard deviation mean resultant length angles also returned. Function trajectoryAngles2D returns data frame angle values trajectory. betweenSegments=TRUE, angles calculated trajectory segments, alternatively, betweenSegments=FALSE, angles calculated considering Y axis North (0°). Function trajectoryProjection returns data frame following columns: distanceToTrajectory: Distances trajectory, .e. rejection (NA target points whose projection outside trajectory). segment: Segment includes projected point (NA target points whose projection outside trajectory). relativePosition: Relative position projected point within trajectory, .e. values 0 1 0 representing start trajectory 1 representing end (NA target points whose projection outside trajectory). Function trajectoryConvergence returns list two elements: tau: matrix statistic (Mann-Kendall's tau) convergence/divergence test trajectories. symmetric=TRUE matrix square. Otherwise statistic test row trajectory approaching column trajectory. p.value: matrix p-value convergence/divergence test trajectories. symmetric=TRUE matrix square. Otherwise p-value indicates test row trajectory approaching column trajectory. Function trajectoryDirectionality returns vector directionality values (one per trajectory).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"Given distance matrix ecosystem states, set functions provide ETA metrics : Functions segmentDistances trajectoryDistances calculate distance pairs directed segments ecosystem trajectories, respectively. Function trajectoryLengths calculates lengths directed segments total path lengths trajectories. Function trajectoryLengths2D calculates lengths directed segments total path lengths trajectories 2D coordinates given input. Function trajectoryAngles calculates angle consecutive pairs directed segments segments ordered triplets points. Function trajectoryAngles2D calculates angle consecutive pairs directed segments segments ordered triplets points. Function trajectoryProjection projects set target points onto specified trajectory returns distance trajectory (.e. rejection) relative position projection point within trajectory. Function trajectoryConvergence performs Mann-Kendall trend test distances trajectories (symmetric test) distance points one trajectory . Function trajectoryDirectionality returns (trajectory) statistic measures directionality whole trajectory. Details calculations given De Cáceres et al (2019). input distance matrix d ideally metric. , subsets distance triplets fulfill triangle inequality (see utility function .metric). ETA functions require metricity include parameter 'add', default TRUE, meaning whenever triangle inequality broken minimum constant required fulfill added three distances. local (hence, inconsistent across triplets) corrections desired, users find another way modify d achieve metricity, PCoA, metric MDS non-metric MDS (see vignette 'Introduction Ecological Trajectory Analysis'). parameter 'add' set FALSE problems triangle inequality exist, ETA functions may provide missing values cases . resemblance trajectories done adapting concepts procedures used analysis trajectories space (.e. movement data) (Besse et al. 2016). Function trajectoryAngles calculates angles consecutive segments degrees. pair segments, angle two defined plane contains two segments, measures change direction (degrees) one segment . Angles always positive, zero values indicating segments straight line, values equal 180 degrees segments opposite directions. = TRUE angles calculated segments corresponding ordered triplets. Alternatively, relativeToInitial = TRUE angles calculated segment respect initial survey. Function trajectoryAngles2D calculates angles consecutive segments degrees 2D coordinates given input. pair segments, angle two defined plane contains two segments, measures change direction (degrees) one segment . Angles always positive (O 360), zero values indicating segments straight line, values equal 180 degrees segments opposite directions. = TRUE angles calculated segments corresponding ordered triplets. Alternatively, relativeToInitial = TRUE angles calculated segment respect initial survey. betweenSegments = TRUE angles calculated segments trajectory, otherwise, betweenSegments = FALSE, angles calculated considering Y axis North (0°).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"Besse, P., Guillouet, B., Loubes, J.-M. & François, R. (2016). Review perspective distance based trajectory clustering. IEEE Trans. Intell. Transp. Syst., 17, 3306–3317. De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R & Hubbell S. (2019). Trajectory analysis community ecology. Ecological Monographs 89, e01350.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"Miquel De Cáceres, CREAF Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectorymetrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Metrics for Ecological Trajectory Analysis — trajectorymetrics","text":"","code":"#Description of sites and surveys sites = c(1,1,1,2,2,2) surveys=c(1,2,3,1,2,3)    #Raw data table xy<-matrix(0, nrow=6, ncol=2) xy[2,2]<-1 xy[3,2]<-2 xy[4:6,1] <- 0.5 xy[4:6,2] <- xy[1:3,2] xy[6,1]<-1    #Draw trajectories trajectoryPlot(xy, sites, surveys,                 traj.colors = c(\"black\",\"red\"), lwd = 2)   #Distance matrix d = dist(xy) d #>          1        2        3        4        5 #> 2 1.000000                                     #> 3 2.000000 1.000000                            #> 4 0.500000 1.118034 2.061553                   #> 5 1.118034 0.500000 1.118034 1.000000          #> 6 2.236068 1.414214 1.000000 2.061553 1.118034    trajectoryLengths(d, sites, surveys) #>   S1       S2 Trajectory #> 1  1 1.000000   2.000000 #> 2  1 1.118034   2.118034 trajectoryLengths2D(xy, sites, surveys) #>   S1       S2 Trajectory #> 1  1 1.000000   2.000000 #> 2  1 1.118034   2.118034 trajectoryAngles(d, sites, surveys) #>      S1-S2     mean           sd rho #> 1  0.00000  0.00000 0.000000e+00   1 #> 2 26.56505 26.56505 1.490116e-08   1 trajectoryAngles2D(xy, sites, surveys, betweenSegments = TRUE) #>             t1-t2 #> 1               0 #> 2 26.565051177078 trajectoryAngles2D(xy, sites, surveys, betweenSegments = FALSE) #>   Axis2-t1 Axis2-t2 #> 1        0  0.00000 #> 2        0 26.56505 segmentDistances(d, sites, surveys)$Dseg #>          1[1-2]   1[2-3]   2[1-2] #> 1[2-3] 1.000000                   #> 2[1-2] 0.500000 1.118034          #> 2[2-3] 1.414214 1.000000 1.118034 trajectoryDistances(d, sites, surveys, distance.type = \"Hausdorff\") #>          1 #> 2 1.414214 trajectoryDistances(d, sites, surveys, distance.type = \"DSPD\") #>      1 #> 2 0.75       #Should give the same results if surveys are not in order  #(here we switch surveys for site 2) temp = xy[5,] xy[5,] = xy[6,] xy[6,] = temp surveys[5] = 3 surveys[6] = 2    trajectoryPlot(xy, sites, surveys,                 traj.colors = c(\"black\",\"red\"), lwd = 2)     trajectoryLengths(dist(xy), sites, surveys) #>   S1       S2 Trajectory #> 1  1 1.000000   2.000000 #> 2  1 1.118034   2.118034 trajectoryLengths2D(xy, sites, surveys) #>   S1       S2 Trajectory #> 1  1 1.000000   2.000000 #> 2  1 1.118034   2.118034 segmentDistances(dist(xy), sites, surveys)$Dseg #>          1[1-2]   1[2-3]   2[1-2] #> 1[2-3] 1.000000                   #> 2[1-2] 0.500000 1.118034          #> 2[2-3] 1.414214 1.000000 1.118034 trajectoryAngles(dist(xy), sites, surveys) #>      S1-S2     mean           sd rho #> 1  0.00000  0.00000 0.000000e+00   1 #> 2 26.56505 26.56505 1.490116e-08   1 trajectoryAngles2D(xy, sites, surveys, betweenSegments = TRUE) #>             t1-t2 #> 1               0 #> 2 26.565051177078 trajectoryAngles2D(xy, sites, surveys, betweenSegments = FALSE) #>   Axis2-t1 Axis2-t2 #> 1        0  0.00000 #> 2        0 26.56505 trajectoryDistances(dist(xy), sites, surveys, distance.type = \"Hausdorff\") #>          1 #> 2 1.414214 trajectoryDistances(dist(xy), sites, surveys, distance.type = \"DSPD\") #>      1 #> 2 0.75"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":null,"dir":"Reference","previous_headings":"","what":"Trajectory plots — trajectoryplots","title":"Trajectory plots — trajectoryplots","text":"Set plotting functions Ecological Trajectory Analysis:","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trajectory plots — trajectoryplots","text":"","code":"trajectoryPCoA(   d,   sites,   surveys = NULL,   selection = NULL,   traj.colors = NULL,   axes = c(1, 2),   survey.labels = FALSE,   ... )  trajectoryPlot(   x,   sites,   surveys = NULL,   selection = NULL,   traj.colors = NULL,   axes = c(1, 2),   survey.labels = FALSE,   ... )"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trajectory plots — trajectoryplots","text":"d symmetric matrix object class dist containing distance values pairs ecosystem states (see details). sites vector indicating site corresponding ecosystem state. surveys vector indicating survey corresponding ecosystem state (necessary surveys order). selection character vector sites, numeric vector site indices logical vector length sites, indicating subset site trajectories selected. traj.colors vector colors (one per site). selection != NULL length color vector equal number sites selected. axes pair principal coordinates plotted. survey.labels boolean flag indicate whether surveys plotted text next arrow endpoints ... Additional parameters function arrows. x data.frame matrix rows ecosystem states columns coordinates arbitrary space","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trajectory plots — trajectoryplots","text":"Function trajectoryPCoA returns result calling cmdscale.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Trajectory plots — trajectoryplots","text":"Function trajectoryPCoA performs principal coordinates analysis (cmdscale) draws trajectories ordination scatterplot. Function trajectoryPlot Draws trajectories scatterplot corresponding input coordinates. Details calculations given De Cáceres et al (2019). input distance matrix d ideally metric. , subsets distance triplets fulfill triangle inequality (see function .metric). CTA functions require metricity include parameter 'add', default TRUE, meaning whenever triangle inequality broken minimum constant required fulfill added three distances. local (hence, inconsistent across triplets) corrections desired, users find another way modify d achieve metricity, PCoA, metric MDS non-metric MDS (see CTA vignette). parameter 'add' set FALSE problems triangle inequality exist, CTA functions may provide missing values cases . resemblance trajectories done adapting concepts procedures used analysis trajectories space (.e. movement data) (Besse et al. 2016).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Trajectory plots — trajectoryplots","text":"Besse, P., Guillouet, B., Loubes, J.-M. & François, R. (2016). Review perspective distance based trajectory clustering. IEEE Trans. Intell. Transp. Syst., 17, 3306–3317. De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R & Hubbell S. (2019). Trajectory analysis community ecology. Ecological Monographs 89, e01350. Anderson (2017). Permutational Multivariate Analysis Variance (PERMANOVA). Wiley StatsRef: Statistics Reference Online. 1-15. Article ID: stat07841.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Trajectory plots — trajectoryplots","text":"Miquel De Cáceres, CREAF Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryplots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Trajectory plots — trajectoryplots","text":"","code":"#Description of sites and surveys sites = c(1,1,1,2,2,2) surveys=c(1,2,3,1,2,3)    #Raw data table xy<-matrix(0, nrow=6, ncol=2) xy[2,2]<-1 xy[3,2]<-2 xy[4:6,1] <- 0.5 xy[4:6,2] <- xy[1:3,2] xy[6,1]<-1    #Draw trajectories trajectoryPlot(xy, sites, surveys,                 traj.colors = c(\"black\",\"red\"), lwd = 2)      #Should give the same results if surveys are not in order  #(here we switch surveys for site 2) temp = xy[5,] xy[5,] = xy[6,] xy[6,] = temp surveys[5] = 3 surveys[6] = 2    trajectoryPlot(xy, sites, surveys,                 traj.colors = c(\"black\",\"red\"), lwd = 2)"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"set following set utility functions provided: Function trajectorySelection allows selecting submatrix distances corresponding given subset trajectories. Function centerTrajectories shifts trajectories center compositional space returns modified distance matrix. Function .metric checks whether input dissimilarity matrix metric (.e. triplets fulfill triangle inequality).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"","code":"trajectorySelection(d, sites, selection)  centerTrajectories(d, sites, verbose = FALSE)  is.metric(d, tol = 1e-04)"},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"d symmetric matrix object class dist containing distance values pairs ecosystem states (see details). sites vector indicating site corresponding ecosystem state. selection character vector sites, numeric vector site indices logical vector length sites, indicating subset site trajectories selected. verbose Provides console output informing process (useful large dataset). tol Tolerance value metricity","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"Function centerTrajectories trajectorySelection return object class dist.","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"Details calculations given De Cáceres et al (2019). Function centerTrajectories performs centering trajectories using matrix algebra explained Anderson (2017).","code":""},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R & Hubbell S. (2019). Trajectory analysis community ecology. Ecological Monographs 89, e01350. Anderson (2017). Permutational Multivariate Analysis Variance (PERMANOVA). Wiley StatsRef: Statistics Reference Online. 1-15. Article ID: stat07841.","code":""},{"path":[]},{"path":"https://emf-creaf.github.io/ecotraj/reference/trajectoryutils.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Utility functions for Ecological Trajectory Analysis — trajectoryutils","text":"Miquel De Cáceres, CREAF","code":""},{"path":"https://emf-creaf.github.io/ecotraj/news/index.html","id":"ecotraj-020","dir":"Changelog","previous_headings":"","what":"ecotraj 0.2.0","title":"ecotraj 0.2.0","text":"New function ‘trajectorySmoothing’ added Update vignette ‘Introduction Ecological Trajectory Analysis (ETA)’","code":""}]
