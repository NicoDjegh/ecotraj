<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cyclical trajectory plots — trajectoryCyclicalPlots • ecotraj</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cyclical trajectory plots — trajectoryCyclicalPlots"><meta name="description" content="Plotting functions for Cyclical Ecological Trajectory Analysis:
Function cyclePCoA removes unwanted points (see details) and performs principal coordinates analysis (cmdscale) and draws cycles in the ordination scatterplot.
Function fixedDateTrajectoryPCoA performs principal coordinates analysis (cmdscale) and draws fixed date trajectories in the ordination scatterplot.

"><meta property="og:description" content="Plotting functions for Cyclical Ecological Trajectory Analysis:
Function cyclePCoA removes unwanted points (see details) and performs principal coordinates analysis (cmdscale) and draws cycles in the ordination scatterplot.
Function fixedDateTrajectoryPCoA performs principal coordinates analysis (cmdscale) and draws fixed date trajectories in the ordination scatterplot.

"><meta property="og:image" content="https://emf-creaf.github.io/ecotraj/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/TransformingTrajectories.html">Transforming trajectories</a></li>
    <li><a class="dropdown-item" href="../articles/TrajectoryDistanceMetrics.html">Distance metrics for trajectory resemblance</a></li>
    <li><a class="dropdown-item" href="../articles/Dissimilarities.html">Dissimilarities in community data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Stable Isotope Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Introduction to Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cyclical Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionCETA.html">Introduction to Cyclical Ecological Trajectory Analysis (CETA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cyclical trajectory plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/R/trajectoryCyclicalPlots.R" class="external-link"><code>R/trajectoryCyclicalPlots.R</code></a></small>
      <div class="d-none name"><code>trajectoryCyclicalPlots.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plotting functions for Cyclical Ecological Trajectory Analysis:</p><ul><li><p>Function <code>cyclePCoA</code> removes unwanted points (see details) and performs principal coordinates analysis (<code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>) and draws cycles in the ordination scatterplot.</p></li>
<li><p>Function <code>fixedDateTrajectoryPCoA</code> performs principal coordinates analysis (<code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>) and draws fixed date trajectories in the ordination scatterplot.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cyclePCoA</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  centered <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sites.colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cycles.colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  print.init.points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex.init.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fixedDateTrajectoryPCoA</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  fixedDates.colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sites.lty <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add.cyclicalTrajectory <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The full output of function <code><a href="trajectoryCyclical.html">extractCycles</a></code> or <code><a href="trajectoryCyclical.html">extractFixedDateTrajectories</a></code> as appropriate, an object of class <code><a href="trajectoryCyclical.html">cycles</a></code> or <code><a href="trajectoryCyclical.html">fd.trajectories</a></code>.</p></dd>


<dt id="arg-centered">centered<a class="anchor" aria-label="anchor" href="#arg-centered"></a></dt>
<dd><p>Boolean. Have the cycles been centered? Default to FALSE.</p></dd>


<dt id="arg-sites-colors">sites.colors<a class="anchor" aria-label="anchor" href="#arg-sites-colors"></a></dt>
<dd><p>The colors applied to the different sites. The cycles will be distinguished (old to recent) by increasingly lighter tones of the provided colors.</p></dd>


<dt id="arg-cycles-colors">cycles.colors<a class="anchor" aria-label="anchor" href="#arg-cycles-colors"></a></dt>
<dd><p>The colors applied to the different cycles. Not compatible with <code>sites.colors</code>.</p></dd>


<dt id="arg-print-names">print.names<a class="anchor" aria-label="anchor" href="#arg-print-names"></a></dt>
<dd><p>A boolean flag to indicate whether the names of cycles or fixed-date trajectories should be printed.</p></dd>


<dt id="arg-print-init-points">print.init.points<a class="anchor" aria-label="anchor" href="#arg-print-init-points"></a></dt>
<dd><p>A boolean flag to indicate whether an initial point at the start of cycles should be printed (useful to spot the start of cycles in graphs containing many trajectories).</p></dd>


<dt id="arg-cex-init-points">cex.init.points<a class="anchor" aria-label="anchor" href="#arg-cex-init-points"></a></dt>
<dd><p>The size of initial points.</p></dd>


<dt id="arg-axes">axes<a class="anchor" aria-label="anchor" href="#arg-axes"></a></dt>
<dd><p>The pair of principal coordinates to be plotted.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters for function <code><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></code>.</p></dd>


<dt id="arg-fixeddates-colors">fixedDates.colors<a class="anchor" aria-label="anchor" href="#arg-fixeddates-colors"></a></dt>
<dd><p>The colors applied to the different fixed dates trajectories. Defaults to a simple RGB circular color palette.</p></dd>


<dt id="arg-sites-lty">sites.lty<a class="anchor" aria-label="anchor" href="#arg-sites-lty"></a></dt>
<dd><p>The line type for the different sites (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>, <code>"lty"</code>).</p></dd>


<dt id="arg-add-cyclicaltrajectory">add.cyclicalTrajectory<a class="anchor" aria-label="anchor" href="#arg-add-cyclicaltrajectory"></a></dt>
<dd><p>A boolean flag to indicate whether the original cyclical trajectory should also be drawn as background.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Functions <code>cyclePCoA</code> and <code>fixedDateTrajectoryPCoA</code> return the results of calling of <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions <code>cyclePCoA</code> and <code>fixedDateTrajectoryPCoA</code> give adapted graphical representation of cycles and fixed-date trajectories using principal coordinate analysis (PCoA, see <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>).
Function <code>cyclePCoA</code> handles external and potential interpolated ecological states so that they are correctly taken in account in PCoA (i.e. avoiding duplication, and reducing the influence of interpolated ecological states as much as possible). In case of centered cycles, the influence of these ecological states will grow as they will not correspond to duplications anymore.
In case of centered cycles, the intended use is to set the parameter <code>centered</code> to <code>TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Djeghri et al. (in preparation) Going round in cycles, but going somewhere: Ecological Trajectory Analysis as a tool to decipher seasonality and other cyclical dynamics.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="trajectoryCyclical.html">trajectoryCyclical</a></code>, <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas Djeghri, UBO</p>
<p>Miquel De Cáceres, CREAF</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#First build a toy dataset with:</span></span></span>
<span class="r-in"><span><span class="co">#The sampling times of the time series</span></span></span>
<span class="r-in"><span><span class="va">timesToy</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">30</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The duration of the cycles (i.e. the periodicity of the time series)</span></span></span>
<span class="r-in"><span><span class="va">cycleDurationToy</span> <span class="op">&lt;-</span> <span class="fl">10</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The sites sampled (only one named "A")</span></span></span>
<span class="r-in"><span><span class="va">sitesToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">timesToy</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#And prepare a trend term</span></span></span>
<span class="r-in"><span><span class="va">trend</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Build cyclical data (note that we apply the trend only to x):</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="va">timesToy</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="va">cycleDurationToy</span><span class="op">)</span><span class="op">+</span><span class="va">trend</span><span class="op">*</span><span class="va">timesToy</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="op">(</span><span class="va">timesToy</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="va">cycleDurationToy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">matToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#And express it as distances:</span></span></span>
<span class="r-in"><span><span class="va">dToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">matToy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Make it an object of class trajectory:</span></span></span>
<span class="r-in"><span><span class="va">cyclicalTrajToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">dToy</span>,</span></span>
<span class="r-in"><span>                                      sites <span class="op">=</span> <span class="va">sitesToy</span>,</span></span>
<span class="r-in"><span>                                      times <span class="op">=</span> <span class="va">timesToy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#And extract the cycles and fixed date trajectories:</span></span></span>
<span class="r-in"><span><span class="va">cyclesToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="trajectoryCyclical.html">extractCycles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyclicalTrajToy</span>,</span></span>
<span class="r-in"><span>                           cycleDuration <span class="op">=</span> <span class="va">cycleDurationToy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdTrajToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="trajectoryCyclical.html">extractFixedDateTrajectories</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyclicalTrajToy</span>,</span></span>
<span class="r-in"><span>                                          cycleDuration <span class="op">=</span> <span class="va">cycleDurationToy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#CETA plotting functions:</span></span></span>
<span class="r-in"><span><span class="fu">cyclePCoA</span><span class="op">(</span><span class="va">cyclesToy</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectoryCyclicalPlots-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">fixedDateTrajectoryPCoA</span><span class="op">(</span><span class="va">fdTrajToy</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectoryCyclicalPlots-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#After centering of cycles, set  parameter centered to TRUE in cyclePCoA():</span></span></span>
<span class="r-in"><span><span class="va">cent_cyclesToy</span> <span class="op">&lt;-</span> <span class="fu"><a href="transformTrajectories.html">centerTrajectories</a></span><span class="op">(</span><span class="va">cyclesToy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">cyclePCoA</span><span class="op">(</span><span class="va">cent_cyclesToy</span>, centered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectoryCyclicalPlots-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Djeghri, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

