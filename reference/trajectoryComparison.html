<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trajectory comparison — trajectoryComparison • ecotraj</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trajectory comparison — trajectoryComparison"><meta name="description" content="Functions to compare pairs of trajectories or trajectory segments.
Function segmentDistances calculates the distance between pairs of trajectory segments.
Function trajectoryDistances calculates the distance between pairs of trajectories.
Function trajectoryConvergence performs the Mann-Kendall trend test on (1) the distances between trajectories; (2) the distance between points of one trajectory to the other; or (3) the variance of states among trajectories.
Function trajectoryShifts calculates trajectory shifts (i.e. advances and delays) between trajectories assumed to follow a similar path but with different speeds or time lags.

"><meta property="og:description" content="Functions to compare pairs of trajectories or trajectory segments.
Function segmentDistances calculates the distance between pairs of trajectory segments.
Function trajectoryDistances calculates the distance between pairs of trajectories.
Function trajectoryConvergence performs the Mann-Kendall trend test on (1) the distances between trajectories; (2) the distance between points of one trajectory to the other; or (3) the variance of states among trajectories.
Function trajectoryShifts calculates trajectory shifts (i.e. advances and delays) between trajectories assumed to follow a similar path but with different speeds or time lags.

"><meta property="og:image" content="https://emf-creaf.github.io/ecotraj/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/TransformingTrajectories.html">Transforming trajectories</a></li>
    <li><a class="dropdown-item" href="../articles/TrajectoryDistanceMetrics.html">Distance metrics for trajectory resemblance</a></li>
    <li><a class="dropdown-item" href="../articles/Dissimilarities.html">Dissimilarities in community data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Stable Isotope Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Introduction to Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cyclical Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionCETA.html">Introduction to Cyclical Ecological Trajectory Analysis (CETA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trajectory comparison</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/R/trajectoryComparison.R" class="external-link"><code>R/trajectoryComparison.R</code></a></small>
      <div class="d-none name"><code>trajectoryComparison.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions to compare pairs of trajectories or trajectory segments.</p><ul><li><p>Function <code>segmentDistances</code> calculates the distance between pairs of trajectory segments.</p></li>
<li><p>Function <code>trajectoryDistances</code> calculates the distance between pairs of trajectories.</p></li>
<li><p>Function <code>trajectoryConvergence</code> performs the Mann-Kendall trend test on (1) the distances between trajectories; (2) the distance between points of one trajectory to the other; or (3) the variance of states among trajectories.</p></li>
<li><p>Function <code>trajectoryShifts</code> calculates trajectory shifts (i.e. advances and delays) between trajectories assumed to follow a similar path but with different speeds or time lags.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">segmentDistances</span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"directed-segment"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryDistances</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  distance.type <span class="op">=</span> <span class="st">"DSPD"</span>,</span>
<span>  symmetrization <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryConvergence</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"pairwise.asymmetric"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryShifts</span><span class="op">(</span><span class="va">x</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code><a href="defineTrajectories.html">trajectories</a></code>.</p></dd>


<dt id="arg-distance-type">distance.type<a class="anchor" aria-label="anchor" href="#arg-distance-type"></a></dt>
<dd><p>The type of distance index to be calculated (see section Details).</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>Flag to indicate that constant values should be added (local transformation) to correct triplets of distance values that do not fulfill the triangle inequality.</p></dd>


<dt id="arg-symmetrization">symmetrization<a class="anchor" aria-label="anchor" href="#arg-symmetrization"></a></dt>
<dd><p>Function used to obtain a symmetric distance, so that DSPD(T1,T2) = DSPD(T2,T1) (e.g., <code>mean</code>, <code>max</code> or <code>min</code>). If <code>symmetrization = NULL</code> then the symmetrization is not conducted and the output dissimilarity matrix is not symmetric.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A string indicating the convergence test, either <code>"pairwise.asymmetric"</code>, <code>"pairwise.symmetric"</code> or <code>"multiple"</code> (see details).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>trajectoryDistances</code> returns an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing the distances between trajectories (if <code>symmetrization = NULL</code> then the object returned is of class <code>matrix</code>).</p>
<p>Function <code>segmentDistances</code> list with the following elements:</p><ul><li><p><code>Dseg</code>: Distance matrix between segments.</p></li>
<li><p><code>Dini</code>: Distance matrix between initial points of segments.</p></li>
<li><p><code>Dfin</code>: Distance matrix between final points of segments.</p></li>
<li><p><code>Dinifin</code>: Distance matrix between initial points of one segment and the final point of the other.</p></li>
<li><p><code>Dfinini</code>: Distance matrix between final points of one segment and the initial point of the other.</p></li>
</ul><p>Function <code>trajectoryConvergence</code> returns a list with two elements:</p><ul><li><p><code>tau</code>: A single value or a matrix with the statistic (Mann-Kendall's tau) of the convergence/divergence test between trajectories. If <code>type = "pairwise.symmetric"</code> then the matrix is square and if <code>type = "pairwise.asymmetric"</code> the statistic of the test of the row trajectory approaching the column trajectory. If <code>type = "multiple"</code> tau is a single value.</p></li>
<li><p><code>p.value</code>: A single value or a matrix with the p-value of the convergence/divergence test between trajectories. If <code>type = "pairwise.symmetric"</code> then the matrix of p-values is square and if <code>type = "pairwise.asymmetric"</code> then the p-value indicates the test of the row trajectory approaching the column trajectory. If <code>type = "multiple"</code> p-value is a single value.</p></li>
</ul><p>Function <code>trajectoryShifts</code> returns an object of class <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> describing trajectory shifts (i.e. advances and delays). The columns of the <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> are:</p><ul><li><p><code>reference</code>: the site (trajectory) that is taken as reference for shift evaluation.</p></li>
<li><p><code>site</code>: the target site (trajectory) for which shifts have been computed.</p></li>
<li><p><code>survey</code>: the target trajectory survey for which shift is computed.</p></li>
<li><p><code>time</code>: the time corresponding to target trajectory survey.</p></li>
<li><p><code>timeRef</code>: the time associated to the projected ecological state onto the reference trajectory.</p></li>
<li><p><code>shift</code>: the time difference between the time of the target survey and the time of projected ecological state onto the reference trajectory. Positive values mean faster
trajectories and negative values mean slower trajectories.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Ecological Trajectory Analysis (ETA) is a framework to analyze dynamics of ecological entities described as trajectories in a chosen space of multivariate resemblance (De Cáceres et al. 2019).
ETA takes trajectories as objects to be analyzed and compared geometrically.</p>
<p>The input distance matrix <code>d</code> should ideally be metric. That is, all subsets of distance triplets should fulfill the triangle inequality (see utility function <code><a href="is.metric.html">is.metric</a></code>).
All ETA functions that require metricity include a parameter '<code>add</code>', which by default is TRUE, meaning that whenever the triangle inequality is broken the minimum constant required to fulfill it is added to the three distances.
If such local (an hence, inconsistent across triplets) corrections are not desired, users should find another way modify <code>d</code> to achieve metricity, such as PCoA, metric MDS or non-metric MDS (see vignette 'Introduction to Ecological Trajectory Analysis').
If parameter '<code>add</code>' is set to FALSE and problems of triangle inequality exist, ETA functions may provide missing values in some cases where they should not.</p>
<p>The resemblance between trajectories is done by adapting concepts and procedures used for the analysis of trajectories in space (i.e. movement data) (Besse et al. 2016).</p>
<p>Parameter <code>distance.type</code> is the type of distance index to be calculated which for function <code>segmentDistances</code> has the following options (Besse et al. 2016, De Cáceres et al. 2019:</p><ul><li><p><code>Hausdorff</code>: Hausdorff distance between two segments.</p></li>
<li><p><code>directed-segment</code>: Directed segment distance (default).</p></li>
<li><p><code>PPA</code>: Perpendicular-parallel-angle distance.</p></li>
</ul><p>In the case of function <code>trajectoryDistances</code> the following values are possible (De Cáceres et al. 2019):</p><ul><li><p><code>Hausdorff</code>: Hausdorff distance between two trajectories.</p></li>
<li><p><code>SPD</code>: Segment Path Distance.</p></li>
<li><p><code>DSPD</code>: Directed Segment Path Distance (default).</p></li>
<li><p><code>TSPD</code>: Time-Sensitive Path Distance (experimental).</p></li>
</ul><p>Function <code>trajectoryConvergence</code> is used to study convergence/divergence between trajectories. There are three possible tests, the first two concerning pairwise comparisons between trajectories.</p><ol><li><p>If <code>type = "pairwise.asymmetric"</code> then all pairwise comparisons are considered and the test is asymmetric, meaning that we test for trajectory A approaching trajectory B along time.
This test uses distances of orthogonal projections (i.e. rejections) of states of one trajectory onto the other.</p></li>
<li><p>If <code>type = "pairwise.symmetric"</code> then all pairwise comparisons are considered but we test whether
the two trajectories become closer along surveys. This test requires the same number of surveys for all trajectories and uses the sequence of distances between states of the two trajectories corresponding to the same survey.</p></li>
<li><p>If <code>type = "multiple"</code> then the function performs a single test of convergence among all trajectories. This test needs trajectories to be synchronous. In this case,
the test uses the sequence of variability between states corresponding to the same time.</p></li>
</ol><p>In all cases, a Mann-Kendall test (see <code><a href="https://rdrr.io/pkg/Kendall/man/MannKendall.html" class="external-link">MannKendall</a></code>) is used to determine if the sequence of values is monotonously increasing or decreasing.</p>
<p>Function <code>trajectoryShifts</code> is intended to be used to compare trajectories that are assumed to follow a similar pathway. The function
evaluates shifts (advances or delays) due to different trajectory speeds or the existence of time lags between them. This is done using calls to <code><a href="trajectoryProjection.html">trajectoryProjection</a></code>.
Whenever the projection of a given target state on the reference trajectory does not exist the shift cannot be evaluated (missing values are returned).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Besse, P., Guillouet, B., Loubes, J.-M. &amp; François, R. (2016). Review and perspective for distance based trajectory clustering. IEEE Trans. Intell. Transp. Syst., 17, 3306–3317.</p>
<p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R &amp; Hubbell S. (2019).
Trajectory analysis in community ecology. Ecological Monographs 89, e01350.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="trajectoryMetrics.html">trajectoryMetrics</a></code>, <code><a href="trajectoryPlot.html">trajectoryPlot</a></code>, <code><a href="transformTrajectories.html">transformTrajectories</a></code>, <code><a href="trajectoryProjection.html">trajectoryProjection</a></code>, <code><a href="https://rdrr.io/pkg/Kendall/man/MannKendall.html" class="external-link">MannKendall</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Cáceres, CREAF</p>
<p>Nicolas Djeghri, UBO</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Description of entities (sites) and surveys</span></span></span>
<span class="r-in"><span><span class="va">entities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Raw data table</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2.0</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1.0</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span><span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.25</span>,<span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Draw trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trajectoryPlot.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span>,  </span></span>
<span class="r-in"><span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectoryComparison-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Distance matrix</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1         2         3         4         5         6         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  3.0000000 2.0000000 1.0000000                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.2500000 1.0307764 2.0155644 3.0103986                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1.0307764 0.2500000 1.0307764 2.0155644 1.0000000                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1.5811388 0.7071068 0.7071068 1.5811388 1.5206906 0.5590170          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2.2360680 1.4142136 1.0000000 1.4142136 2.1360009 1.2500000 0.7071068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.5000000 1.1180340 2.0615528 3.0413813 0.2500000 1.0307764 1.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1.1180340 0.5000000 1.1180340 2.0615528 1.0307764 0.2500000 0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1.6007811 1.0307764 1.2500000 2.0155644 1.4577380 0.7905694 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1.8027756 1.5000000 1.8027756 2.5000000 1.6007811 1.2500000 1.1180340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            8         9        10        11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2.0615528                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1.1180340 1.0000000                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.7500000 1.3462912 0.5590170          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1.1180340 1.4142136 1.0000000 0.5590170</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Trajectory data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">entities</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Distances between trajectory segments</span></span></span>
<span class="r-in"><span><span class="fu">segmentDistances</span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"Hausdorff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dseg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 1.0307764 0.7071068 1.5811388 1.0000000                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 1.5811388 1.0000000 1.4142136 1.5206906 0.7071068                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 1.0307764 1.5000000          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 1.1180340 1.1180340 2.0124612 1.0307764 0.5590170 0.7500000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.6007811 1.5000000 2.0155644 1.4577380 1.1180340 1.0606602 1.3416408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dini</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 1.0307764 0.2500000 1.0307764 1.0000000                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 1.5811388 0.7071068 0.7071068 1.5206906 0.5590170                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 1.0307764 1.5000000          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 1.1180340 0.5000000 1.1180340 1.0307764 0.2500000 0.5000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.6007811 1.0307764 1.2500000 1.4577380 0.7905694 0.5590170 1.3462912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dfin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 0.7071068 0.7071068 1.5811388 0.5590170                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 1.4142136 1.0000000 1.4142136 1.2500000 0.7071068                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 0.5000000 1.1180340          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 1.0307764 1.2500000 2.0155644 0.7905694 0.5590170 0.7500000 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.5000000 1.8027756 2.5000000 1.2500000 1.1180340 1.1180340 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dinifin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]   1[3-4]    2[1-2]    2[2-3]    2[3-4]   3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[1-2] 1.0000000 2.0000000 3.000000 1.0307764 1.5811388 2.2360680 1.118034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 0.0000000 1.0000000 2.000000 0.2500000 0.7071068 1.4142136 0.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 1.0000000 0.0000000 1.000000 1.0307764 0.7071068 1.0000000 1.118034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 1.0307764 2.0155644 3.010399 1.0000000 1.5206906 2.1360009 1.030776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 0.2500000 1.0307764 2.015564 0.0000000 0.5590170 1.2500000 0.250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 0.7071068 0.7071068 1.581139 0.5590170 0.0000000 0.7071068 0.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 1.1180340 2.0615528 3.041381 1.0307764 1.5000000 2.0615528 1.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 0.5000000 1.1180340 2.061553 0.2500000 0.5000000 1.1180340 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.0307764 1.2500000 2.015564 0.7905694 0.5590170 0.7500000 0.559017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]   3[3-4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[1-2] 1.6007811 1.802776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0307764 1.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 1.2500000 1.802776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 1.4577380 1.600781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 0.7905694 1.250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 0.5590170 1.118034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 1.3462912 1.414214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 0.5590170 1.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.0000000 0.559017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">segmentDistances</span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"directed-segment"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dseg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 1.0307764 0.7071068 1.5811388 1.0000000                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 1.5811388 1.0000000 1.4142136 1.5206906 0.7071068                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 1.0307764 1.5000000          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 1.1180340 1.1180340 2.0124612 1.0307764 0.5590170 0.7500000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.6007811 1.5590170 2.0155644 1.4577380 1.1180340 1.0606602 1.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dini</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 1.0307764 0.2500000 1.0307764 1.0000000                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 1.5811388 0.7071068 0.7071068 1.5206906 0.5590170                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 1.0307764 1.5000000          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 1.1180340 0.5000000 1.1180340 1.0307764 0.2500000 0.5000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.6007811 1.0307764 1.2500000 1.4577380 0.7905694 0.5590170 1.3462912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dfin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]    1[3-4]    2[1-2]    2[2-3]    2[3-4]    3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0000000                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 2.0000000 1.0000000                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.2500000 1.0307764 2.0155644                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 0.7071068 0.7071068 1.5811388 0.5590170                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 1.4142136 1.0000000 1.4142136 1.2500000 0.7071068                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 0.5000000 1.1180340 2.0615528 0.2500000 0.5000000 1.1180340          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 1.0307764 1.2500000 2.0155644 0.7905694 0.5590170 0.7500000 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.5000000 1.8027756 2.5000000 1.2500000 1.1180340 1.1180340 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.5590170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dinifin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1[1-2]    1[2-3]   1[3-4]    2[1-2]    2[2-3]    2[3-4]   3[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[1-2] 1.0000000 2.0000000 3.000000 1.0307764 1.5811388 2.2360680 1.118034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 0.0000000 1.0000000 2.000000 0.2500000 0.7071068 1.4142136 0.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 1.0000000 0.0000000 1.000000 1.0307764 0.7071068 1.0000000 1.118034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 1.0307764 2.0155644 3.010399 1.0000000 1.5206906 2.1360009 1.030776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 0.2500000 1.0307764 2.015564 0.0000000 0.5590170 1.2500000 0.250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 0.7071068 0.7071068 1.581139 0.5590170 0.0000000 0.7071068 0.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 1.1180340 2.0615528 3.041381 1.0307764 1.5000000 2.0615528 1.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 0.5000000 1.1180340 2.061553 0.2500000 0.5000000 1.1180340 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 1.0307764 1.2500000 2.015564 0.7905694 0.5590170 0.7500000 0.559017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3[2-3]   3[3-4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[1-2] 1.6007811 1.802776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.0307764 1.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[3-4] 1.2500000 1.802776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 1.4577380 1.600781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 0.7905694 1.250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[3-4] 0.5590170 1.118034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[1-2] 1.3462912 1.414214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[2-3] 0.5590170 1.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3[3-4] 0.0000000 0.559017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Distances between trajectories</span></span></span>
<span class="r-in"><span><span class="fu">trajectoryDistances</span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"Hausdorff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.015564         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.061553 1.500000</span>
<span class="r-in"><span><span class="fu">trajectoryDistances</span><span class="op">(</span><span class="va">x</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.7214045          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.1345910 0.5714490</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Trajectory convergence/divergence</span></span></span>
<span class="r-in"><span><span class="fu">trajectoryConvergence</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tau</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1         2         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA 0.9128709 0.9128709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.9128709        NA 0.9128709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.9128709 0.9128709        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1         2         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA 0.1485617 0.1485617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.1485617        NA 0.1485617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.1485617 0.1485617        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example of trajectory shifts</span></span></span>
<span class="r-in"><span><span class="co">#Description of entities (sites) and surveys</span></span></span>
<span class="r-in"><span><span class="va">entities2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span>,<span class="st">"3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">times2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Raw data table</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="co"># States are all shifted with respect to site "1"</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">xy2</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">1.25</span>  <span class="co"># 1.25 times faster than site "1"</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Draw trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trajectoryPlot.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy2</span>, <span class="va">entities2</span>,  </span></span>
<span class="r-in"><span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectoryComparison-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Trajectory data</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy2</span><span class="op">)</span>, <span class="va">entities2</span>, times <span class="op">=</span> <span class="va">times2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Check that the third trajectory is faster</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trajectoryMetrics.html">trajectorySpeeds</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     S1   S2   S3 Path</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.00 1.00 1.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.00 1.00 1.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.25 1.25 1.25 1.25</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Trajectory shifts</span></span></span>
<span class="r-in"><span><span class="fu">trajectoryShifts</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    reference site survey time timeRef shift</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1    2      1    1    1.50  0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1    2      2    2    2.50  0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1    2      3    3    3.50  0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1    2      4    4      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1    3      1    1    1.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1    3      2    2    2.25  0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1    3      3    3    3.50  0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1    3      4    4      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          2    1      1    1      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         2    1      2    2    1.50 -0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         2    1      3    3    2.50 -0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         2    1      4    4    3.50 -0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         2    3      1    1      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         2    3      2    2    1.75 -0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         2    3      3    3    3.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         2    3      4    4      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         3    1      1    1    1.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         3    1      2    2    1.80 -0.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         3    1      3    3    2.60 -0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         3    1      4    4    3.40 -0.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         3    2      1    1    1.40  0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         3    2      2    2    2.20  0.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         3    2      3    3    3.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         3    2      4    4    3.80 -0.20</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Djeghri, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

