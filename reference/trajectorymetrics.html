<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Metrics for Ecological Trajectory Analysis — trajectorymetrics • ecotraj</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metrics for Ecological Trajectory Analysis — trajectorymetrics"><meta name="description" content="Ecological Trajectory Analysis (ETA) is a framework to analyze dynamics of ecosystems described as trajectories in a chosen space of multivariate resemblance (De Cáceres et al. 2019).
ETA takes trajectories as objects to be analyzed and compared geometrically."><meta property="og:description" content="Ecological Trajectory Analysis (ETA) is a framework to analyze dynamics of ecosystems described as trajectories in a chosen space of multivariate resemblance (De Cáceres et al. 2019).
ETA takes trajectories as objects to be analyzed and compared geometrically."><meta property="og:image" content="https://emf-creaf.github.io/ecotraj/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/Transformation.html">Transformation of dissimilarities in community data</a></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Metrics for Ecological Trajectory Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/R/trajectoryMetrics.R" class="external-link"><code>R/trajectoryMetrics.R</code></a></small>
      <div class="d-none name"><code>trajectorymetrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Ecological Trajectory Analysis (ETA) is a framework to analyze dynamics of ecosystems described as trajectories in a chosen space of multivariate resemblance (De Cáceres et al. 2019).
ETA takes trajectories as objects to be analyzed and compared geometrically.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">segmentDistances</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  surveys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance.type <span class="op">=</span> <span class="st">"directed-segment"</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryDistances</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  surveys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance.type <span class="op">=</span> <span class="st">"DSPD"</span>,</span>
<span>  symmetrization <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryLengths</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  surveys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryLengths2D</span><span class="op">(</span></span>
<span>  <span class="va">xy</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  <span class="va">surveys</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryAngles</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  surveys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryAngles2D</span><span class="op">(</span></span>
<span>  <span class="va">xy</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  <span class="va">surveys</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  betweenSegments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryProjection</span><span class="op">(</span><span class="va">d</span>, <span class="va">target</span>, <span class="va">trajectory</span>, tol <span class="op">=</span> <span class="fl">1e-06</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryConvergence</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  surveys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryDirectionality</span><span class="op">(</span><span class="va">d</span>, <span class="va">sites</span>, surveys <span class="op">=</span> <span class="cn">NULL</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>A symmetric <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code> or an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing the distance values between pairs of ecosystem states (see details).</p></dd>


<dt id="arg-sites">sites<a class="anchor" aria-label="anchor" href="#arg-sites"></a></dt>
<dd><p>A vector indicating the site corresponding to each ecosystem state.</p></dd>


<dt id="arg-surveys">surveys<a class="anchor" aria-label="anchor" href="#arg-surveys"></a></dt>
<dd><p>A vector indicating the survey corresponding to each ecosystem state (only necessary when surveys are not in order).</p></dd>


<dt id="arg-distance-type">distance.type<a class="anchor" aria-label="anchor" href="#arg-distance-type"></a></dt>
<dd><p>The type of distance index to be calculated (Besse et al. 2016; De Cáceres et al. submitted). For <code>segmentDistances</code> the available indices are:</p><ul><li><p><code>Hausdorff</code>: Hausdorff distance between two segments.</p></li>
<li><p><code>directed-segment</code>: Directed segment distance (default).</p></li>
<li><p><code>PPA</code>: Perpendicular-parallel-angle distance.</p></li>
</ul><p>whereas for <code>trajectoryDistances</code> the available indices are:</p><ul><li><p><code>Hausdorff</code>: Hausdorff distance between two trajectories.</p></li>
<li><p><code>SPD</code>: Segment path distance.</p></li>
<li><p><code>DSPD</code>: Directed segment path distance (default).</p></li>
</ul></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>Flag to indicate that constant values should be added (local transformation) to correct triplets of distance values that do not fulfill the triangle inequality.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Provides console output informing about process (useful for large dataset).</p></dd>


<dt id="arg-symmetrization">symmetrization<a class="anchor" aria-label="anchor" href="#arg-symmetrization"></a></dt>
<dd><p>Function used to obtain a symmetric distance, so that DSPD(T1,T2) = DSPD(T2,T1) (e.g., <code>mean</code> or <code>min</code>). If <code>symmetrization = NULL</code> then the symmetrization is not conducted and the output dissimilarity matrix is not symmetric.</p></dd>


<dt id="arg-relativetoinitial">relativeToInitial<a class="anchor" aria-label="anchor" href="#arg-relativetoinitial"></a></dt>
<dd><p>Flag to indicate that lengths or angles should be calculated with respect to initial survey.</p></dd>


<dt id="arg-all">all<a class="anchor" aria-label="anchor" href="#arg-all"></a></dt>
<dd><p>A flag to indicate that angles are desired for all triangles (i.e. all pairs of segments) in the trajectory. If FALSE, angles are calculated for consecutive segments only.</p></dd>


<dt id="arg-xy">xy<a class="anchor" aria-label="anchor" href="#arg-xy"></a></dt>
<dd><p>Matrix with 2D coordinates in a Cartesian space (typically an ordination of ecosystem states).</p></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>A flag to indicate that circular statistics are desired (mean, standard deviation and mean resultant length, i.e. rho)</p></dd>


<dt id="arg-betweensegments">betweenSegments<a class="anchor" aria-label="anchor" href="#arg-betweensegments"></a></dt>
<dd><p>Flag to indicate that angles should be calculated between trajectory segments or with respect to X axis.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>An integer vector of the ecosystem states to be projected.</p></dd>


<dt id="arg-trajectory">trajectory<a class="anchor" aria-label="anchor" href="#arg-trajectory"></a></dt>
<dd><p>An integer vector of the trajectory onto which target states are to be projected.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Numerical tolerance value to determine that projection of a point lies within the trajectory.</p></dd>


<dt id="arg-symmetric">symmetric<a class="anchor" aria-label="anchor" href="#arg-symmetric"></a></dt>
<dd><p>A logical flag to indicate a symmetric convergence comparison of trajectories.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>trajectoryDistances</code> returns an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing the distances between trajectories (if <code>symmetrization = NULL</code> then the object returned is of class <code>matrix</code>).</p>
<p>Function <code>trajectorySegments</code> returns a list with the following elements:</p><ul><li><p><code>Dseg</code>: Distance matrix between segments.</p></li>
<li><p><code>Dini</code>: Distance matrix between initial points of segments.</p></li>
<li><p><code>Dfin</code>: Distance matrix between final points of segments.</p></li>
<li><p><code>Dinifin</code>: Distance matrix between initial points of one segment and the final point of the other.</p></li>
<li><p><code>Dfinini</code>: Distance matrix between final points of one segment and the initial point of the other.</p></li>
</ul><p>Function <code>trajectoryLengths</code> returns a data frame with the length of each segment on each trajectory and the total length of all trajectories.
If <code>relativeToInitial = TRUE</code> lengths are calculated between the initial survey and all the other surveys.
If <code>all = TRUE</code> lengths are calculated for all segments.</p>
<p>Function <code>trajectoryLengths2D</code> returns a data frame with the length of each segment on each trajectory and the total length of all trajectories.
If <code>relativeToInitial = TRUE</code> lengths are calculated between the initial survey and all the other surveys.
If <code>all = TRUE</code> lengths are calculated for all segments.</p>
<p>Function <code>trajectoryAngles</code> returns a data frame with angle values on each trajectory. If <code>stats=TRUE</code>, then the mean, standard deviation and mean resultant length of those angles are also returned.</p>
<p>Function <code>trajectoryAngles2D</code> returns a data frame with angle values on each trajectory. If <code>betweenSegments=TRUE</code>, then angles are calculated between trajectory segments, alternatively, If <code>betweenSegments=FALSE</code>, angles are calculated considering Y axis as the North (0°).</p>
<p>Function <code>trajectoryProjection</code> returns a data frame with the following columns:</p><ul><li><p><code>distanceToTrajectory</code>: Distances to the trajectory, i.e. rejection (<code>NA</code> for target points whose projection is outside the trajectory).</p></li>
<li><p><code>segment</code>: Segment that includes the projected point (<code>NA</code> for target points whose projection is outside the trajectory).</p></li>
<li><p><code>relativePosition</code>: Relative position of the projected point within the trajectory, i.e. values from 0 to 1 with 0 representing the start of the trajectory and 1 representing the end (<code>NA</code> for target points whose projection is outside the trajectory).</p></li>
</ul><p>Function <code>trajectoryConvergence</code> returns a list with two elements:</p><ul><li><p><code>tau</code>: A matrix with the statistic (Mann-Kendall's tau) of the convergence/divergence test between trajectories. If <code>symmetric=TRUE</code> then the matrix is square. Otherwise the statistic of the test of the row trajectory approaching the column trajectory.</p></li>
<li><p><code>p.value</code>: A matrix with the p-value of the convergence/divergence test between trajectories. If <code>symmetric=TRUE</code> then the matrix is square. Otherwise the p-value indicates the test of the row trajectory approaching the column trajectory.</p></li>
</ul><p>Function <code>trajectoryDirectionality</code> returns a vector with directionality values (one per trajectory).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given a distance matrix between ecosystem states, the set of functions that provide ETA metrics are:</p><ul><li><p>Functions <code>segmentDistances</code> and <code>trajectoryDistances</code> calculate the distance between pairs of directed segments and ecosystem trajectories, respectively.</p></li>
<li><p>Function <code>trajectoryLengths</code> calculates lengths of directed segments and total path lengths of trajectories.</p></li>
<li><p>Function <code>trajectoryLengths2D</code> calculates lengths of directed segments and total path lengths of trajectories from 2D coordinates given as input.</p></li>
<li><p>Function <code>trajectoryAngles</code> calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.</p></li>
<li><p>Function <code>trajectoryAngles2D</code> calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.</p></li>
<li><p>Function <code>trajectoryProjection</code> projects a set of target points onto a specified trajectory and returns the distance to the trajectory (i.e. rejection) and the relative position of the projection point within the trajectory.</p></li>
<li><p>Function <code>trajectoryConvergence</code> performs the Mann-Kendall trend test on the distances between trajectories (symmetric test) or the distance between points of one trajectory to the other.</p></li>
<li><p>Function <code>trajectoryDirectionality</code> returns (for each trajectory) a statistic that measures directionality of the whole trajectory.</p></li>
</ul><p>Details of calculations are given in De Cáceres et al (2019).
The input distance matrix <code>d</code> should ideally be metric. That is, all subsets of distance triplets should fulfill the triangle inequality (see utility function <code><a href="trajectoryutils.html">is.metric</a></code>).
All ETA functions that require metricity include a parameter '<code>add</code>', which by default is TRUE, meaning that whenever the triangle inequality is broken the minimum constant required to fulfill it is added to the three distances.
If such local (an hence, inconsistent across triplets) corrections are not desired, users should find another way modify <code>d</code> to achieve metricity, such as PCoA, metric MDS or non-metric MDS (see vignette 'Introduction to Ecological Trajectory Analysis').
If parameter '<code>add</code>' is set to FALSE and problems of triangle inequality exist, ETA functions may provide missing values in some cases where they should not.</p>
<p>The resemblance between trajectories is done by adapting concepts and procedures used for the analysis of trajectories in space (i.e. movement data) (Besse et al. 2016).</p>
<p>Function <code>trajectoryAngles</code> calculates angles between consecutive segments in degrees. For each pair of segments, the angle between the two is defined on the plane that contains the two segments, and measures the change in direction (in degrees) from one segment to the other.
Angles are always positive, with zero values indicating segments that are in a straight line, and values equal to 180 degrees for segments that are in opposite directions. If <code>all = TRUE</code>
angles are calculated between the segments corresponding to all ordered triplets. Alternatively, if <code>relativeToInitial = TRUE</code> angles are calculated for each segment with respect to the initial survey.</p>
<p>Function <code>trajectoryAngles2D</code> calculates angles between consecutive segments in degrees from 2D coordinates given as input. For each pair of segments, the angle between the two is defined on the plane that contains the two segments, and measures the change in direction (in degrees) from one segment to the other.
Angles are always positive (O to 360), with zero values indicating segments that are in a straight line, and values equal to 180 degrees for segments that are in opposite directions.
If <code>all = TRUE</code> angles are calculated between the segments corresponding to all ordered triplets. Alternatively, if <code>relativeToInitial = TRUE</code> angles are calculated for each segment with respect to the initial survey.
If <code>betweenSegments = TRUE</code> angles are calculated between segments of trajectory, otherwise, If <code>betweenSegments = FALSE</code>, angles are calculated considering Y axis as the North (0°).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Besse, P., Guillouet, B., Loubes, J.-M. &amp; François, R. (2016). Review and perspective for distance based trajectory clustering. IEEE Trans. Intell. Transp. Syst., 17, 3306–3317.</p>
<p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R &amp; Hubbell S. (2019).
Trajectory analysis in community ecology. Ecological Monographs 89, e01350.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="trajectoryplots.html">trajectoryplots</a></code>, <code><a href="trajectoryutils.html">trajectoryutils</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Cáceres, CREAF</p>
<p>Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Description of sites and surveys</span></span></span>
<span class="r-in"><span><span class="va">sites</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">surveys</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Raw data table</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">6</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Draw trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trajectoryplots.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span>, </span></span>
<span class="r-in"><span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectorymetrics-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Distance matrix</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1        2        3        4        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.000000                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.000000 1.000000                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.500000 1.118034 2.061553                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.118034 0.500000 1.118034 1.000000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2.236068 1.414214 1.000000 2.061553 1.118034</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="fu">trajectoryLengths</span><span class="op">(</span><span class="va">d</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1       S2 Trajectory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1.000000   2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1.118034   2.118034</span>
<span class="r-in"><span><span class="fu">trajectoryLengths2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1       S2 Trajectory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1.000000   2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1.118034   2.118034</span>
<span class="r-in"><span><span class="fu">trajectoryAngles</span><span class="op">(</span><span class="va">d</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      S1-S2     mean           sd rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.00000  0.00000 0.000000e+00   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26.56505 26.56505 1.490116e-08   1</span>
<span class="r-in"><span><span class="fu">trajectoryAngles2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t1-t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26.565051177078</span>
<span class="r-in"><span><span class="fu">trajectoryAngles2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Axis2-t1 Axis2-t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        0  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        0 26.56505</span>
<span class="r-in"><span><span class="fu">segmentDistances</span><span class="op">(</span><span class="va">d</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span><span class="op">$</span><span class="va">Dseg</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1[1-2]   1[2-3]   2[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.000000                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.500000 1.118034         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 1.414214 1.000000 1.118034</span>
<span class="r-in"><span><span class="fu">trajectoryDistances</span><span class="op">(</span><span class="va">d</span>, <span class="va">sites</span>, <span class="va">surveys</span>, distance.type <span class="op">=</span> <span class="st">"Hausdorff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.414214</span>
<span class="r-in"><span><span class="fu">trajectoryDistances</span><span class="op">(</span><span class="va">d</span>, <span class="va">sites</span>, <span class="va">surveys</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.75</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Should give the same results if surveys are not in order </span></span></span>
<span class="r-in"><span><span class="co">#(here we switch surveys for site 2)</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">=</span> <span class="va">xy</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span> <span class="op">=</span> <span class="va">xy</span><span class="op">[</span><span class="fl">6</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">6</span>,<span class="op">]</span> <span class="op">=</span> <span class="va">temp</span></span></span>
<span class="r-in"><span><span class="va">surveys</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">surveys</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="trajectoryplots.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span>, </span></span>
<span class="r-in"><span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   </span></span>
<span class="r-plt img"><img src="trajectorymetrics-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">trajectoryLengths</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1       S2 Trajectory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1.000000   2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1.118034   2.118034</span>
<span class="r-in"><span><span class="fu">trajectoryLengths2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1       S2 Trajectory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1.000000   2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1.118034   2.118034</span>
<span class="r-in"><span><span class="fu">segmentDistances</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span><span class="op">$</span><span class="va">Dseg</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1[1-2]   1[2-3]   2[1-2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[2-3] 1.000000                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[1-2] 0.500000 1.118034         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2[2-3] 1.414214 1.000000 1.118034</span>
<span class="r-in"><span><span class="fu">trajectoryAngles</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, <span class="va">sites</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      S1-S2     mean           sd rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.00000  0.00000 0.000000e+00   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26.56505 26.56505 1.490116e-08   1</span>
<span class="r-in"><span><span class="fu">trajectoryAngles2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t1-t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26.565051177078</span>
<span class="r-in"><span><span class="fu">trajectoryAngles2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, <span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Axis2-t1 Axis2-t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        0  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        0 26.56505</span>
<span class="r-in"><span><span class="fu">trajectoryDistances</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, <span class="va">sites</span>, <span class="va">surveys</span>, distance.type <span class="op">=</span> <span class="st">"Hausdorff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.414214</span>
<span class="r-in"><span><span class="fu">trajectoryDistances</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, <span class="va">sites</span>, <span class="va">surveys</span>, distance.type <span class="op">=</span> <span class="st">"DSPD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.75</span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

