<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trajectory metrics — trajectoryMetrics • ecotraj</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trajectory metrics — trajectoryMetrics"><meta name="description" content="Set of functions to estimate metrics describing individual trajectories. Given input trajectory data, the set of functions that provide ETA metrics are:
Function trajectoryLengths calculates lengths of directed segments and total path lengths of trajectories.
Function trajectoryLengths2D calculates lengths of directed segments and total path lengths of trajectories from 2D coordinates given as input.
Function trajectorySpeeds calculates speeds of directed segments and total path speed of trajectories.
Function trajectorySpeeds2D calculates speeds of directed segments and total path speed of trajectories from 2D coordinates given as input.
Function trajectoryAngles calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.
Function trajectoryAngles2D calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.
Function trajectoryDirectionality calculates (for each trajectory) a statistic that measures directionality of the whole trajectory.
Function trajectoryInternalVariation calculates (for each trajectory) a statistic that measures the variability between the states included in the trajectory.
Function trajectoryMetrics evaluates several trajectory metrics at once.
Function trajectoryWindowMetrics evaluates several trajectory metrics on subtrajectories defined using moving windows.

"><meta property="og:description" content="Set of functions to estimate metrics describing individual trajectories. Given input trajectory data, the set of functions that provide ETA metrics are:
Function trajectoryLengths calculates lengths of directed segments and total path lengths of trajectories.
Function trajectoryLengths2D calculates lengths of directed segments and total path lengths of trajectories from 2D coordinates given as input.
Function trajectorySpeeds calculates speeds of directed segments and total path speed of trajectories.
Function trajectorySpeeds2D calculates speeds of directed segments and total path speed of trajectories from 2D coordinates given as input.
Function trajectoryAngles calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.
Function trajectoryAngles2D calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.
Function trajectoryDirectionality calculates (for each trajectory) a statistic that measures directionality of the whole trajectory.
Function trajectoryInternalVariation calculates (for each trajectory) a statistic that measures the variability between the states included in the trajectory.
Function trajectoryMetrics evaluates several trajectory metrics at once.
Function trajectoryWindowMetrics evaluates several trajectory metrics on subtrajectories defined using moving windows.

"><meta property="og:image" content="https://emf-creaf.github.io/ecotraj/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecotraj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionETA.html">Introduction to Ecological Trajectory Analysis (ETA)</a></li>
    <li><a class="dropdown-item" href="../articles/TransformingTrajectories.html">Transforming trajectories</a></li>
    <li><a class="dropdown-item" href="../articles/TrajectoryDistanceMetrics.html">Distance metrics for trajectory resemblance</a></li>
    <li><a class="dropdown-item" href="../articles/Dissimilarities.html">Dissimilarities in community data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Stable Isotope Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/SITA.html">Introduction to Stable Isotope Trajectory Analysis (SITA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cyclical Ecological Trajectory Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionCETA.html">Introduction to Cyclical Ecological Trajectory Analysis (CETA)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Ecological Quality Assessment</h6></li>
    <li><a class="dropdown-item" href="../articles/IntroductionEQA.html">Introduction to Ecological Quality Assessment (EQA)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/ecotraj/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trajectory metrics</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/ecotraj/blob/HEAD/R/trajectoryMetrics.R" class="external-link"><code>R/trajectoryMetrics.R</code></a></small>
      <div class="d-none name"><code>trajectoryMetrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Set of functions to estimate metrics describing individual trajectories. Given input trajectory data, the set of functions that provide ETA metrics are:</p><ul><li><p>Function <code>trajectoryLengths</code> calculates lengths of directed segments and total path lengths of trajectories.</p></li>
<li><p>Function <code>trajectoryLengths2D</code> calculates lengths of directed segments and total path lengths of trajectories from 2D coordinates given as input.</p></li>
<li><p>Function <code>trajectorySpeeds</code> calculates speeds of directed segments and total path speed of trajectories.</p></li>
<li><p>Function <code>trajectorySpeeds2D</code> calculates speeds of directed segments and total path speed of trajectories from 2D coordinates given as input.</p></li>
<li><p>Function <code>trajectoryAngles</code> calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.</p></li>
<li><p>Function <code>trajectoryAngles2D</code> calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.</p></li>
<li><p>Function <code>trajectoryDirectionality</code> calculates (for each trajectory) a statistic that measures directionality of the whole trajectory.</p></li>
<li><p>Function <code>trajectoryInternalVariation</code> calculates (for each trajectory) a statistic that measures the variability between the states included in the trajectory.</p></li>
<li><p>Function <code>trajectoryMetrics</code> evaluates several trajectory metrics at once.</p></li>
<li><p>Function <code>trajectoryWindowMetrics</code> evaluates several trajectory metrics on subtrajectories defined using moving windows.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trajectoryLengths</span><span class="op">(</span><span class="va">x</span>, relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>, all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryLengths2D</span><span class="op">(</span></span>
<span>  <span class="va">xy</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  surveys <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  all <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectorySpeeds</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectorySpeeds2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">sites</span>, surveys <span class="op">=</span> <span class="cn">NULL</span>, times <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryAngles</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryAngles2D</span><span class="op">(</span></span>
<span>  <span class="va">xy</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  <span class="va">surveys</span>,</span>
<span>  relativeToInitial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  betweenSegments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryDirectionality</span><span class="op">(</span><span class="va">x</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, nperm <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryInternalVariation</span><span class="op">(</span><span class="va">x</span>, relativeContributions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryMetrics</span><span class="op">(</span><span class="va">x</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trajectoryWindowMetrics</span><span class="op">(</span><span class="va">x</span>, <span class="va">bandwidth</span>, type <span class="op">=</span> <span class="st">"surveys"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code><a href="defineTrajectories.html">trajectories</a></code>.</p></dd>


<dt id="arg-relativetoinitial">relativeToInitial<a class="anchor" aria-label="anchor" href="#arg-relativetoinitial"></a></dt>
<dd><p>Flag to indicate that lengths or angles should be calculated with respect to initial survey.</p></dd>


<dt id="arg-all">all<a class="anchor" aria-label="anchor" href="#arg-all"></a></dt>
<dd><p>A flag to indicate that angles are desired for all triangles (i.e. all pairs of segments) in the trajectory. If FALSE, angles are calculated for consecutive segments only.</p></dd>


<dt id="arg-xy">xy<a class="anchor" aria-label="anchor" href="#arg-xy"></a></dt>
<dd><p>Matrix with 2D coordinates in a Cartesian space (typically an ordination of ecological states).</p></dd>


<dt id="arg-sites">sites<a class="anchor" aria-label="anchor" href="#arg-sites"></a></dt>
<dd><p>A vector indicating the site corresponding to each ecological state.</p></dd>


<dt id="arg-surveys">surveys<a class="anchor" aria-label="anchor" href="#arg-surveys"></a></dt>
<dd><p>A vector indicating the survey corresponding to each ecological state (only necessary when surveys are not in order).</p></dd>


<dt id="arg-times">times<a class="anchor" aria-label="anchor" href="#arg-times"></a></dt>
<dd><p>A numeric vector indicating the time corresponding to each ecosystem state.</p></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>A flag to indicate that circular statistics are desired (mean, standard deviation and mean resultant length, i.e. rho)</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>Flag to indicate that constant values should be added (local transformation) to correct triplets of distance values that do not fulfill the triangle inequality.</p></dd>


<dt id="arg-betweensegments">betweenSegments<a class="anchor" aria-label="anchor" href="#arg-betweensegments"></a></dt>
<dd><p>Flag to indicate that angles should be calculated between trajectory segments or with respect to X axis.</p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>The number of permutations to be used in the directionality test.</p></dd>


<dt id="arg-relativecontributions">relativeContributions<a class="anchor" aria-label="anchor" href="#arg-relativecontributions"></a></dt>
<dd><p>A logical flag to indicate that contributions of individual observations to temporal variability should be expressed in relative terms, i.e. as the ratio of the sum of squares of the observation divided by the overall sum of squares (otherwise, absolute sum of squares are returned).</p></dd>


<dt id="arg-bandwidth">bandwidth<a class="anchor" aria-label="anchor" href="#arg-bandwidth"></a></dt>
<dd><p>Bandwidth of the moving windows (in units of surveys or times, depending on <code>type</code>)</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A string, either "surveys" or "times", indicating how windows are defined.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Functions <code>trajectoryLengths</code> and  <code>trajectoryLengths2D</code> return a data frame with the length of each segment on each trajectory and the total length of all trajectories.
If <code>relativeToInitial = TRUE</code> lengths are calculated between the initial survey and all the other surveys.
If <code>all = TRUE</code> lengths are calculated for all segments.</p>
<p>Functions <code>trajectorySpeeds</code> and <code>trajectorySpeeds2D</code> return a data frame with the speed of each segment on each trajectory and the total speeds of all trajectories. Units depend on the units of distance matrix and the units of <code>times</code> of the input trajectory data.</p>
<p>Function <code>trajectoryAngles</code> returns a data frame with angle values on each trajectory. If <code>stats=TRUE</code>, then the mean, standard deviation and mean resultant length of those angles are also returned.</p>
<p>Function <code>trajectoryAngles2D</code> returns a data frame with angle values on each trajectory. If <code>betweenSegments=TRUE</code>, then angles are calculated between trajectory segments, alternatively, If <code>betweenSegments=FALSE</code>, angles are calculated considering Y axis as the North (0°).</p>
<p>Function <code>trajectoryDirectionality</code> returns a vector with directionality values (one per trajectory). If <code>nperm</code> is not missing, the function returns a data frame
with a column of directional values and a column of p-values corresponding to the result of the permutational test.</p>
<p>Function <code>trajectoryInternalVariation</code> returns data.frame with as many rows as trajectories, and different columns: (1) the contribution of each individual state to the internal sum of squares (in absolute or relative terms); (2) the overall sum of squares of internal variability;
(3) an unbiased estimator of overall internal variance.</p>
<p>Function <code>trajectoryMetrics</code> returns a data frame where rows are trajectories and columns are different trajectory metrics.</p>
<p>Function <code>trajectoryWindowMetrics</code> returns a data frame where rows are midpoints over trajectories and columns correspond to different trajectory metrics.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Ecological Trajectory Analysis (ETA) is a framework to analyze dynamics of ecological entities described as trajectories in a chosen space of multivariate resemblance (De Cáceres et al. 2019).
ETA takes trajectories as objects to be analyzed and compared geometrically.</p>
<p>The input distance matrix <code>d</code> should ideally be metric. That is, all subsets of distance triplets should fulfill the triangle inequality (see utility function <code><a href="is.metric.html">is.metric</a></code>).
All ETA functions that require metricity include a parameter '<code>add</code>', which by default is TRUE, meaning that whenever the triangle inequality is broken the minimum constant required to fulfill it is added to the three distances.
If such local (an hence, inconsistent across triplets) corrections are not desired, users should find another way modify <code>d</code> to achieve metricity, such as PCoA, metric MDS or non-metric MDS (see vignette 'Introduction to Ecological Trajectory Analysis').
If parameter '<code>add</code>' is set to FALSE and problems of triangle inequality exist, ETA functions may provide missing values in some cases where they should not.</p>
<p>Function <code>trajectoryAngles</code> calculates angles between consecutive segments in degrees. For each pair of segments, the angle between the two is defined on the plane that contains the two segments, and measures the change in direction (in degrees) from one segment to the other.
Angles are always positive, with zero values indicating segments that are in a straight line, and values equal to 180 degrees for segments that are in opposite directions. If <code>all = TRUE</code>
angles are calculated between the segments corresponding to all ordered triplets. Alternatively, if <code>relativeToInitial = TRUE</code> angles are calculated for each segment with respect to the initial survey.</p>
<p>Function <code>trajectoryAngles2D</code> calculates angles between consecutive segments in degrees from 2D coordinates given as input. For each pair of segments, the angle between the two is defined on the plane that contains the two segments, and measures the change in direction (in degrees) from one segment to the other.
Angles are always positive (O to 360), with zero values indicating segments that are in a straight line, and values equal to 180 degrees for segments that are in opposite directions.
If <code>all = TRUE</code> angles are calculated between the segments corresponding to all ordered triplets. Alternatively, if <code>relativeToInitial = TRUE</code> angles are calculated for each segment with respect to the initial survey.
If <code>betweenSegments = TRUE</code> angles are calculated between segments of trajectory, otherwise, If <code>betweenSegments = FALSE</code>, angles are calculated considering Y axis as the North (0°).</p>
<p>Function <code>trajectoryDirectionality</code> evaluates the directionality metric proposed in De Cáceres et al (2019). If <code>nperm</code> is supplied, then the function
performs a permutational test to evaluate the significance of directionality, where the null hypothesis entails a random order of surveys within each trajectory. The p-value corresponds to the proportion of
permutations with a directional value equal or larger than the observed.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R &amp; Hubbell S. (2019).
Trajectory analysis in community ecology. Ecological Monographs 89, e01350.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="trajectoryComparison.html">trajectoryComparison</a></code>, <code><a href="trajectoryPlot.html">trajectoryPlot</a></code>, <code><a href="transformTrajectories.html">transformTrajectories</a></code>, <code><a href="trajectoryCyclical.html">cycleMetrics</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Cáceres, CREAF</p>
<p>Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc</p>
<p>Nicolas Djeghri, UBO</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Description of entities (sites) and surveys</span></span></span>
<span class="r-in"><span><span class="va">entities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">1.5</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Raw data table</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">6</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">xy</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Draw trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trajectoryPlot.html">trajectoryPlot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span>,  </span></span>
<span class="r-in"><span>               traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trajectoryMetrics-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Distance matrix</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1        2        3        4        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.000000                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.000000 1.000000                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.500000 1.118034 2.061553                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.118034 0.500000 1.118034 1.000000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2.236068 1.414214 1.000000 2.061553 1.118034</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">#Trajectory data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="defineTrajectories.html">defineTrajectories</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">entities</span>, <span class="va">surveys</span>, <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Trajectory lengths</span></span></span>
<span class="r-in"><span><span class="fu">trajectoryLengths</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1       S2     Path</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1.000000 2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1.118034 2.118034</span>
<span class="r-in"><span><span class="fu">trajectoryLengths2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   S1       S2     Path</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1.000000 2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1.118034 2.118034</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Trajectory speeds</span></span></span>
<span class="r-in"><span><span class="fu">trajectorySpeeds</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          S1        S2      Path</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6666667 0.6666667 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6666667 0.7453560 0.7060113</span>
<span class="r-in"><span><span class="fu">trajectorySpeeds2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span>, <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          S1        S2      Path</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6666667 0.6666667 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6666667 0.7453560 0.7060113</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Trajectory angles</span></span></span>
<span class="r-in"><span><span class="fu">trajectoryAngles</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      S1-S2     mean           sd rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.00000  0.00000 0.000000e+00   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26.56505 26.56505 1.490116e-08   1</span>
<span class="r-in"><span><span class="fu">trajectoryAngles2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t1-t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26.565051177078</span>
<span class="r-in"><span><span class="fu">trajectoryAngles2D</span><span class="op">(</span><span class="va">xy</span>, <span class="va">entities</span>, <span class="va">surveys</span>, betweenSegments <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Axis2-t1 Axis2-t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        0  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        0 26.56505</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Several metrics at once</span></span></span>
<span class="r-in"><span><span class="fu">trajectoryMetrics</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   trajectory n t_start t_end duration   length mean_speed mean_angle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1 3       0     3        3 2.000000  0.6666667    0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2 3       0     3        3 2.118034  0.7060113   26.56505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   directionality internal_ss internal_variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1.0000000    2.000000          1.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0.8524164    2.166667          1.083333</span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Djeghri, Anthony Sturbois.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

